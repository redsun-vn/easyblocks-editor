{"version":3,"file":"index.js","sources":["../../src/EditorContext.ts","../../src/utils/array/last.ts","../../src/utils/array/toArray.ts","../../src/utils/array/preOrderPathComparator.ts","../../src/utils/array/includesAny.ts","../../src/utils/deepClone.ts","../../src/utils/deepCompare.ts","../../src/utils/hooks/useForceRerender.ts","../../src/utils/object/dotNotationGet.ts","../../src/utils/serialize.ts","../../src/utils/sleep.ts","../../src/utils/uniqueId.ts","../../src/utils/assert.ts","../../src/ConfigAfterAutoContext.ts","../../src/EditorExternalDataProvider.tsx","../../src/useWindowKeyDown.ts","../../src/EditorIframe.tsx","../../src/pathToCompiledPath.ts","../../src/buildTinaFields.ts","../../src/utils/copyToClipboard.ts","../../src/SidebarFooter.tsx","../../src/tinacms/fields/components/Toggle.tsx","../../src/tinacms/fields/components/constants.ts","../../src/tinacms/fields/components/isMixedFieldValue.ts","../../src/tinacms/fields/components/Select.tsx","../../src/tinacms/fields/components/RadioGroup.tsx","../../src/tinacms/fields/components/NumberInput.tsx","../../src/tinacms/fields/plugins/Tooltip.tsx","../../src/tinacms/fields/plugins/useTooltip.ts","../../src/tinacms/fields/plugins/wrapFieldWithMeta.tsx","../../src/tinacms/fields/plugins/numberFormat.ts","../../src/tinacms/fields/plugins/NumberFieldPlugin.tsx","../../src/tinacms/fields/plugins/textFormat.ts","../../src/tinacms/fields/plugins/SelectFieldPlugin.tsx","../../src/tinacms/fields/plugins/RadioGroupFieldPlugin.tsx","../../src/tinacms/fields/plugins/TextFieldPlugin.tsx","../../src/tinacms/fields/plugins/ToggleFieldPlugin.tsx","../../src/tinacms/fields/plugins/TokenField/TokenFieldPlugin.tsx","../../src/utils/isConfigPathRichTextPart.ts","../../src/tinacms/fields/components/getUniqueValues.ts","../../src/tinacms/form-builder/utils/mergeCommonFields.ts","../../src/tinacms/fields/plugins/BlockFieldPlugin.tsx","../../src/tinacms/fields/plugins/IdentityFieldPlugin.tsx","../../src/tinacms/fields/plugins/MissingWidget.tsx","../../src/tinacms/fields/plugins/ExternalField/ExternalField.tsx","../../src/tinacms/fields/plugins/ResponsiveField/responsiveFieldController.ts","../../src/tinacms/fields/plugins/ResponsiveField/ResponsiveFieldPlugin.tsx","../../src/tinacms/fields/plugins/SVGPicker/SVGPicker.tsx","../../src/tinacms/fields/plugins/SliderFieldPlugin.tsx","../../src/tinacms/fields/plugins/LocalFIeld.tsx","../../src/sidebar/PositionPickerInput.tsx","../../src/tinacms/fields/plugins/PositionFieldPlugin.tsx","../../src/tinacms/form-builder/utils/createFieldController.ts","../../src/tinacms/form-builder/fields-builder.tsx","../../src/tinacms/styles/Styles.tsx","../../src/tinacms/styles/Button.tsx","../../src/inline-settings.tsx","../../src/EditorSidebar.tsx","../../src/EditorTopBar.tsx","../../src/normalizeToStringArray.ts","../../src/getAllComponentTypes.ts","../../src/getAllComponentsOfType.ts","../../src/unrollAcceptsFieldIntoComponents.ts","../../src/ModalPicker.tsx","../../src/TemplateModal.tsx","../../src/editorActions.ts","../../src/paste/reconcile.ts","../../src/paste/insert.ts","../../src/paste/destinationResolver.ts","../../src/paste/manager.ts","../../src/selectionFrame/cssVariables.ts","../../src/selectionFrame/AddButton.tsx","../../src/selectionFrame/SelectionFrame.styles.ts","../../src/selectionFrame/calculateAddButtonProperties.ts","../../src/selectionFrame/SelectionFrame.tsx","../../src/utils/config/configMap.ts","../../src/templates/getTemplates.ts","../../src/form.ts","../../src/tinacms/react-core/use-form.ts","../../src/utils/config/getConfigSnapshot.ts","../../src/utils/locales/addLocalizedFlag.ts","../../src/utils/locales/removeLocalizedFlag.ts","../../src/useDataSaver.ts","../../src/useEditorGlobalKeyboardShortcuts.ts","../../src/EditorHistory.ts","../../src/useEditorHistory.ts","../../src/utils/locales/checkLocalesCorrectness.ts","../../src/Editor.tsx","../../src/sidebar/validate-color/index.ts","../../src/sidebar/ColorTokenWidget.tsx","../../src/sidebar/SpaceTokenWidget.tsx","../../src/parseQueryParams.ts","../../src/sidebar/DocumentDataWidget.tsx","../../src/SectionPicker.tsx","../../src/SearchableSmallPickerModal.tsx","../../src/EasyblocksParent.tsx","../../src/CanvasRoot/CanvasRoot.tsx","../../src/EditableComponentBuilder/SelectionFrameController.tsx","../../src/EditableComponentBuilder/BlockControls.tsx","../../src/EditableComponentBuilder/EditableComponentBuilder.editor.tsx","../../src/Placeholder.tsx","../../src/EditorChildWindow.tsx","../../src/PreviewRenderer.tsx","../../src/debug/debugTypes.ts","../../src/debug/DebugSection/DebugSection.definition.ts","../../src/debug/debugTokens.ts","../../src/debug/DebugSection/DebugSection.tsx","../../src/debug/DebugUrlWidget.tsx","../../src/debug/addDebugToEditorProps.ts","../../src/EasyblocksEditor.tsx"],"sourcesContent":["import {\n  Backend,\n  CompiledComponentConfig,\n  Document,\n  ExternalTypeDefinition,\n  InlineTypeDefinition,\n  InlineTypeWidgetComponentProps,\n  NoCodeComponentEntry,\n  Template,\n  TokenTypeDefinition,\n  TokenTypeWidgetComponentProps,\n  Widget,\n} from \"@redsun-vn/easyblocks-core\";\nimport {\n  EditorContextType as BaseEditorContextType,\n  CompilationCache,\n  InternalAnyField,\n} from \"@redsun-vn/easyblocks-core/_internals\";\nimport React, { ComponentType, useContext } from \"react\";\nimport { Form } from \"./form\";\nimport { ActionsType, InternalWidgetComponentProps } from \"./types\";\n\nexport type EditorExternalTypeDefinition = Omit<\n  ExternalTypeDefinition,\n  \"widgets\"\n> & {\n  widgets: Array<\n    Widget & {\n      component?: ComponentType<InternalWidgetComponentProps>;\n    }\n  >;\n};\n\ntype EditorInlineTypeDefinition = Omit<InlineTypeDefinition, \"widgets\"> & {\n  widget: Widget & {\n    component?: ComponentType<InlineTypeWidgetComponentProps<any>>;\n  };\n};\n\ntype EditorTokenTypeDefinition = Omit<TokenTypeDefinition, \"widgets\"> & {\n  widget?: Widget & {\n    component?: ComponentType<TokenTypeWidgetComponentProps<any>>;\n  };\n};\n\nexport type EditorContextType = Omit<BaseEditorContextType, \"types\"> & {\n  backend: Backend;\n  templates?: Template[];\n  syncTemplates: (props: { mode?: \"create\" | \"edit\" | \"delete\"; template?: Template }) => void;\n  focussedField: Array<string>;\n  setFocussedField: (field: Array<string> | string) => void;\n  form: Form<any, InternalAnyField>;\n  isEditing?: boolean;\n  actions: ActionsType;\n  save: (document: Document) => Promise<void>;\n  compiledComponentConfig?: CompiledComponentConfig;\n  configAfterAuto?: NoCodeComponentEntry;\n  compilationCache: CompilationCache;\n  isAdminMode: boolean;\n  readOnly: boolean;\n  disableCustomTemplates: boolean;\n  types: Record<\n    string,\n    | EditorExternalTypeDefinition\n    | EditorInlineTypeDefinition\n    | EditorTokenTypeDefinition\n  >;\n  components: Record<string, ComponentType<any>>;\n};\n\nexport const EditorContext = React.createContext<EditorContextType | null>(\n  null\n);\n\nexport function useEditorContext() {\n  const context = useContext(EditorContext);\n  if (!context) {\n    throw new Error(\"EditorContext not defined\");\n  }\n  return context;\n}\n","function last<T extends Array<any>>(collection: T): T[number] {\n  return collection[collection.length - 1];\n}\n\nexport { last };\n","// eslint-disable-next-line @typescript-eslint/ban-types\nfunction toArray<T extends {}>(scalarOrCollection: T | Array<T>): Array<T> {\n  if (Array.isArray(scalarOrCollection)) {\n    return scalarOrCollection;\n  }\n\n  return [scalarOrCollection];\n}\n\nexport { toArray };\n","const takeNumbers = (path: string) =>\n  path\n    .split(\".\")\n    .map((x) => parseInt(x, 10))\n    .filter((x) => !Number.isNaN(x));\n\nconst preOrderPathComparator =\n  (direction: \"ascending\" | \"descending\" = \"ascending\") =>\n  (pathA: string, pathB: string) => {\n    const order = direction === \"ascending\" ? 1 : -1;\n\n    const numbersA = takeNumbers(pathA);\n    const numbersB = takeNumbers(pathB);\n\n    const numberALength = numbersA.length;\n    const numberBLength = numbersB.length;\n\n    if (numberALength === 0 || numberBLength === 0) {\n      throw new Error(`Cannot compare paths '${pathA}' and '${pathB}'.`);\n    }\n\n    const shorterLength = Math.min(numberALength, numberBLength);\n    let index = 0;\n    while (index < shorterLength) {\n      const valueA = numbersA[index];\n      const valueB = numbersB[index];\n      if (valueA !== valueB) {\n        return order * Math.sign(valueA - valueB);\n      }\n      index++;\n    }\n\n    return order * Math.sign(numberBLength - numberALength);\n  };\n\nexport { preOrderPathComparator };\n","function includesAny<T>(a: T[], b: T[]) {\n  return a.some((i) => b.includes(i));\n}\n\nexport { includesAny };\n","function deepClone<T>(source: T): T {\n  return JSON.parse(JSON.stringify(source)) as T;\n}\n\nexport { deepClone };\n","function deepCompare(...objectsToCompare: Array<Record<string, any>>): boolean {\n  for (let index = 0; index < objectsToCompare.length - 1; index++) {\n    const currentObject = sortObject(objectsToCompare[index]);\n    const nextObject = sortObject(objectsToCompare[index + 1]);\n\n    const areObjectsHashesEqual =\n      JSON.stringify(currentObject) === JSON.stringify(nextObject);\n\n    if (!areObjectsHashesEqual) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction sortObject(value: unknown) {\n  if (typeof value !== \"object\") {\n    return value;\n  }\n\n  if (Array.isArray(value)) {\n    return [...value].sort();\n  }\n\n  if (value === null) {\n    return null;\n  }\n\n  const sortedObject: Record<string, any> = {};\n  const objectKeys = Object.keys(value).sort();\n\n  objectKeys.forEach((key) => {\n    sortedObject[key] = sortObject((value as Record<string, any>)[key]);\n  });\n\n  return sortedObject;\n}\n\nexport { deepCompare, sortObject };\n","\"use client\";\nimport { useRef, useState } from \"react\";\n\nfunction useForceRerender() {\n  const [, setDummyState] = useState({});\n\n  const forceRerender = useRef(() => {\n    setDummyState({});\n  }).current;\n\n  return { forceRerender };\n}\n\nexport { useForceRerender };\n","export function dotNotationGet(obj: any, path: string) {\n  if (path === \"\") {\n    return obj;\n  }\n  return path.split(\".\").reduce((acc, curVal) => acc && acc[curVal], obj);\n}\n","function serialize(value: unknown) {\n  if (value instanceof Error) {\n    return JSON.parse(JSON.stringify(value, Object.getOwnPropertyNames(value)));\n  }\n\n  return JSON.parse(JSON.stringify(value));\n}\n\nexport { serialize };\n","export function sleep(ms: number) {\n  return new Promise((resolve) => setTimeout(resolve, ms));\n}\n","function uniqueId(): string {\n  const id = \"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx\".replace(\n    /[xy]/g,\n    function (c) {\n      const r = (Math.random() * 16) | 0,\n        v = c == \"x\" ? r : (r & 0x3) | 0x8;\n      return v.toString(16);\n    }\n  );\n\n  return id;\n}\n\nexport { uniqueId, uniqueId as uuidv4 };\n","function assertDefined<T>(value: T, message?: string): Exclude<T, undefined> {\n  if (value === undefined) {\n    throw new Error(message ?? \"Value is undefined\");\n  }\n\n  return value as Exclude<T, undefined>;\n}\n\nfunction assertNonNullable<T>(value: T): Exclude<T, null> {\n  if (value === null) {\n    throw new Error(\"Value is null\");\n  }\n\n  return value as Exclude<T, null>;\n}\n\nexport { assertDefined, assertNonNullable };\n","import React, { useContext } from \"react\";\nimport { NoCodeComponentEntry } from \"@redsun-vn/easyblocks-core\";\n\nexport const ConfigAfterAutoContext =\n  React.createContext<NoCodeComponentEntry | null>(null);\n\nexport function useConfigAfterAuto() {\n  const configAfterAutoContext = useContext(ConfigAfterAutoContext);\n\n  if (!configAfterAutoContext) {\n    throw new Error(\"CompiledConfigContext is required for Responsive field\");\n  }\n\n  return configAfterAutoContext;\n}\n","import { ExternalData } from \"@redsun-vn/easyblocks-core\";\nimport React, { createContext, ReactNode, useContext } from \"react\";\n\nconst ExternalDataContext = createContext<ExternalData>({});\n\nfunction EditorExternalDataProvider({\n  children,\n  externalData,\n}: {\n  children: ReactNode;\n  externalData: ExternalData;\n}) {\n  return (\n    <ExternalDataContext.Provider value={externalData}>\n      {children}\n    </ExternalDataContext.Provider>\n  );\n}\n\nfunction useEditorExternalData() {\n  return useContext(ExternalDataContext);\n}\n\nexport { EditorExternalDataProvider, useEditorExternalData };\n","import { useEffect } from \"react\";\n\nexport enum ExtraKeys {\n  ALT_KEY = \"altKey\",\n  CTRL_KEY = \"ctrlKey\",\n  META_KEY = \"metaKey\",\n  SHIFT_KEY = \"shiftKey\",\n}\n\nconst actionKeys: ExtraKeys[] = [\n  ExtraKeys.ALT_KEY,\n  ExtraKeys.CTRL_KEY,\n  ExtraKeys.META_KEY,\n  ExtraKeys.SHIFT_KEY,\n];\n\ninterface GlobalKeyDownConfig {\n  extraKeys: ExtraKeys[];\n  isDisabled: boolean;\n}\n\nexport const useWindowKeyDown = (\n  key: string,\n  callback: (...args: unknown[]) => any,\n  { extraKeys, isDisabled }: GlobalKeyDownConfig = {\n    extraKeys: [],\n    isDisabled: false,\n  }\n) => {\n  const downHandler = (event: KeyboardEvent) => {\n    const isExtraKeysPressed = extraKeys.every((k) => event[k]);\n    const extraKeysSet = new Set([...extraKeys]);\n\n    const isOtherExtraKeysPressed = actionKeys\n      .filter((k) => !extraKeysSet.has(k))\n      .some((k) => event[k]);\n\n    if (event.key === key && isExtraKeysPressed && !isOtherExtraKeysPressed) {\n      event.preventDefault();\n      callback();\n    }\n  };\n\n  useEffect(() => {\n    if (!isDisabled) {\n      document\n        .getElementsByTagName(\"iframe\")![0]\n        .contentWindow!.window.document.body.addEventListener(\n          \"keydown\",\n          downHandler\n        );\n\n      window.addEventListener(\"keydown\", downHandler);\n      return () => {\n        window.removeEventListener(\"keydown\", downHandler);\n      };\n    }\n  }, [isDisabled]);\n};\n","import { Colors } from \"@redsun-vn/easyblocks-design-system\";\nimport React, { useState } from \"react\";\nimport { styled } from \"styled-components\";\nimport { ExtraKeys, useWindowKeyDown } from \"./useWindowKeyDown\";\n\ninterface EditorIframeWrapperProps {\n  onEditorHistoryRedo: () => void;\n  onEditorHistoryUndo: () => void;\n  width: number;\n  height: number;\n  transform: string;\n  containerRef: React.RefObject<HTMLDivElement>;\n}\n\nfunction EditorIframe({\n  onEditorHistoryRedo,\n  onEditorHistoryUndo,\n  width,\n  height,\n  transform,\n  containerRef,\n}: EditorIframeWrapperProps) {\n  const [isIframeReady, setIframeReady] = useState(false);\n\n  const handleIframeLoaded = () => {\n    setIframeReady(true);\n  };\n\n  useWindowKeyDown(\"z\", onEditorHistoryUndo, {\n    extraKeys: [ExtraKeys.META_KEY],\n    isDisabled: !isIframeReady,\n  });\n\n  useWindowKeyDown(\"z\", onEditorHistoryRedo, {\n    extraKeys: [ExtraKeys.META_KEY, ExtraKeys.SHIFT_KEY],\n    isDisabled: !isIframeReady,\n  });\n\n  useWindowKeyDown(\"z\", onEditorHistoryUndo, {\n    extraKeys: [ExtraKeys.CTRL_KEY],\n    isDisabled: !isIframeReady,\n  });\n\n  useWindowKeyDown(\"y\", onEditorHistoryRedo, {\n    extraKeys: [ExtraKeys.CTRL_KEY],\n    isDisabled: !isIframeReady,\n  });\n\n  return (\n    <IframeContainer ref={containerRef}>\n      <IframeInnerContainer>\n        <Iframe\n          id=\"shopstory-canvas\"\n          src={window.location.href}\n          onLoad={handleIframeLoaded}\n          style={{\n            // These properties will change a lot during resizing, so we don't pass it to styled component to prevent\n            // class name recalculations\n            width,\n            height,\n            transform,\n          }}\n        />\n      </IframeInnerContainer>\n    </IframeContainer>\n  );\n}\n\nexport { EditorIframe };\n\nconst IframeContainer = styled.div`\n  position: relative;\n  flex: 1 1 auto;\n  background: ${Colors.black100};\n`;\n\nconst IframeInnerContainer = styled.div`\n  position: absolute; // absolute to prevent grid container having effect on parent div width (div can be oversized)\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  display: grid;\n  justify-content: center;\n  align-items: center;\n`;\n\nconst Iframe = styled.iframe`\n  background: white;\n  border: none;\n  transform-origin: center;\n`;\n","import { SchemaProp } from \"@redsun-vn/easyblocks-core\";\nimport {\n  findComponentDefinitionById,\n  isSchemaPropActionTextModifier,\n  isSchemaPropTextModifier,\n  parsePath,\n} from \"@redsun-vn/easyblocks-core/_internals\";\nimport { EditorContextType } from \"./EditorContext\";\n\nexport function pathToCompiledPath(\n  path: string,\n  editorContext: EditorContextType\n): string {\n  const pathInfo = parsePath(path, editorContext.form);\n\n  if (pathInfo.parent) {\n    const definition = findComponentDefinitionById(\n      pathInfo.parent.templateId,\n      editorContext\n    )!;\n\n    const schemaProp = definition.schema.find(\n      (schemaProp) => schemaProp.prop === pathInfo.parent!.fieldName\n    )!;\n\n    const result = `${pathToCompiledPath(\n      pathInfo.parent.path,\n      editorContext\n    )}.${getPropertyNameFromSchemaProp(schemaProp)}.${\n      pathInfo.parent.fieldName\n    }.${pathInfo.index!}`;\n\n    if (result.startsWith(\".\")) {\n      return result.substring(1);\n    }\n\n    return result;\n  }\n\n  return \"\";\n}\n\nfunction getPropertyNameFromSchemaProp(schemaProp: SchemaProp) {\n  if (\n    isSchemaPropTextModifier(schemaProp) ||\n    isSchemaPropActionTextModifier(schemaProp)\n  ) {\n    return \"textModifiers\";\n  }\n\n  return \"components\";\n}\n","import {\n  CompiledCustomComponentConfig,\n  FieldPortal,\n} from \"@redsun-vn/easyblocks-core\";\nimport {\n  InternalAnyTinaField,\n  InternalField,\n  stripRichTextPartSelection,\n} from \"@redsun-vn/easyblocks-core/_internals\";\nimport { dotNotationGet } from \"@/utils\";\nimport type { EditorContextType } from \"./EditorContext\";\nimport { pathToCompiledPath } from \"./pathToCompiledPath\";\n\nexport function isFieldPortal(\n  x: InternalAnyTinaField | FieldPortal\n): x is FieldPortal {\n  return \"portal\" in x;\n}\n\nexport function buildTinaFields(\n  path: string,\n  editorContext: EditorContextType\n) {\n  return internalBuildTinaFields(path, editorContext);\n}\n\nfunction internalBuildTinaFields(\n  path: string,\n  editorContext: EditorContextType,\n  fieldsFilter?: (field: InternalAnyTinaField | FieldPortal) => boolean\n) {\n  const compiledPath = pathToCompiledPath(\n    stripRichTextPartSelection(path),\n    editorContext\n  );\n\n  const compiledComponent: CompiledCustomComponentConfig = dotNotationGet(\n    editorContext.compiledComponentConfig!,\n    compiledPath\n  );\n\n  let allFields: InternalAnyTinaField[] = [];\n\n  (compiledComponent.__editing?.fields ?? [])\n    .filter((field) =>\n      fieldsFilter ? fieldsFilter(field as InternalAnyTinaField) : true\n    )\n    .forEach((item) => {\n      if (isFieldPortal(item)) {\n        let fields: InternalAnyTinaField[] = [];\n\n        if (item.portal === \"component\") {\n          const portalComponentFields = internalBuildTinaFields(\n            item.source,\n            editorContext\n          );\n          fields.push(...portalComponentFields);\n\n          if (!item.includeHeader) {\n            fields = fields.filter((x) => x.prop !== \"$myself\");\n          }\n\n          const groups = item.groups;\n          if (groups) {\n            fields = fields.filter(\n              (x) =>\n                x.prop === \"$myself\" ||\n                groups.includes(x.group || \"___doesn't matter___\")\n            );\n          }\n        } else if (item.portal === \"field\") {\n          if (item.hidden) {\n            return;\n          }\n\n          const portalFieldFields = internalBuildTinaFields(\n            item.source,\n            editorContext,\n            (field) => !isFieldPortal(field) && field.prop === item.fieldName\n          );\n\n          if (portalFieldFields.length === 0) {\n            console.warn(\n              `Missing field \"${item.fieldName}\" at path \"${item.source}\" in portal for component ${compiledComponent._component}`\n            );\n            return;\n          }\n\n          const portalField = {\n            ...portalFieldFields[0],\n            ...item.overrides,\n          };\n\n          fields.push(portalField);\n        } else if (item.portal === \"multi-field\") {\n          if (item.sources.length === 0) {\n            if (item.hidden) {\n              return;\n            }\n\n            throw new Error(\n              `Missing sources for multi field portal of component \"${compiledComponent._component}\" at path \"${path}\". Set \"hidden\" to \"true\" for this portal if sources are empty`\n            );\n          }\n\n          const portalFieldFields = item.sources.flatMap((source) =>\n            internalBuildTinaFields(\n              source,\n              editorContext,\n              (field) => !isFieldPortal(field) && field.prop === item.fieldName\n            )\n          );\n\n          const firstField = portalFieldFields[0];\n          const combinedField: InternalField = {\n            ...firstField,\n            ...item.overrides,\n            name: portalFieldFields.flatMap((field) => field.name),\n          };\n\n          fields.push(combinedField);\n        }\n\n        allFields = [...allFields, ...fields];\n      } else {\n        allFields.push(item as InternalField);\n      }\n    });\n\n  // Analytics fields should always go to the bottom (later they'll be in separate tab)\n\n  const nonAnalyticsFields = allFields.filter((x) => x.group !== \"Analytics\");\n  const analyticsFields = allFields.filter((x) => x.group === \"Analytics\");\n\n  return [...nonAnalyticsFields, ...analyticsFields];\n}\n","export async function copyToClipboard(textToCopy: string) {\n  // Navigator clipboard api needs a secure context (https)\n  if (navigator.clipboard && window.isSecureContext) {\n    await navigator.clipboard.writeText(textToCopy);\n  } else {\n    // Use the 'out of viewport hidden text area' trick\n    const textArea = document.createElement(\"textarea\");\n    textArea.value = textToCopy;\n\n    // Move textarea out of the viewport so it's not visible\n    textArea.style.position = \"absolute\";\n    textArea.style.left = \"-999999px\";\n\n    document.body.prepend(textArea);\n    textArea.select();\n\n    try {\n      document.execCommand(\"copy\");\n    } catch (error) {\n      console.error(error);\n    } finally {\n      textArea.remove();\n    }\n  }\n}","import { dotNotationGet } from \"@/utils\";\nimport { NoCodeComponentEntry } from \"@redsun-vn/easyblocks-core\";\nimport {\n  findComponentDefinition,\n  stripRichTextPartSelection,\n} from \"@redsun-vn/easyblocks-core/_internals\";\nimport {\n  ButtonPrimary,\n  ButtonSecondary,\n  Colors,\n  Fonts,\n  useToaster,\n} from \"@redsun-vn/easyblocks-design-system\";\nimport * as React from \"react\";\nimport { styled } from \"styled-components\";\nimport { useEditorContext } from \"./EditorContext\";\nimport { pathToCompiledPath } from \"./pathToCompiledPath\";\nimport { copyToClipboard } from \"./utils/copyToClipboard\";\n\nconst IdWrapper = styled.div`\n  display: block;\n  padding: 16px;\n  ${Fonts.body}\n  color: ${Colors.black40};\n`;\n\nexport function SidebarFooter(props: { paths: string[] }) {\n  const editorContext = useEditorContext();\n  const toaster = useToaster();\n  const { form, isAdminMode } = editorContext;\n\n  if (props.paths.length === 0) {\n    return null;\n  }\n\n  const path = stripRichTextPartSelection(props.paths[0]);\n  const value: NoCodeComponentEntry = dotNotationGet(form.values, path);\n\n  if (!value) {\n    return null;\n  }\n\n  const compiledPath = pathToCompiledPath(path, editorContext);\n  const compiledValue = dotNotationGet(\n    editorContext.compiledComponentConfig,\n    compiledPath\n  );\n\n  const widthInfo = compiledValue.__editing?.widthInfo;\n  const width = widthInfo?.width?.xl;\n  const widthAuto = widthInfo?.auto?.xl;\n\n  const definition = findComponentDefinition(value, editorContext);\n  const isSaveable = !!definition?.allowSave;\n\n  const showSaveAsTemplate =\n    isSaveable &&\n    !editorContext.readOnly &&\n    !editorContext.disableCustomTemplates;\n\n  return (\n    <div>\n      <IdWrapper>\n        <div>Id: {value._id}</div>\n        <br />\n\n        {showSaveAsTemplate && (\n          <ButtonSecondary\n            onClick={() => {\n              editorContext.actions.openTemplateModal({\n                mode: \"create\",\n                config: value,\n                width,\n                widthAuto,\n              });\n            }}\n          >\n            Save as template\n          </ButtonSecondary>\n        )}\n\n        {isAdminMode && (\n          <div style={{ paddingTop: 16 }}>\n            <div>\n              <ButtonPrimary\n                onClick={async () => {\n                  try {\n                    await copyToClipboard(JSON.stringify(value));\n                    toaster.success(\"Copied\");\n                  } catch (error) {\n                    toaster.error(\"Copy Entry Error!\");\n                  }\n                }}\n              >\n                Copy entry\n              </ButtonPrimary>\n            </div>\n            {value._master && (\n              <div style={{ paddingTop: 16 }}>Master: {value._master}</div>\n            )}\n          </div>\n        )}\n      </IdWrapper>\n    </div>\n  );\n}\n","import { InternalField } from \"@redsun-vn/easyblocks-core/_internals\";\nimport { Toggle as DesignSystemToggle } from \"@redsun-vn/easyblocks-design-system\";\nimport React, { FC } from \"react\";\nimport { styled } from \"styled-components\";\n\nexport interface ToggleProps {\n  name: string;\n  input: any;\n  field: ToggleFieldDefinition;\n  disabled?: boolean;\n  onBlur: <T>(event?: React.FocusEvent<T>) => void;\n  onChange: <T>(event: React.ChangeEvent<T> | any) => void;\n  onFocus: <T>(event?: React.FocusEvent<T>) => void;\n}\n\ninterface ToggleFieldDefinition extends InternalField {\n  component: \"toggle\";\n  toggleLabels?: boolean | FieldLabels;\n}\n\ntype FieldLabels = { true: string; false: string };\n\nexport const Toggle: FC<ToggleProps> = ({ input, field, disabled = false }) => {\n  const checked = !!(input.value || input.checked);\n\n  const toggleProps = {\n    ...input,\n    labels: null,\n    name: field.name,\n    disabled,\n    value: checked,\n    checked,\n  };\n  return (\n    <ToggleFieldWrapper>\n      <DesignSystemToggle {...toggleProps} />\n    </ToggleFieldWrapper>\n  );\n};\n\nconst ToggleFieldWrapper = styled.div`\n  display: flex;\n  justify-content: flex-end;\n`;\n","const MIXED_VALUE = \"__MIXED__\";\n\nconst COMPONENTS_SUPPORTING_MIXED_VALUES = [\n  \"block\",\n  \"radio-group\",\n  \"select\",\n  \"token\",\n];\n\nexport { COMPONENTS_SUPPORTING_MIXED_VALUES, MIXED_VALUE };\n","import { FieldMixedValue } from \"../../../types\";\n\nfunction isMixedFieldValue(value: unknown): value is FieldMixedValue {\n  return (\n    typeof value === \"object\" &&\n    value !== null &&\n    \"__mixed__\" in value &&\n    (value as FieldMixedValue).__mixed__\n  );\n}\n\nexport { isMixedFieldValue };\n","import { InternalField } from \"@redsun-vn/easyblocks-core/_internals\";\nimport {\n  Select,\n  SelectItem,\n  SelectSeparator,\n} from \"@redsun-vn/easyblocks-design-system\";\nimport React from \"react\";\nimport { FieldMixedValue } from \"../../../types\";\nimport { FieldRenderProps } from \"../../form-builder\";\nimport { MIXED_VALUE } from \"./constants\";\nimport { isMixedFieldValue } from \"./isMixedFieldValue\";\n\ntype Option =\n  | {\n      value: string;\n      label: string;\n    }\n  | {\n      isDivider: true;\n    };\n\ninterface SelectFieldProps extends InternalField {\n  options: (Option | string)[];\n}\n\nexport interface SelectFieldComponentProps\n  extends FieldRenderProps<string | FieldMixedValue> {\n  name: Array<string> | string;\n  field: SelectFieldProps;\n  disabled?: boolean;\n  options?: (Option | string)[];\n}\n\nexport const SelectFieldComponent: React.FC<SelectFieldComponentProps> = ({\n  input,\n  field,\n  options,\n}) => {\n  const { value, onChange } = input;\n  const isMixedValue = isMixedFieldValue(value);\n\n  const selectOptions = options || field.options;\n  const normalizedSelectOptions = selectOptions.map(toProps);\n\n  if (isMixedValue) {\n    normalizedSelectOptions.unshift(\n      {\n        label: \"Mixed\",\n        value: MIXED_VALUE,\n      },\n      {\n        isDivider: true,\n      }\n    );\n  }\n\n  const inputValue = isMixedValue ? MIXED_VALUE : value;\n\n  const handleChange = (value: string) => {\n    onChange(value);\n  };\n\n  return (\n    <Select value={inputValue} onChange={handleChange}>\n      {normalizedSelectOptions.map(toComponent)}\n    </Select>\n  );\n};\n\nfunction toProps(option: Option | string): Option {\n  if (typeof option === \"object\") return option;\n  return { value: option, label: option };\n}\n\nfunction toComponent(option: Option) {\n  if (\"isDivider\" in option) {\n    return <SelectSeparator key=\"divider\" />;\n  }\n\n  return (\n    <SelectItem\n      key={option.value}\n      value={option.value}\n      isDisabled={option.value === MIXED_VALUE}\n    >\n      {option.label}\n    </SelectItem>\n  );\n}\n","import { Option } from \"@redsun-vn/easyblocks-core\";\nimport { InternalField } from \"@redsun-vn/easyblocks-core/_internals\";\nimport {\n  Icons,\n  SelectInline,\n  ToggleButton,\n} from \"@redsun-vn/easyblocks-design-system\";\nimport React from \"react\";\nimport { FieldMixedValue } from \"../../../types\";\nimport { FieldRenderProps } from \"../../form-builder\";\nimport { isMixedFieldValue } from \"./isMixedFieldValue\";\n\ninterface RadioGroupFieldProps extends InternalField {\n  options: Option[];\n  direction?: \"horizontal\" | \"vertical\";\n  variant?: \"radio\" | \"button\";\n}\n\nexport interface RadioGroupProps\n  extends FieldRenderProps<string | FieldMixedValue> {\n  name: string;\n  field: RadioGroupFieldProps;\n  disabled?: boolean;\n  options?: (Option | string)[];\n}\n\nexport const RadioGroup: React.FC<RadioGroupProps> = ({\n  input,\n  field,\n  options,\n}) => {\n  const { value } = input;\n  const radioOptions = options || field.options;\n  const toggleButtonValue = isMixedFieldValue(value) ? undefined : value;\n\n  const toProps = (option: Option | string): Exclude<Option, string> => {\n    if (typeof option === \"object\") return option;\n    return { value: option, label: option };\n  };\n\n  const radioOptionsMapped = radioOptions ? radioOptions.map(toProps) : [];\n\n  return (\n    radioOptionsMapped && (\n      <SelectInline {...input} value={toggleButtonValue}>\n        {radioOptionsMapped.map((option) => {\n          let Icon: Exclude<Exclude<Option, string>[\"icon\"], string> =\n            undefined;\n\n          if (typeof option.icon === \"string\" && option.icon in Icons) {\n            Icon = Icons[option.icon as keyof typeof Icons];\n          }\n\n          if (typeof option.icon === \"function\") {\n            Icon = option.icon;\n          }\n\n          return (\n            <ToggleButton\n              key={option.value}\n              icon={Icon}\n              value={option.value}\n              hideLabel={option.hideLabel}\n            >\n              {option.label ?? option.value}\n            </ToggleButton>\n          );\n        })}\n      </SelectInline>\n    )\n  );\n};\n","import * as React from \"react\";\nimport { Input } from \"@redsun-vn/easyblocks-design-system\";\n\ninterface NumberProps\n  extends React.DetailedHTMLProps<\n    React.InputHTMLAttributes<HTMLInputElement>,\n    HTMLInputElement\n  > {\n  step?: string | number;\n}\n\nexport const NumberInput: React.FC<NumberProps> = ({\n  onChange,\n  value,\n  step,\n  min,\n  max,\n}) => (\n  <Input\n    type=\"number\"\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n    // @ts-ignore\n    step={step}\n    value={value}\n    onChange={onChange}\n    min={min}\n    max={max}\n  />\n);\n","import { Fonts } from \"@redsun-vn/easyblocks-design-system\";\nimport React, { CSSProperties, forwardRef, ReactNode } from \"react\";\nimport { createPortal } from \"react-dom\";\nimport { styled } from \"styled-components\";\n\ninterface TooltipProps {\n  children: ReactNode;\n  style?: CSSProperties;\n}\n\nconst Tooltip = forwardRef<HTMLDivElement, TooltipProps>(\n  ({ children, style = {}, ...rest }, ref) => {\n    return createPortal(\n      <div style={{ ...style, zIndex: 100100 }} ref={ref} {...rest}>\n        {children}\n      </div>,\n      document.body\n    );\n  }\n);\n\nexport { Tooltip, TooltipBody, TooltipArrow };\n\nconst TooltipBody = styled.div`\n  position: relative;\n  top: 6px;\n\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  align-items: center;\n\n  padding: 6px 4px;\n\n  background: #333333;\n  border-radius: 2px;\n\n  ${Fonts.body}\n  color: #fff;\n`;\n\nconst TooltipArrow = styled.div`\n  width: 12px;\n  height: 6px;\n  margin: 0 auto;\n\n  background: #333333;\n  clip-path: polygon(50% 0%, 0% 100%, 100% 100%);\n`;\n","import { TooltipTriggerAria, useTooltipTrigger } from \"@react-aria/tooltip\";\nimport { CSSProperties, MouseEvent, RefCallback, useState } from \"react\";\nimport { usePopper } from \"react-popper\";\n\ninterface TooltipOptions {\n  isDisabled?: boolean;\n  onClick?: () => void;\n}\n\ntype TooltipResult = {\n  isOpen: boolean;\n  arrowProps: {\n    ref: RefCallback<HTMLElement>;\n    style: CSSProperties;\n  };\n} & TooltipTriggerAria;\n\nfunction useTooltip({\n  isDisabled,\n  onClick,\n}: TooltipOptions = {}): TooltipResult {\n  const [isOpen, setIsOpen] = useState(false);\n  const [triggerElement, setTriggerElement] = useState<HTMLElement | null>(\n    null\n  );\n  const [tooltipElement, setTooltipElement] = useState<HTMLElement | null>(\n    null\n  );\n  const [arrowElement, setArrowElement] = useState<HTMLElement | null>(null);\n\n  const { styles, attributes } = usePopper(triggerElement, tooltipElement, {\n    strategy: \"absolute\",\n    placement: \"bottom\",\n    modifiers: [\n      { name: \"arrow\", options: { element: arrowElement, padding: 6 } },\n    ],\n  });\n\n  const tooltipTrigger = useTooltipTrigger(\n    {\n      isDisabled,\n      delay: 0,\n    },\n    {\n      isOpen,\n      open: () => {\n        setIsOpen(true);\n      },\n      close: () => {\n        setIsOpen(false);\n      },\n    },\n    { current: triggerElement }\n  );\n\n  const triggerProps = {\n    ref: setTriggerElement,\n    ...tooltipTrigger.triggerProps,\n    onClick:\n      onClick === undefined\n        ? tooltipTrigger.tooltipProps.onClick\n        : (event: MouseEvent<HTMLButtonElement>) => {\n            tooltipTrigger.tooltipProps.onClick?.(event);\n            onClick();\n          },\n  };\n\n  const tooltipProps = {\n    ref: setTooltipElement,\n    style: styles.popper,\n    ...attributes.popper,\n    ...tooltipTrigger.tooltipProps,\n  };\n\n  const arrowProps = {\n    ref: setArrowElement,\n    style: styles.arrow,\n  };\n\n  return {\n    isOpen,\n    triggerProps,\n    tooltipProps,\n    arrowProps,\n  };\n}\n\nexport { useTooltip };\n","import {\n  ExternalReference,\n  ExternalSchemaProp,\n  LocalTextReference,\n  TextSchemaProp,\n  TrulyResponsiveValue,\n  getExternalReferenceLocationKey,\n  isEmptyExternalReference,\n  isIdReferenceToDocumentExternalValue,\n  isTrulyResponsiveValue,\n  responsiveValueFindDeviceWithDefinedValue,\n  responsiveValueForceGet,\n} from \"@redsun-vn/easyblocks-core\";\nimport {\n  InternalField,\n  isExternalSchemaProp,\n} from \"@redsun-vn/easyblocks-core/_internals\";\nimport {\n  Fonts,\n  Loader,\n  Select,\n  SelectItem,\n  Typography,\n} from \"@redsun-vn/easyblocks-design-system\";\nimport { dotNotationGet, toArray, uniqueId } from \"@/utils\";\nimport React, { ReactNode, useState } from \"react\";\nimport { styled, css } from \"styled-components\";\nimport { useConfigAfterAuto } from \"../../../ConfigAfterAutoContext\";\nimport {\n  EditorExternalTypeDefinition,\n  useEditorContext,\n} from \"../../../EditorContext\";\nimport { useEditorExternalData } from \"../../../EditorExternalDataProvider\";\nimport { Form } from \"../../../form\";\nimport { FieldRenderProps } from \"../../form-builder\";\nimport { COMPONENTS_SUPPORTING_MIXED_VALUES } from \"../components/constants\";\nimport { isMixedFieldValue } from \"../components/isMixedFieldValue\";\nimport type { ResponsiveFieldDefinition } from \"./ResponsiveField/responsiveFieldController\";\nimport { Tooltip, TooltipArrow, TooltipBody } from \"./Tooltip\";\nimport { useTooltip } from \"./useTooltip\";\n\ntype ExtraFieldMetaWrapperFields = {\n  layout?: \"column\" | \"row\";\n  noWrap?: boolean;\n  isLabelHidden?: boolean;\n};\n\nexport interface FieldProps<InputProps extends Record<string, unknown>>\n  extends FieldRenderProps<any, HTMLElement> {\n  field: InternalField;\n  form: Form;\n}\n\ntype InputFieldType<\n  ExtraFieldProps extends Record<string, unknown>,\n  InputProps extends Record<string, unknown>\n> = Omit<FieldProps<InputProps>, \"meta\"> &\n  ExtraFieldProps &\n  ExtraFieldMetaWrapperFields & {\n    children: ReactNode;\n    renderLabel?: (props: { label: string }) => ReactNode;\n  };\n\n// Wraps the Field component in labels describing the field's meta state\n// Add any other fields that the Field component should expect onto the ExtraFieldProps generic type\n\nexport function FieldMetaWrapper<\n  ExtraFieldProps extends Record<string, unknown> = Record<string, unknown>,\n  InputProps extends Record<string, unknown> = Record<string, unknown>\n>({\n  children,\n  field,\n  input,\n  noWrap,\n  layout = \"row\",\n  renderLabel,\n  isLabelHidden,\n}: InputFieldType<ExtraFieldProps, InputProps>) {\n  const editorContext = useEditorContext();\n  const configAfterAuto = useConfigAfterAuto();\n  const externalData = useEditorExternalData();\n  const { isOpen, tooltipProps, triggerProps, arrowProps } = useTooltip();\n\n  const {\n    actions: { runChange },\n    form,\n    focussedField,\n  } = editorContext;\n\n  const isMixedValueSupported = isMixedValueSupportedByComponent(\n    isResponsiveField(field) ? field.subComponent : field.component\n  );\n\n  const isMixedValue = isMixedFieldValue(input.value);\n  const fieldNames = toArray(field.name);\n\n  function handleButtonMixedClick() {\n    runChange(() => {\n      fieldNames.forEach((fieldName, _, names) => {\n        const firstFieldValue = dotNotationGet(form.values, names[0]);\n        form.change(fieldName, firstFieldValue);\n      });\n    });\n  }\n\n  const resolvedLayout = field.layout ?? layout;\n\n  const content = (\n    <div\n      style={{\n        width: \"100%\",\n        display: \"flex\",\n        alignItems: resolvedLayout === \"row\" ? \"flex-end\" : \"flex-start\",\n        flexDirection: \"column\",\n      }}\n    >\n      {!isMixedValue || (isMixedValue && isMixedValueSupported) ? (\n        children\n      ) : (\n        <TextButton\n          component=\"button\"\n          variant=\"label\"\n          color=\"black40\"\n          onClick={handleButtonMixedClick}\n        >\n          Mixed\n        </TextButton>\n      )}\n    </div>\n  );\n\n  if (noWrap) {\n    return content;\n  }\n\n  const label = field.label || input.name;\n  const { schemaProp } = field;\n  const isExternalField =\n    isExternalSchemaProp(schemaProp, editorContext.types) ||\n    (schemaProp.type === \"text\" && !input.value.id?.startsWith(\"local.\"));\n  const componentPaths = fieldNames.map((fieldName) =>\n    fieldName[0].split(\".\").slice(0, -1).join(\".\")\n  );\n  const fieldValues = fieldNames.map((f) => dotNotationGet(configAfterAuto, f));\n  const configs = componentPaths.map((c) => dotNotationGet(configAfterAuto, c));\n  const externalValues = isExternalField\n    ? configs.map(\n        (c) =>\n          externalData[\n            getExternalReferenceLocationKey(\n              focussedField.length === 0 ? \"$\" : c._id,\n              schemaProp.prop,\n              isTrulyResponsiveValue(input.value)\n                ? responsiveValueFindDeviceWithDefinedValue(\n                    input.value,\n                    editorContext.breakpointIndex,\n                    editorContext.devices\n                  )?.id\n                : undefined\n            )\n          ]\n      )\n    : undefined;\n\n  const currentBreakpointFieldValues = fieldValues.map((v) =>\n    responsiveValueForceGet(v, editorContext.breakpointIndex)\n  );\n\n  const isLoadingExternalValue =\n    isExternalField &&\n    externalValues?.length === 0 &&\n    currentBreakpointFieldValues.every(\n      (v) =>\n        !isEmptyExternalReference(v) &&\n        !isIdReferenceToDocumentExternalValue(v.id)\n    );\n\n  return (\n    <FieldWrapper margin={false} layout={resolvedLayout}>\n      {!isLabelHidden && (\n        <FieldLabelWrapper isFullWidth={resolvedLayout === \"column\"}>\n          {renderLabel?.({ label }) ?? (\n            <FieldLabel\n              htmlFor={toArray(field.name).join(\",\")}\n              isError={\n                externalValues !== undefined && \"error\" in externalValues\n              }\n              {...triggerProps}\n            >\n              <span\n                style={{\n                  lineHeight: \"100%\",\n                  overflow: \"hidden\",\n                  textOverflow: \"ellipsis\",\n                }}\n              >\n                {label}\n              </span>\n              {isOpen && (\n                <Tooltip {...tooltipProps}>\n                  <TooltipArrow {...arrowProps} />\n                  <TooltipBody>{field.description ?? field.label}</TooltipBody>\n                </Tooltip>\n              )}\n            </FieldLabel>\n          )}\n\n          {isLoadingExternalValue && (\n            <div\n              style={{\n                marginLeft: \"6px\",\n              }}\n            >\n              <Loader />\n            </div>\n          )}\n\n          {resolvedLayout === \"column\" &&\n            (isExternalSchemaProp(schemaProp, editorContext.types) ||\n              schemaProp.type === \"text\") &&\n            !isMixedValue && (\n              <WidgetsSelect\n                schemaProp={schemaProp}\n                value={currentBreakpointFieldValues[0]}\n                onChange={(widgetId) => {\n                  if (widgetId === \"@easyblocks/local-text\") {\n                    const newFieldValue: LocalTextReference = {\n                      id: `local.${uniqueId()}`,\n                      value: {},\n                      widgetId,\n                    };\n\n                    input.onChange(newFieldValue);\n                    return;\n                  }\n\n                  if (isTrulyResponsiveValue(input.value)) {\n                    const newFieldValue: TrulyResponsiveValue<ExternalReference> =\n                      {\n                        ...input.value,\n                        [editorContext.breakpointIndex]: {\n                          id: null,\n                          widgetId,\n                        },\n                      };\n\n                    input.onChange(newFieldValue);\n                  } else {\n                    const newFieldValue: ExternalReference = {\n                      id: null,\n                      widgetId,\n                    };\n\n                    input.onChange(newFieldValue);\n                  }\n                }}\n                isRootComponent={fieldNames.some(\n                  (f) => f.split(\".\").length === 1\n                )}\n              />\n            )}\n        </FieldLabelWrapper>\n      )}\n\n      <FieldInputWrapper layout={resolvedLayout}>{content}</FieldInputWrapper>\n\n      {!isMixedFieldValue &&\n        isExternalField &&\n        externalValues!.length > 0 &&\n        \"error\" in externalValues![0] && (\n          <FieldError>{externalValues![0].error.message}</FieldError>\n        )}\n    </FieldWrapper>\n  );\n}\n\nfunction WidgetsSelect({\n  value,\n  onChange,\n  schemaProp,\n  isRootComponent,\n}: {\n  value: LocalTextReference | ExternalReference;\n  onChange: (widgetId: string) => void;\n  schemaProp: ExternalSchemaProp | TextSchemaProp;\n  isRootComponent: boolean;\n}) {\n  const editorContext = useEditorContext();\n  const [selectedWidgetId, setSelectedWidgetId] = useState(value.widgetId);\n\n  const widgets = (\n    editorContext.types[schemaProp.type] as EditorExternalTypeDefinition\n  ).widgets;\n  const availableWidgets = isRootComponent\n    ? widgets.filter((w) => {\n        return w.id !== \"@easyblocks/document-data\";\n      })\n    : [...widgets];\n\n  if (schemaProp.type === \"text\") {\n    availableWidgets.unshift({\n      id: \"@easyblocks/local-text\",\n      label: \"Local text\",\n      component: () => {\n        return null;\n      },\n    });\n  }\n\n  if (availableWidgets.length <= 1) {\n    return null;\n  }\n\n  return (\n    <FieldLabelIconWrapper>\n      <Select\n        value={selectedWidgetId}\n        onChange={(widgetId) => {\n          setSelectedWidgetId(widgetId);\n          onChange(widgetId);\n        }}\n      >\n        {availableWidgets.map((widget) => {\n          return (\n            <SelectItem value={widget.id} key={widget.id}>\n              {widget.label ?? widget.id}\n            </SelectItem>\n          );\n        })}\n      </Select>\n    </FieldLabelIconWrapper>\n  );\n}\n\nfunction isResponsiveField(\n  field: InternalField\n): field is ResponsiveFieldDefinition {\n  return (\n    typeof field.component === \"string\" && field.component === \"responsive2\"\n  );\n}\n\nfunction isMixedValueSupportedByComponent(\n  component: InternalField[\"component\"]\n): boolean {\n  if (typeof component === \"string\") {\n    return COMPONENTS_SUPPORTING_MIXED_VALUES.includes(component);\n  }\n\n  return false;\n}\n\nconst TextButton = styled(Typography)`\n  padding: 0;\n  margin: 0;\n  background: transparent;\n  border: 0;\n  font-weight: 500;\n\n  &:hover {\n    color: black;\n    cursor: pointer;\n    text-decoration: underline;\n  }\n`;\n\nexport function wrapFieldsWithMeta<\n  ExtraFieldProps extends Record<string, any> = Record<string, any>,\n  InputProps extends Record<string, any> = Record<string, any>\n>(\n  Field: React.ComponentType<InputFieldType<ExtraFieldProps, InputProps>>,\n  extraProps?: ExtraFieldMetaWrapperFields\n) {\n  return (props: InputFieldType<ExtraFieldProps, InputProps>) => {\n    return (\n      <FieldMetaWrapper {...props} {...extraProps}>\n        <Field {...props} />\n      </FieldMetaWrapper>\n    );\n  };\n}\n\ninterface FieldWrapperProps {\n  margin: boolean;\n  layout: \"column\" | \"row\";\n}\n\nconst FieldWrapper = styled.div<FieldWrapperProps>`\n  display: flex;\n  flex-direction: ${({ layout }) => layout};\n  gap: ${({ layout }) => (layout === \"row\" ? \"10px\" : \"4px\")};\n  justify-content: space-between;\n  align-items: flex-start;\n  ${({ layout }) =>\n    layout === \"column\" &&\n    css`\n      flex-grow: 1;\n    `}\n  position: relative;\n  padding: 4px 16px;\n`;\n\nconst FieldLabelWrapper = styled.div<{ isFullWidth: boolean }>`\n  all: unset;\n  position: relative;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  ${({ isFullWidth }) => isFullWidth && { width: \"100%\" }}\n  min-height: 28px;\n  overflow: hidden;\n`;\n\ntype FieldLabelProps = {\n  isError: boolean;\n};\n\nconst FieldLabel = styled.label<FieldLabelProps>`\n  all: unset;\n  ${Fonts.body};\n  color: ${({ isError }) => (isError ? \"red\" : \"#000\")};\n  text-overflow: ellipsis;\n  overflow: hidden;\n  cursor: default;\n`;\n\nconst FieldLabelIconWrapper = styled.span`\n  display: flex;\n  font-size: 14px;\n  line-height: 1;\n  margin-left: auto;\n  padding-left: 8px;\n\n  svg {\n    width: 14px;\n    height: 14px;\n    flex-shrink: 0;\n  }\n`;\n\nconst FieldError = styled.span`\n  display: block;\n  color: red;\n  font-size: var(--tina-font-size-1);\n  margin-top: 8px;\n  font-weight: var(--tina-font-weight-regular);\n`;\n\ninterface FieldInputWrapper {\n  layout: \"row\" | \"column\";\n}\n\nconst FieldInputWrapper = styled.div<FieldInputWrapper>`\n  display: flex;\n  justify-content: flex-end;\n  align-items: center;\n\n  ${({ layout }) =>\n    layout === \"row\"\n      ? css`\n          flex-grow: 1;\n        `\n      : css`\n          width: 100%;\n        `};\n  min-height: 28px;\n`;\n","export const parse = (value?: string) => value && +value;\n","import React from \"react\";\nimport { wrapFieldsWithMeta } from \"./wrapFieldWithMeta\";\nimport { NumberInput as BaseNumberField, InputProps } from \"../components\";\nimport { parse } from \"./numberFormat\";\n\nconst NumberField = wrapFieldsWithMeta<{\n  step: string | number;\n  min?: number;\n  max?: number;\n  input: InputProps;\n}>(({ input, field }) => {\n  return (\n    <BaseNumberField\n      {...input}\n      step={field.step}\n      min={field.min}\n      max={field.max}\n    />\n  );\n});\n\nexport const NumberFieldPlugin = {\n  name: \"number\",\n  Component: NumberField,\n  parse,\n};\n","export const parse = (value?: string) => value || \"\";\n","import { wrapFieldsWithMeta } from \"./wrapFieldWithMeta\";\nimport { SelectFieldComponent } from \"../components\";\nimport { parse } from \"./textFormat\";\n\nconst SelectField = wrapFieldsWithMeta(SelectFieldComponent);\n\nexport const SelectFieldPlugin = {\n  name: \"select\",\n  type: \"select\",\n  Component: SelectField,\n  parse,\n};\n","import { wrapFieldsWithMeta } from \"./wrapFieldWithMeta\";\nimport { RadioGroup } from \"../components\";\n\nconst RadioGroupField = wrapFieldsWithMeta(RadioGroup);\n\nexport const RadioGroupFieldPlugin = {\n  name: \"radio-group\",\n  Component: RadioGroupField,\n};\n","import {\n  LocalTextReference,\n  ResponsiveValue,\n} from \"@redsun-vn/easyblocks-core\";\nimport {\n  InternalField,\n  useTextValue,\n} from \"@redsun-vn/easyblocks-core/_internals\";\nimport { Input } from \"@redsun-vn/easyblocks-design-system\";\nimport React from \"react\";\nimport { FieldRenderProps } from \"react-final-form\";\nimport { useEditorContext } from \"../../../EditorContext\";\nimport { parse } from \"./textFormat\";\nimport { FieldMetaWrapper } from \"./wrapFieldWithMeta\";\n\ntype TextFieldProps = FieldRenderProps<\n  ResponsiveValue<string> | LocalTextReference\n> & {\n  field: InternalField & {\n    placeholder?: string;\n    normalize: (value: string) => string | null;\n  };\n};\n\nfunction TextField({ input, field, noWrap }: TextFieldProps) {\n  const editorContext = useEditorContext();\n  const { value, onChange, ...restInputProperties } = input;\n\n  const inputProps = useTextValue(\n    value,\n    onChange,\n    editorContext.contextParams.locale,\n    editorContext.locales,\n    field.placeholder,\n    field.normalize\n  );\n\n  const isTextSchemaProp = field.schemaProp.type === \"text\";\n\n  return (\n    <FieldMetaWrapper\n      input={input}\n      field={field}\n      layout={isTextSchemaProp ? \"column\" : \"row\"}\n      noWrap={noWrap}\n    >\n      <Input\n        {...restInputProperties}\n        {...inputProps}\n        controlSize=\"full-width\"\n        align={!isTextSchemaProp ? \"right\" : \"left\"}\n        withBorder={isTextSchemaProp}\n      />\n    </FieldMetaWrapper>\n  );\n}\n\nexport const TextFieldPlugin = {\n  name: \"text\",\n  Component: TextField,\n  parse,\n};\n","import { wrapFieldsWithMeta } from \"./wrapFieldWithMeta\";\nimport { Toggle } from \"../components\";\n\nconst ToggleField = wrapFieldsWithMeta(Toggle);\n\nexport const ToggleFieldPlugin = {\n  name: \"toggle\",\n  type: \"checkbox\",\n  Component: ToggleField,\n};\n","import {\n  TokenValue as CoreTokenValue,\n  Field,\n  NonNullish,\n  ThemeFont,\n  ThemeTokenValue,\n  TokenTypeWidgetComponentProps,\n  getDevicesWidths,\n  isTrulyResponsiveValue,\n  responsiveValueFill,\n  responsiveValueForceGet,\n  responsiveValueGetDefinedValue,\n} from \"@redsun-vn/easyblocks-core\";\nimport {\n  Colors,\n  Input,\n  Select,\n  SelectItem,\n  SelectSeparator,\n} from \"@redsun-vn/easyblocks-design-system\";\nimport React, {\n  ComponentType,\n  Fragment,\n  ReactNode,\n  forwardRef,\n  useRef,\n  useState,\n} from \"react\";\nimport { FieldRenderProps } from \"react-final-form\";\nimport { styled } from \"styled-components\";\nimport { EditorContextType, useEditorContext } from \"../../../../EditorContext\";\nimport { FieldMixedValue } from \"../../../../types\";\nimport { MIXED_VALUE } from \"../../components/constants\";\nimport { isMixedFieldValue } from \"../../components/isMixedFieldValue\";\nimport { wrapFieldsWithMeta } from \"../wrapFieldWithMeta\";\n\ninterface TokenField<TokenValue extends NonNullish = NonNullish> extends Field {\n  tokens: { [key: string]: ThemeTokenValue<TokenValue> };\n  normalizeCustomValue?: (value: string) => any;\n  allowCustom?: boolean;\n  extraValues?: Array<string | { value: string; label: string }>;\n}\n\ninterface TokenFieldProps<TokenValue extends NonNullish>\n  extends FieldRenderProps<\n    CoreTokenValue | FieldMixedValue,\n    HTMLSelectElement\n  > {\n  field: TokenField<TokenValue>;\n}\n\nconst CUSTOM_OPTION_VALUE = \"__custom__\";\n\nfunction extraValuesIncludes(\n  extraValues: Array<string | { value: string; label: string }>,\n  value: string\n) {\n  for (let i = 0; i < extraValues.length; i++) {\n    const extraValue = extraValues[i];\n    if (typeof extraValue === \"string\") {\n      if (extraValue === value) {\n        return true;\n      }\n    } else {\n      if (extraValue.value === value) {\n        return true;\n      }\n    }\n  }\n  return false;\n}\n\ntype TokenTypesResult = Record<\n  string,\n  Extract<EditorContextType[\"types\"][string], { type: \"token\" }>\n>;\n\nfunction useTokenTypes(): TokenTypesResult {\n  const editorContext = useEditorContext();\n\n  const tokenTypes = Object.fromEntries(\n    Object.entries(editorContext.types).filter<\n      [string, TokenTypesResult[string]]\n    >(\n      (\n        typeDefinitionEntry\n      ): typeDefinitionEntry is [string, TokenTypesResult[string]] => {\n        return typeDefinitionEntry[1].type === \"token\";\n      }\n    )\n  );\n\n  return tokenTypes;\n}\n\nfunction TokenFieldComponent<TokenValue extends NonNullish>({\n  input,\n  field,\n}: TokenFieldProps<TokenValue>) {\n  const editorContext = useEditorContext();\n  const tokenTypes = useTokenTypes();\n  const tokenTypeDefinition = tokenTypes[field.schemaProp.type];\n  const normalizeCustomValue = field.normalizeCustomValue || ((x: string) => x);\n  const allowCustom = field.allowCustom ?? false;\n  const extraValues = field.extraValues ?? [];\n\n  const [inputValue, setInputValue] = useState(\n    isMixedFieldValue(input.value) ? \"\" : input.value?.value.toString() ?? \"\"\n  );\n\n  const customValueTextFieldRef = useRef<HTMLInputElement | null>(null);\n\n  const options = Object.entries(field.tokens).map(([tokenId, tokenValue]) => {\n    if (tokenTypeDefinition.token === \"fonts\") {\n      const fontTokenLabel = getFontTokenLabel(\n        tokenId,\n        tokenValue,\n        editorContext\n      );\n\n      return {\n        id: tokenId,\n        label: fontTokenLabel,\n      };\n    }\n\n    return {\n      id: tokenId,\n      label: tokenValue.label ?? tokenId,\n    };\n  });\n\n  // Extra values are displayed in select\n  if (field.extraValues) {\n    field.extraValues.forEach((extraValue) => {\n      if (typeof extraValue === \"string\") {\n        options.push({\n          id: extraValue,\n          label: extraValue,\n        });\n      } else {\n        options.push({\n          id: extraValue.value,\n          label: extraValue.label,\n        });\n      }\n    });\n  }\n\n  // If token exist but is removed from a theme -> let's add special option for this\n  if (\n    !isMixedFieldValue(input.value) &&\n    typeof input.value.tokenId === \"string\" &&\n    !field.tokens[input.value.tokenId]\n  ) {\n    options.unshift({\n      id: input.value.tokenId,\n      label: `(removed) ${input.value.tokenId}`,\n    });\n  }\n\n  const isExtraValueSelected =\n    !isMixedFieldValue(input.value) &&\n    !input.value.tokenId &&\n    extraValuesIncludes(\n      extraValues,\n      responsiveValueGetDefinedValue(\n        input.value.value,\n        editorContext.breakpointIndex,\n        editorContext.devices,\n        getDevicesWidths(\n          editorContext.devices\n        ) /** FOR NOW TOKENS ARE RELATIVE TO SCREEN **/\n      ) as string\n    );\n\n  const shouldShowCustomValueInput =\n    !isMixedFieldValue(input.value) &&\n    !(input.value.tokenId || isExtraValueSelected) &&\n    allowCustom;\n\n  const selectValue = isMixedFieldValue(input.value)\n    ? MIXED_VALUE\n    : input.value.tokenId ??\n      (isExtraValueSelected\n        ? (input.value.value as string)\n        : CUSTOM_OPTION_VALUE);\n\n  const onSelectChange = (selectedValue: string) => {\n    if (selectedValue === CUSTOM_OPTION_VALUE) {\n      if (isMixedFieldValue(input.value)) {\n        input.onChange({\n          value: \"\",\n          widgetId: tokenTypeDefinition.widget?.id,\n        });\n        setInputValue(\"\");\n        return;\n      }\n\n      let value = input.value.value;\n\n      // responsive token values are transformed into value from current breakpoint\n      if (isTrulyResponsiveValue(value)) {\n        value = responsiveValueGetDefinedValue(\n          // Not sure about usage of responsiveValueGet without widths\n          value,\n          editorContext.breakpointIndex,\n          editorContext.devices,\n          getDevicesWidths(\n            editorContext.devices\n          ) /** FOR NOW TOKENS ARE RELATIVE TO SCREEN **/\n        ) as string;\n      }\n\n      input.onChange({\n        value,\n        widgetId: input.value.widgetId,\n      });\n      setInputValue(value);\n\n      queueMicrotask(() => {\n        customValueTextFieldRef.current?.focus();\n      });\n    } else if (extraValuesIncludes(extraValues, selectedValue)) {\n      input.onChange({\n        value: selectedValue,\n        widgetId: tokenTypeDefinition.widget?.id,\n      });\n    } else {\n      input.onChange({\n        tokenId: selectedValue,\n        value: field.tokens[selectedValue].value,\n        widgetId: tokenTypeDefinition.widget?.id,\n      });\n    }\n  };\n\n  const CustomInputWidgetComponent = tokenTypeDefinition?.widget?.component as\n    | ComponentType<TokenTypeWidgetComponentProps<string>>\n    | undefined;\n\n  const customInputElement = shouldShowCustomValueInput ? (\n    <div>\n      <div style={{ height: 4 }} />\n      {CustomInputWidgetComponent ? (\n        <CustomInputWidgetComponent\n          value={inputValue}\n          onChange={(value) => {\n            input.onChange({\n              value,\n              widgetId: tokenTypeDefinition.widget?.id,\n            });\n          }}\n          params={\n            \"params\" in field.schemaProp ? field.schemaProp.params : undefined\n          }\n        />\n      ) : (\n        <Input\n          value={inputValue}\n          onChange={(e: React.ChangeEvent<HTMLInputElement>) => {\n            setInputValue(e.target.value);\n          }}\n          onBlur={() => {\n            const normalizedValue = normalizeCustomValue(inputValue);\n            setInputValue(normalizedValue);\n            input.onChange({\n              value: normalizedValue,\n            });\n          }}\n          ref={customValueTextFieldRef}\n          align={\"right\"}\n        />\n      )}\n    </div>\n  ) : null;\n\n  if (tokenTypeDefinition.token === \"colors\") {\n    return (\n      <Fragment>\n        <Select value={selectValue} onChange={onSelectChange}>\n          {isMixedFieldValue(input.value) && (\n            <>\n              <SelectColorTokenItem value={MIXED_VALUE} isDisabled>\n                Mixed\n              </SelectColorTokenItem>\n              <SelectSeparator />\n            </>\n          )}\n          {\n            <Fragment>\n              {options.map((o) => {\n                return (\n                  <SelectColorTokenItem\n                    key={o.id}\n                    value={o.id}\n                    // Color tokens are always strings\n                    previewColor={\n                      (field.tokens[o.id]?.value as unknown as\n                        | string\n                        | undefined) ?? o.id\n                    }\n                  >\n                    {o.label}\n                  </SelectColorTokenItem>\n                );\n              })}\n              {allowCustom && (\n                <>\n                  <SelectSeparator />\n                  <SelectColorTokenItem\n                    value={CUSTOM_OPTION_VALUE}\n                    previewColor={\n                      selectValue === CUSTOM_OPTION_VALUE\n                        ? ((\n                            input.value as Exclude<\n                              (typeof input)[\"value\"],\n                              FieldMixedValue\n                            >\n                          ).value as string)\n                        : undefined\n                    }\n                  >\n                    Custom\n                  </SelectColorTokenItem>\n                </>\n              )}\n            </Fragment>\n          }\n        </Select>\n        {customInputElement}\n      </Fragment>\n    );\n  }\n\n  return (\n    <Root>\n      <Select value={selectValue} onChange={onSelectChange}>\n        {isMixedFieldValue(input.value) && (\n          <>\n            <SelectItem value={MIXED_VALUE} isDisabled>\n              Mixed\n            </SelectItem>\n            <SelectSeparator />\n          </>\n        )}\n\n        {selectValue === CUSTOM_OPTION_VALUE && !allowCustom && (\n          <>\n            <SelectItem value={CUSTOM_OPTION_VALUE} isDisabled>\n              Custom\n            </SelectItem>\n            <SelectSeparator />\n          </>\n        )}\n        {\n          <Fragment>\n            {options.map((o) => {\n              return (\n                <SelectItem key={o.id} value={o.id}>\n                  {o.label}\n                </SelectItem>\n              );\n            })}\n            {allowCustom && (\n              <>\n                <SelectSeparator />\n                <SelectItem value={CUSTOM_OPTION_VALUE}>Custom</SelectItem>\n              </>\n            )}\n          </Fragment>\n        }\n      </Select>\n      {customInputElement}\n    </Root>\n  );\n}\n\nfunction getFontTokenLabel(\n  name: string,\n  token: ThemeTokenValue<ThemeFont>,\n  editorContext: EditorContextType\n) {\n  const filledResponsiveFontValue = responsiveValueFill(\n    token.value,\n    editorContext.devices,\n    getDevicesWidths(editorContext.devices)\n  );\n\n  const currentDeviceFontValue = responsiveValueForceGet(\n    filledResponsiveFontValue,\n    editorContext.breakpointIndex\n  );\n\n  if (isValidFontTokenValue(currentDeviceFontValue)) {\n    return `${token.label ?? name} (${stripPxUnit(\n      currentDeviceFontValue.fontSize\n    )}/${stripPxUnit(currentDeviceFontValue.lineHeight)})`;\n  }\n\n  return token.label ?? name;\n}\n\nfunction stripPxUnit(value: number | string) {\n  if (typeof value === \"number\") {\n    return value;\n  }\n\n  return value.replace(new RegExp(\"px\"), \"\");\n}\n\nfunction isValidFontTokenValue(value: unknown): value is {\n  fontSize: number | string;\n  lineHeight: number | string;\n} {\n  return (\n    typeof value === \"object\" &&\n    value !== null &&\n    \"fontSize\" in value &&\n    \"lineHeight\" in value\n  );\n}\n\nconst Root = styled.div`\n  display: flex;\n  flex-direction: column;\n  align-items: flex-end;\n`;\n\nexport const TokenFieldPlugin = {\n  name: \"token\",\n  type: \"token\",\n  Component: wrapFieldsWithMeta(TokenFieldComponent),\n};\n\nconst SelectColorTokenItem = forwardRef<\n  HTMLDivElement,\n  {\n    children: ReactNode;\n    previewColor?: string;\n    value: string;\n    isDisabled?: boolean;\n  }\n>((props, ref) => {\n  return (\n    <SelectItem value={props.value} isDisabled={props.isDisabled} ref={ref}>\n      <span\n        style={{\n          display: \"flex\",\n          alignItems: \"center\",\n          gap: \"6px\",\n        }}\n      >\n        <svg\n          xmlns=\"http://www.w3.org/2000/svg\"\n          width=\"15\"\n          height=\"16\"\n          viewBox=\"0 0 15 16\"\n          fill=\"none\"\n        >\n          <circle\n            cx=\"7.28931\"\n            cy=\"8.00024\"\n            r=\"6.78931\"\n            fill={props.previewColor ?? \"#fff\"}\n            stroke={Colors.black100}\n          />\n        </svg>\n        <span>{props.children}</span>\n      </span>\n    </SelectItem>\n  );\n});\n","const RICH_TEXT_PART_CONFIG_PATH_REGEXP =\n  /\\.elements\\.[a-z(\\-_A-Z)?]+\\.\\d+(\\.elements\\.\\d+){2,3}(\\.\\{\\d+,\\d+\\})?$/;\n\nfunction isConfigPathRichTextPart(configPath: string): boolean {\n  return RICH_TEXT_PART_CONFIG_PATH_REGEXP.test(configPath);\n}\n\nexport { isConfigPathRichTextPart, RICH_TEXT_PART_CONFIG_PATH_REGEXP };\n","/**\n *\n * @param collection Array of values\n * @param mapper Optional callback function that will be invoked for each item of given array to map it into comparable string\n */\nfunction getUniqueValues<\n  Collection extends Array<any>,\n  Item extends Collection[number]\n>(\n  collection: Collection,\n  mapper?: (item: Item, index: number) => string | undefined\n): Array<Item> {\n  if (mapper) {\n    const uniqueValues = new Set<string | undefined>();\n    const uniqueItems: Array<Item> = [];\n\n    collection.forEach((item, index) => {\n      const mappedItem = mapper(item, index);\n\n      if (!uniqueValues.has(mappedItem)) {\n        uniqueValues.add(mappedItem);\n        uniqueItems.push(item);\n      }\n    });\n\n    return uniqueItems;\n  }\n\n  return Array.from(new Set(collection));\n}\n\nexport { getUniqueValues };\n","import { SchemaProp } from \"@redsun-vn/easyblocks-core\";\nimport {\n  InternalComponentDefinition,\n  InternalField,\n} from \"@redsun-vn/easyblocks-core/_internals\";\nimport { last } from \"@/utils\";\nimport { getUniqueValues } from \"../../fields/components/getUniqueValues\";\n\nexport interface MergeCommonFieldsParameters {\n  fields: Array<Array<InternalField>>;\n}\n\nfunction mergeCommonFields({\n  fields,\n}: MergeCommonFieldsParameters): Array<InternalField> {\n  const mergedCommonFields: Array<InternalField> = [];\n  const fieldsGroupedByProperty = groupFieldsByPropertyName(fields.flat());\n\n  for (const currentFields of Object.values(fieldsGroupedByProperty)) {\n    if (currentFields.length < fields.length) {\n      continue;\n    }\n\n    /**\n     * Some fields can be hidden depending on the context of usage\n     * ex. margin bottom is not applicable to the last element in stack\n     */\n    const visibleFields = currentFields.filter((field) => {\n      return !field.hidden;\n    });\n\n    if (visibleFields.length === 0) {\n      continue;\n    }\n\n    const fieldDefinitionIds = visibleFields.map(\n      (field) => getFieldSchemaWithDefinition(field).definition.id\n    );\n\n    /**\n     * All fields for given property have to be defined within the same schema, because ex.\n     * field can have the same prop name in schema A, but different meaning in schema B\n     */\n    const uniqueDefinitionIds = getUniqueValues(fieldDefinitionIds);\n\n    // It's common when interacting with $richText to pass fields of parent or ancestor down to @easyblocks/rich-text-part.\n    // Verify if the all unique ids aren't fields of $richText components.\n    if (\n      uniqueDefinitionIds.length > 1 &&\n      !uniqueDefinitionIds.every((id) => id.startsWith(\"@easyblocks/rich-text\"))\n    ) {\n      continue;\n    }\n\n    const firstVisibleField = visibleFields[0];\n\n    mergedCommonFields.push({\n      ...firstVisibleField,\n      name:\n        visibleFields.length === 1\n          ? firstVisibleField.name\n          : getUniqueValues(visibleFields.flatMap((field) => field.name)),\n    });\n  }\n\n  return mergedCommonFields;\n}\n\nfunction groupFieldsByPropertyName(\n  fields: Array<InternalField>\n): Record<string, Array<InternalField>> {\n  return fields.reduce((repeatedFields, field) => {\n    const currentFieldPropertyName = getPropertyName(field.schemaProp.prop);\n    const fields = repeatedFields[currentFieldPropertyName];\n    repeatedFields[currentFieldPropertyName] =\n      fields !== undefined ? [...fields, field] : [field];\n    return repeatedFields;\n  }, {} as Record<string, Array<InternalField>>);\n}\n\nfunction getPropertyName(fieldName: string): string {\n  const fieldNameParts = fieldName.split(\".\");\n  let lastPart = last(fieldNameParts);\n\n  // If property name starts with `$` sign it's a special property of fake field.\n  if (lastPart.startsWith(\"$\")) {\n    lastPart = lastPart.slice(1);\n  }\n\n  if (fieldNameParts[0] === \"$previous\") {\n    return `${fieldNameParts[0]}.${lastPart}`;\n  }\n\n  return lastPart;\n}\n\nfunction getFieldSchemaWithDefinition(field: InternalField): SchemaProp & {\n  definition: InternalComponentDefinition;\n} {\n  return field.schemaProp as SchemaProp & {\n    definition: InternalComponentDefinition;\n  };\n}\n\nexport { mergeCommonFields };\n","import {\n  NoCodeComponentEntry,\n  ComponentSchemaProp,\n  ExternalData,\n  ExternalReference,\n  LocalTextReference,\n  NoCodeComponentDefinition,\n  SidebarPreviewVariant,\n  resolveExternalValue,\n  resolveLocalisedValue,\n  responsiveValueForceGet,\n} from \"@redsun-vn/easyblocks-core\";\nimport {\n  Component$$$SchemaProp,\n  InternalField,\n  findComponentDefinition,\n  isExternalSchemaProp,\n} from \"@redsun-vn/easyblocks-core/_internals\";\nimport {\n  ButtonGhost,\n  Colors,\n  Fonts,\n  Icons,\n  ThumbnailButton,\n  ThumbnailType,\n  Typography,\n} from \"@redsun-vn/easyblocks-design-system\";\nimport { dotNotationGet, toArray } from \"@/utils\";\nimport React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { styled, css, keyframes } from \"styled-components\";\nimport { useConfigAfterAuto } from \"../../../ConfigAfterAutoContext\";\nimport { EditorContextType, useEditorContext } from \"../../../EditorContext\";\nimport { useEditorExternalData } from \"../../../EditorExternalDataProvider\";\nimport { SidebarFooter } from \"../../../SidebarFooter\";\nimport { buildTinaFields } from \"../../../buildTinaFields\";\nimport { FieldMixedValue } from \"../../../types\";\nimport { isConfigPathRichTextPart } from \"../../../utils/isConfigPathRichTextPart\";\nimport { FieldRenderProps, FieldsBuilder } from \"../../form-builder\";\nimport { mergeCommonFields } from \"../../form-builder/utils/mergeCommonFields\";\nimport { isMixedFieldValue } from \"../components/isMixedFieldValue\";\nimport { Form } from \"../../../form\";\nimport { FormApi } from \"final-form\";\n\ninterface BlocksFieldDefinition extends InternalField {\n  component: \"block\";\n  schemaProp: ComponentSchemaProp | Component$$$SchemaProp;\n}\n\ninterface BlockFieldProps\n  extends FieldRenderProps<NoCodeComponentEntry[] | FieldMixedValue> {\n  field: BlocksFieldDefinition;\n  form: FormApi;\n  tinaForm: Form;\n  isLabelHidden?: boolean;\n}\n\nconst BlockField = ({ field, input, isLabelHidden }: BlockFieldProps) => {\n  const [isSubcomponentPanelExpanded, setIsSubcomponentPanelExpanded] =\n    React.useState(false);\n  const editorContext = useEditorContext();\n  const { actions } = editorContext;\n  const { openComponentPicker } = actions;\n  const isMixed = isMixedFieldValue(input.value);\n\n  const config: NoCodeComponentEntry | null = (() => {\n    if (isMixed) {\n      return null;\n    }\n\n    // @ts-expect-error We can safely ignore the error since we know the value is not mixed\n    return input.value[0] || null;\n  })();\n\n  const normalizedName = toArray(field.name);\n  // Let's create paths\n  const paths = normalizedName.map((x) => `${x}.0`);\n  const componentPickerPath = normalizedName[0];\n\n  return (\n    <>\n      {!isLabelHidden && (\n        <div\n          style={{\n            display: \"flex\",\n            alignItems: \"center\",\n            padding: \"4px 16px\",\n            minHeight: \"28px\",\n          }}\n        >\n          <Typography>{field.label || field.name}</Typography>\n        </div>\n      )}\n      <div\n        style={{\n          display: \"flex\",\n          justifyContent: \"space-between\",\n          alignItems: \"center\",\n          padding: \"4px 16px\",\n        }}\n      >\n        {config !== null && (\n          <>\n            <div style={{ flex: \"1 1 auto\", minWidth: 0 }}>\n              <SubComponentPanelButton\n                paths={paths}\n                isExpanded={isSubcomponentPanelExpanded}\n                onExpand={() => {\n                  setIsSubcomponentPanelExpanded(true);\n                }}\n                onCollapse={() => {\n                  setIsSubcomponentPanelExpanded(false);\n                }}\n              />\n            </div>\n            {!field.schemaProp.required && (\n              <div style={{ flex: \"0 0 auto\", minWidth: 0 }}>\n                <ButtonGhost\n                  onClick={() => {\n                    if (\n                      editorContext.focussedField.some(isConfigPathRichTextPart)\n                    ) {\n                      input.onChange([]);\n                    } else {\n                      actions.removeItems(paths);\n                    }\n                  }}\n                  icon={Icons.Remove}\n                  aria-label=\"Remove\"\n                />\n              </div>\n            )}\n          </>\n        )}\n\n        {config === null &&\n          (isMixed ? (\n            <ThumbnailButton label={\"Mixed\"} disabled={true} />\n          ) : (\n            <AddButton\n              onAdd={() => {\n                openComponentPicker({ path: componentPickerPath }).then(\n                  (newConfig) => {\n                    if (newConfig) {\n                      if (\n                        editorContext.focussedField.some(\n                          isConfigPathRichTextPart\n                        )\n                      ) {\n                        input.onChange([newConfig]);\n                      } else {\n                        actions.replaceItems(paths, newConfig);\n                      }\n\n                      setIsSubcomponentPanelExpanded(true);\n                    }\n                  }\n                );\n              }}\n            />\n          ))}\n      </div>\n    </>\n  );\n};\n\ninterface AddButtonProps {\n  onAdd: () => void;\n}\n\nfunction AddButton({ onAdd }: AddButtonProps) {\n  return (\n    <ButtonGhost\n      style={{\n        width: \"100%\",\n        paddingLeft: \"0\",\n      }}\n      onClick={onAdd}\n      height={\"32px\"}\n      noPadding\n    >\n      <div\n        style={{\n          display: \"flex\",\n          alignItems: \"center\",\n          gap: \"8px\",\n          width: \"100%\",\n        }}\n      >\n        <div\n          style={{\n            display: \"grid\",\n            placeItems: \"center\",\n            width: \"32px\",\n            height: \"32px\",\n            marginLeft: \"-1px\",\n            border: `1px dashed ${Colors.black20}`,\n            borderRadius: \"2px\",\n          }}\n        >\n          <Icons.Add size={16} />\n        </div>\n        Add\n      </div>\n    </ButtonGhost>\n  );\n}\n\ninterface SubComponentPanelButtonProps {\n  paths: string[];\n  isExpanded: boolean;\n  onExpand: () => void;\n  onCollapse: () => void;\n}\n\nconst SubComponentPanelButton = ({\n  paths,\n  isExpanded,\n  onExpand,\n  onCollapse,\n}: SubComponentPanelButtonProps) => {\n  const sidebarPanelsRoot = document.getElementById(\"sidebar-panels-root\");\n  const editorContext = useEditorContext();\n  const externalData = useEditorExternalData();\n  const entryAfterAuto = useConfigAfterAuto();\n\n  const config = dotNotationGet(editorContext.form.values, paths[0]);\n  const componentDefinition = findComponentDefinition(config, editorContext);\n  const label =\n    componentDefinition?.label ??\n    componentDefinition?.id ??\n    `Cant find custom component with id: ${config._component} in your project. Please contact your developers to resolve this issue.`;\n  const showError = componentDefinition === undefined;\n\n  const sidebarPreview = componentDefinition\n    ? getSidebarPreview(\n        componentDefinition,\n        dotNotationGet(entryAfterAuto, paths[0]),\n        externalData,\n        editorContext\n      )\n    : undefined;\n\n  const defaultThumbnail: ThumbnailType | undefined =\n    componentDefinition?.thumbnail\n      ? { type: \"image\", src: componentDefinition.thumbnail }\n      : undefined;\n  const thumbnail: ThumbnailType | undefined =\n    sidebarPreview?.thumbnail ?? defaultThumbnail;\n  const description: string | undefined = sidebarPreview?.description;\n\n  return showError ? (\n    <Error>{label}</Error>\n  ) : (\n    <>\n      <ThumbnailButton\n        onClick={onExpand}\n        label={label}\n        description={description}\n        thumbnail={thumbnail}\n      />\n\n      {sidebarPanelsRoot &&\n        ReactDOM.createPortal(\n          <Panel\n            isExpanded={isExpanded}\n            onCollapse={onCollapse}\n            paths={paths}\n          />,\n          sidebarPanelsRoot\n        )}\n    </>\n  );\n};\n\nfunction getSidebarPreview(\n  componentDefinition: NoCodeComponentDefinition,\n  entryAfterAuto: NoCodeComponentEntry,\n  externalData: ExternalData,\n  editorContext: EditorContextType\n): SidebarPreviewVariant | undefined {\n  const previewValues = Object.fromEntries(\n    componentDefinition.schema.map((s) => {\n      const value = responsiveValueForceGet(\n        entryAfterAuto[s.prop],\n        editorContext.breakpointIndex\n      );\n\n      if (isExternalSchemaProp(s, editorContext.types)) {\n        const externalDataValue = resolveExternalValue(\n          value as ExternalReference,\n          entryAfterAuto._id,\n          s,\n          externalData\n        );\n        return [s.prop, externalDataValue];\n      }\n\n      if (s.type === \"text\") {\n        return [\n          s.prop,\n          resolveLocalisedValue<string>(\n            (value as LocalTextReference).value,\n            editorContext\n          )?.value,\n        ];\n      }\n\n      return [s.prop, value];\n    })\n  );\n\n  return componentDefinition.preview?.({ values: previewValues, externalData });\n}\n\nconst Error = styled.div`\n  ${Fonts.body}\n  padding: 7px 6px 7px;\n  color: hsl(0deg 0% 50% / 0.8);\n  white-space: normal;\n  background: hsl(0deg 100% 50% / 0.2);\n  margin-right: 10px;\n  border-radius: 2px;\n`;\n\ninterface PanelProps {\n  onCollapse(): void;\n  isExpanded: boolean;\n  paths: string[];\n}\n\nexport const PanelContext = React.createContext<\n  { onClose: () => void } | undefined\n>(undefined);\n\nfunction Panel({ onCollapse, isExpanded, paths }: PanelProps) {\n  const editorContext = useEditorContext();\n\n  const fields: Array<InternalField> = React.useMemo(() => {\n    if (!isExpanded) {\n      return [];\n    }\n\n    const fieldsPerName = toArray(paths).map((path) => {\n      return buildTinaFields(path, editorContext);\n    });\n\n    const mergedFields = mergeCommonFields({\n      fields: fieldsPerName,\n    });\n\n    return mergedFields;\n  }, [isExpanded, paths]);\n\n  return (\n    <PanelContext.Provider\n      value={{\n        onClose: onCollapse,\n      }}\n    >\n      <GroupPanel isExpanded={isExpanded}>\n        <PanelBody>\n          {isExpanded ? (\n            <div>\n              <FieldsBuilder form={editorContext.form} fields={fields} />\n              <SidebarFooter paths={paths} />\n            </div>\n          ) : null}\n        </PanelBody>\n      </GroupPanel>\n    </PanelContext.Provider>\n  );\n}\n\nexport const BlockFieldPlugin = {\n  __type: \"field\",\n  name: \"block\",\n  Component: BlockField,\n};\n\nconst PanelBody = styled.div`\n  background: white;\n  position: relative;\n  height: 100%;\n  overflow-y: auto;\n`;\n\nconst GroupPanelKeyframes = keyframes`\n  0% {\n    transform: translate3d( 100%, 0, 0 );\n  }\n  100% {\n    transform: translate3d( 0, 0, 0 );\n  }\n`;\n\nconst GroupPanel = styled.div<{ isExpanded: boolean }>`\n  position: absolute;\n  width: 100%;\n  top: 0;\n  bottom: 0;\n  left: 0;\n  overflow: hidden;\n  /* z-index: var(--tina-z-index-1); */\n  pointer-events: ${(p) => (p.isExpanded ? \"all\" : \"none\")};\n\n  > * {\n    ${(p) =>\n      p.isExpanded &&\n      css`\n        animation-name: ${GroupPanelKeyframes};\n        animation-duration: 150ms;\n        animation-delay: 0ms;\n        animation-iteration-count: 1;\n        animation-timing-function: ease-out;\n        animation-fill-mode: backwards;\n      `};\n\n    ${(p) =>\n      !p.isExpanded &&\n      css`\n        transition: transform 150ms ease-out;\n        transform: translate3d(100%, 0, 0);\n      `};\n  }\n`;\n","import {\n  ComponentSchemaProp,\n  Field,\n  NoCodeComponentEntry,\n} from \"@redsun-vn/easyblocks-core\";\nimport {\n  findComponentDefinitionById,\n  parsePath,\n} from \"@redsun-vn/easyblocks-core/_internals\";\nimport {\n  ButtonGhost,\n  Icons,\n  Typography,\n} from \"@redsun-vn/easyblocks-design-system\";\nimport { toArray } from \"@/utils\";\nimport React, { useContext } from \"react\";\nimport type { FieldRenderProps } from \"react-final-form\";\nimport { css } from \"styled-components\";\nimport { useEditorContext } from \"../../../EditorContext\";\nimport { isMixedFieldValue } from \"../components/isMixedFieldValue\";\nimport { PanelContext } from \"./BlockFieldPlugin\";\n\ninterface IdentityFieldProps\n  extends FieldRenderProps<NoCodeComponentEntry, HTMLElement> {\n  field: Field;\n}\n\nfunction IdentityField({ input, field }: IdentityFieldProps) {\n  const editorContext = useEditorContext();\n  const panelContext = useContext(PanelContext);\n\n  const isMixed = isMixedFieldValue(input.value);\n  const config = isMixed ? null : input.value;\n\n  if (config == null) {\n    return null;\n  }\n\n  const componentDefinition = findComponentDefinitionById(\n    config._component,\n    editorContext\n  );\n\n  const configPaths = toArray(field.name);\n  const { parent } = parsePath(configPaths[0], editorContext.form);\n  const isWithinNestedPanel = panelContext !== undefined;\n\n  const parentComponentDefinition = parent\n    ? findComponentDefinitionById(parent.templateId, editorContext)\n    : undefined;\n  const parentSchemaProp = parentComponentDefinition?.schema.find(\n    (schemaProp) => schemaProp.prop === parent!.fieldName\n  );\n\n  const isNonRemovable =\n    (componentDefinition?.id.startsWith(\"@easyblocks/rich-text\") &&\n      componentDefinition.id !== \"@easyblocks/rich-text\") ||\n    (parentSchemaProp\n      ? parentSchemaProp.type === \"component\" &&\n        (parentSchemaProp as ComponentSchemaProp).required\n      : true);\n\n  const isNonChangable =\n    componentDefinition?.id === \"@easyblocks/rich-text-part\" ||\n    componentDefinition?.id === editorContext.rootComponent.id;\n\n  function handleChangeComponentType() {\n    if (isNonChangable) {\n      return;\n    }\n\n    if (!parent) {\n      return;\n    }\n\n    const componentPickerPath = parent.path + \".\" + parent.fieldName;\n\n    editorContext.actions\n      .openComponentPicker({ path: componentPickerPath })\n      .then((selectedConfig) => {\n        if (!selectedConfig) {\n          return;\n        }\n\n        editorContext.actions.replaceItems(configPaths, selectedConfig);\n      });\n  }\n\n  function handleRemove() {\n    if (isNonRemovable) {\n      return;\n    }\n\n    editorContext.actions.removeItems(configPaths);\n  }\n\n  const titleContent = (\n    <div\n      style={{\n        display: \"flex\",\n        alignItems: \"center\",\n        gap: \"2px\",\n      }}\n    >\n      <Typography\n        style={{\n          lineHeight: \"14px\",\n          fontWeight: \"700\",\n        }}\n      >\n        {componentDefinition?.label ?? componentDefinition?.id}\n      </Typography>\n      {!isNonChangable && <Icons.ChevronDown size={16} />}\n    </div>\n  );\n\n  return (\n    <div\n      style={{\n        display: \"flex\",\n        gap: \"8px\",\n        minHeight: \"28px\",\n        padding: \"10px\",\n      }}\n    >\n      <div\n        style={{\n          display: \"flex\",\n          alignItems: \"center\",\n          flex: \"1 0\",\n        }}\n      >\n        {isWithinNestedPanel && (\n          <ButtonGhost\n            icon={Icons.ChevronLeft}\n            onClick={() => {\n              panelContext.onClose();\n            }}\n            style={{\n              marginRight: \"auto\",\n            }}\n          />\n        )}\n\n        {isNonChangable && (\n          <div style={{ padding: \"7px 6px\" }}>{titleContent}</div>\n        )}\n        {!isNonChangable && (\n          <ButtonGhost onClick={handleChangeComponentType}>\n            {titleContent}\n          </ButtonGhost>\n        )}\n\n        <ButtonGhost\n          aria-label=\"Remove component\"\n          icon={Icons.Remove}\n          onClick={handleRemove}\n          style={{\n            marginLeft: \"auto\",\n            opacity: isNonRemovable ? 0 : 1,\n            pointerEvents: isNonRemovable ? \"none\" : \"auto\",\n          }}\n        />\n      </div>\n    </div>\n  );\n}\n\nconst IdentityFieldPlugin = {\n  name: \"identity\",\n  Component: IdentityField,\n};\n\nexport { IdentityFieldPlugin };\n","import { Typography } from \"@redsun-vn/easyblocks-design-system\";\nimport React from \"react\";\n\nexport function MissingWidget(props: { type: string }) {\n  return <Typography>Missing widget for type \"{props.type}\".</Typography>;\n}\n","import {\n  ExternalReference,\n  FetchCompoundResourceResultValues,\n  getExternalReferenceLocationKey,\n  isEmptyExternalReference,\n  isIdReferenceToDocumentExternalValue,\n  isResolvedCompoundExternalDataValue,\n} from \"@redsun-vn/easyblocks-core\";\nimport { Select, SelectItem } from \"@redsun-vn/easyblocks-design-system\";\nimport { dotNotationGet, toArray } from \"@/utils\";\nimport React, { ComponentType, useLayoutEffect } from \"react\";\nimport {\n  EditorContextType,\n  EditorExternalTypeDefinition,\n  useEditorContext,\n} from \"../../../../EditorContext\";\nimport { useEditorExternalData } from \"../../../../EditorExternalDataProvider\";\nimport {\n  FieldMixedValue,\n  InternalWidgetComponentProps,\n} from \"../../../../types\";\nimport { FieldRenderProps } from \"../../../form-builder\";\nimport { isMixedFieldValue } from \"../../components/isMixedFieldValue\";\nimport { MissingWidget } from \"../MissingWidget\";\nimport { FieldMetaWrapper } from \"../wrapFieldWithMeta\";\n\ntype ExternalFieldProps = FieldRenderProps<\n  ExternalReference | FieldMixedValue,\n  any\n>;\n\nconst ExternalFieldComponent = (props: ExternalFieldProps) => {\n  const {\n    tinaForm,\n    field,\n    input,\n    input: { value },\n  } = props;\n  const editorContext = useEditorContext();\n  const externalData = useEditorExternalData();\n\n  const fieldNames = toArray(field.name);\n\n  const isSchemaPropRootParam = field.schemaProp.type.startsWith(\"param__\");\n\n  const ExternalField: ComponentType<InternalWidgetComponentProps> | undefined =\n    !isMixedFieldValue(input.value)\n      ? isSchemaPropRootParam\n        ? getWidgetComponentForRootParam(input.value, editorContext)\n        : getWidgetComponentByType(\n            input.value,\n            field.schemaProp.type,\n            editorContext\n          )\n      : undefined;\n\n  const path = fieldNames[0].split(\".\").slice(0, -1).join(\".\");\n  const configId = dotNotationGet(editorContext.form.values, path)._id;\n  const externalReferenceLocationKey = getExternalReferenceLocationKey(\n    configId,\n    field.schemaProp.prop,\n    field.schemaProp.responsive ? editorContext.breakpointIndex : undefined\n  );\n  const externalValue = externalReferenceLocationKey\n    ? externalData[externalReferenceLocationKey]\n    : undefined;\n\n  const isExternalValueResolvedCompoundExternalDataValue =\n    !isMixedFieldValue(value) &&\n    !isEmptyExternalReference(value) &&\n    externalValue !== undefined &&\n    isResolvedCompoundExternalDataValue(externalValue);\n\n  const basicResources = isExternalValueResolvedCompoundExternalDataValue\n    ? getBasicResourcesOfType(externalValue.value, field.schemaProp.type)\n    : [];\n\n  const isCompoundResourceValueSelectVisible =\n    isExternalValueResolvedCompoundExternalDataValue &&\n    !isIdReferenceToDocumentExternalValue(value.id) &&\n    basicResources.length > 1;\n\n  useLayoutEffect(() => {\n    if (\n      isExternalValueResolvedCompoundExternalDataValue &&\n      basicResources.length === 1 &&\n      !value.key\n    ) {\n      // We perform form change manually to avoid storing this change in editor's history\n      editorContext.form.change(fieldNames[0], {\n        ...value,\n        key: basicResources[0].key,\n      });\n    }\n  });\n\n  return (\n    <FieldMetaWrapper {...props} form={tinaForm} layout=\"column\">\n      <div\n        style={{\n          width: \"100%\",\n        }}\n      >\n        {isMixedFieldValue(value) ? (\n          \"Mixed\"\n        ) : (\n          <div\n            style={{\n              display: \"flex\",\n              flexDirection: \"column\",\n              alignItems: \"flex-start\",\n              gap: \"8px\",\n            }}\n          >\n            {ExternalField ? (\n              <ExternalField\n                id={value.id}\n                resourceKey={\"key\" in value ? value.key : undefined}\n                onChange={(newId, newKey) => {\n                  const newValue: ExternalReference = {\n                    id: newId,\n                    widgetId: value.widgetId,\n                  };\n\n                  if (newKey && newValue.id !== null) {\n                    newValue.key = newKey;\n                  }\n\n                  input.onChange(newValue);\n                }}\n                path={fieldNames[0]}\n                params={field.schemaProp.params}\n              />\n            ) : (\n              <MissingWidget type={field.schemaProp.type} />\n            )}\n\n            {isCompoundResourceValueSelectVisible && (\n              <CompoundResourceValueSelect\n                options={basicResources.map((r) => ({\n                  id: externalReferenceLocationKey,\n                  key: r.key,\n                  label: r.label ?? r.key,\n                }))}\n                resource={{\n                  id: externalReferenceLocationKey,\n                  key: value.key,\n                }}\n                onResourceKeyChange={(_, key) => {\n                  input.onChange({\n                    ...value,\n                    key,\n                  });\n                }}\n              />\n            )}\n          </div>\n        )}\n      </div>\n    </FieldMetaWrapper>\n  );\n};\n\nexport const ExternalFieldPlugin = {\n  name: \"external\",\n  Component: ExternalFieldComponent,\n};\n\nfunction getWidgetComponentByType(\n  externalReference: ExternalReference,\n  type: string,\n  editorContext: EditorContextType\n) {\n  return (\n    editorContext.types[type] as EditorExternalTypeDefinition\n  ).widgets.find((w) => w.id === externalReference.widgetId)?.component;\n}\n\nfunction getWidgetComponentForRootParam(\n  externalReference: ExternalReference,\n  editorContext: EditorContextType\n) {\n  return Object.values(editorContext.types)\n    .filter((t): t is EditorExternalTypeDefinition => t.type === \"external\")\n    .flatMap((t) => t.widgets)\n    .find((w) => w.id === externalReference.widgetId)?.component;\n}\n\nexport function getBasicResourcesOfType(\n  compoundResourceValues: FetchCompoundResourceResultValues,\n  type: string\n) {\n  return Object.entries(compoundResourceValues)\n    .filter(([, r]) => r.type === type)\n    .map(([key, r]) => {\n      return {\n        key,\n        ...r,\n      };\n    });\n}\n\nexport function CompoundResourceValueSelect(props: {\n  options: Array<{ id: string; key: string; label: string }>;\n  resource:\n    | { id: null; key: undefined }\n    | { id: string; key: string | undefined };\n  onResourceKeyChange: (id: string, key: string) => void;\n}) {\n  return (\n    <Select\n      onChange={(value) => {\n        const selectedOption = JSON.parse(value);\n        props.onResourceKeyChange(selectedOption.id, selectedOption.key);\n      }}\n      value={\n        props.resource.id !== null && props.resource.key !== undefined\n          ? JSON.stringify({ id: props.resource.id, key: props.resource.key })\n          : \"\"\n      }\n      placeholder=\"Select source...\"\n    >\n      {props.options.map((r) => {\n        return (\n          <SelectItem\n            key={`${r.id}.${r.key}`}\n            value={JSON.stringify({ id: r.id, key: r.key })}\n          >\n            {r.label}\n          </SelectItem>\n        );\n      })}\n    </Select>\n  );\n}\n","import {\n  isTrulyResponsiveValue,\n  responsiveValueForceGet,\n} from \"@redsun-vn/easyblocks-core\";\nimport { InternalField } from \"@redsun-vn/easyblocks-core/_internals\";\nimport { dotNotationGet, toArray } from \"@/utils\";\nimport { EditorContextType } from \"../../../../EditorContext\";\nimport { Form } from \"../../../../form\";\n\nexport type ResponsiveFieldDefinition = Omit<InternalField, \"component\"> & {\n  component: \"responsive2\";\n  subComponent: string;\n  hasAuto?: boolean;\n};\n\ntype ResponsiveFieldController = {\n  field: InternalField;\n  isResponsive: boolean;\n  isSet: boolean;\n  reset: () => void;\n  toggleOffAuto: () => void;\n};\n\nfunction getSavedValue(\n  value: any,\n  previousValue: any,\n  editorContext: EditorContextType\n) {\n  const breakpointIndex = editorContext.breakpointIndex;\n\n  if (typeof value === \"string\" && value.startsWith(\"##\")) {\n    // return value; -- commented based on comments below\n    // we could potentially change that logic to setting only the current breakpoint. There are use cases when this makes sense.\n    // 1. If we have a section \"from library\" with some default and we change value to responsive, we usually want to change it for all breakpoints.\n    // 2. However, if we set mobile and go to desktop and change value to responsive, we actually want to set it only to a specific breakpoint and not touch mobile.\n    // 3. If default were responsive, it'd be easier and we'd go with 2.\n    // 4. Changing entire set to responsive value is dangerous if someone set some breakpoint nicely. It would break.\n  }\n\n  // Responsiveness is not enabled for this field\n  if (!isTrulyResponsiveValue(previousValue)) {\n    if (value === undefined || value === null) {\n      return null;\n    }\n\n    return value;\n  }\n\n  const result = { ...previousValue };\n  result[breakpointIndex] = value;\n  return result;\n}\n\nexport function responsiveFieldController(config: {\n  field: ResponsiveFieldDefinition;\n  formValues: Form[\"values\"];\n  onChange: (newValues: Array<any>) => void;\n  editorContext: EditorContextType;\n  valuesAfterAuto: Record<string, any>;\n}): ResponsiveFieldController {\n  const { field, formValues, onChange, editorContext, valuesAfterAuto } =\n    config;\n\n  function originalFormat(value: unknown, fieldName: string) {\n    return field.format?.(value, fieldName, field) ?? value;\n  }\n\n  function originalParse(value: unknown, fieldName: string) {\n    return field.parse?.(value, fieldName, field) ?? value;\n  }\n\n  const normalizedFieldName = toArray(field.name);\n\n  const fieldValues = normalizedFieldName.map((fieldName) =>\n    dotNotationGet(formValues, fieldName)\n  );\n\n  const isResponsive = fieldValues.every((fieldValue) =>\n    isTrulyResponsiveValue(fieldValue)\n  );\n\n  const isSet =\n    isResponsive &&\n    fieldValues.every(\n      (fieldValue) => fieldValue[editorContext.breakpointIndex] !== undefined\n    );\n\n  const format = (value: any, name: string) => {\n    const valueAfterFormat = originalFormat(value, name);\n    const displayedValue =\n      (isTrulyResponsiveValue(valueAfterFormat)\n        ? valueAfterFormat[editorContext.breakpointIndex]\n        : valueAfterFormat) ?? null;\n    return displayedValue;\n  };\n\n  const parse = (value: any, name: string) => {\n    if (value === null) {\n      throw new Error(\n        \"parse in ResponsiveController has null value which should be impossible (null values should disappear once other value is picked!\"\n      );\n    }\n\n    const fieldValue = originalFormat(dotNotationGet(formValues, name), name);\n    const savedValue = getSavedValue(value, fieldValue, editorContext);\n\n    return originalParse(savedValue, name);\n  };\n\n  const reset = () => {\n    if (!isResponsive) {\n      throw new Error(\"should never happen\");\n    }\n\n    const nextValues = normalizedFieldName.map((fieldName) => {\n      const previousValue = originalFormat(\n        dotNotationGet(formValues, fieldName),\n        fieldName\n      );\n\n      const newValue = {\n        ...previousValue,\n      };\n\n      delete newValue[editorContext.breakpointIndex];\n\n      if (Object.keys(newValue).length <= 1) {\n        return field.defaultValue;\n      }\n\n      return originalParse(newValue, fieldName);\n    });\n\n    onChange(nextValues);\n  };\n\n  const toggleOffAuto = () => {\n    const currentBreakpointValues = fieldValues.map(\n      (fieldValue) => fieldValue[editorContext.breakpointIndex]\n    );\n\n    let areAllFieldValuesAuto = true;\n    let isAnyFieldValueAuto = false;\n\n    currentBreakpointValues.forEach((value) => {\n      if (value === undefined) {\n        if (!isAnyFieldValueAuto) {\n          isAnyFieldValueAuto = true;\n        }\n      } else {\n        if (areAllFieldValuesAuto) {\n          areAllFieldValuesAuto = false;\n        }\n      }\n    });\n\n    const newFieldsValues = normalizedFieldName.map((fieldName) => {\n      const fieldValue = dotNotationGet(formValues, fieldName);\n      const nextFieldValue = areAllFieldValuesAuto\n        ? dotNotationGet(valuesAfterAuto, normalizedFieldName[0])\n        : isAnyFieldValueAuto\n          ? fieldValues.find(\n            (value) => value[editorContext.breakpointIndex] !== undefined\n          )\n          : fieldValue;\n\n      const newFieldValue = {\n        ...fieldValue,\n        [editorContext.breakpointIndex]: responsiveValueForceGet(\n          // next field comes from auto, so value is defined\n          nextFieldValue,\n          editorContext.breakpointIndex\n        ),\n      };\n\n      return newFieldValue;\n    });\n\n    onChange(newFieldsValues);\n  };\n\n  const valueField: InternalField = {\n    ...field,\n    component: field.subComponent,\n    format,\n    parse,\n  };\n\n  return {\n    field: valueField,\n    isResponsive,\n    isSet,\n    reset,\n    toggleOffAuto,\n  };\n}\n","import { responsiveValueForceGet } from \"@redsun-vn/easyblocks-core\";\nimport { Colors, Fonts, Icons } from \"@redsun-vn/easyblocks-design-system\";\nimport { dotNotationGet, toArray } from \"@/utils\";\nimport React from \"react\";\nimport { styled } from \"styled-components\";\nimport { useConfigAfterAuto } from \"../../../../ConfigAfterAutoContext\";\nimport { useEditorContext } from \"../../../../EditorContext\";\nimport { FieldBuilder } from \"../../../form-builder\";\nimport { MIXED_VALUE } from \"../../components/constants\";\nimport { getUniqueValues } from \"../../components/getUniqueValues\";\nimport { Tooltip, TooltipArrow, TooltipBody } from \"../Tooltip\";\nimport { useTooltip } from \"../useTooltip\";\nimport { FieldMetaWrapper } from \"../wrapFieldWithMeta\";\nimport {\n  ResponsiveFieldDefinition,\n  responsiveFieldController,\n} from \"./responsiveFieldController\";\n\ntype ResponsivePluginProps = {\n  input: {\n    value: any;\n    onChange: (...values: Array<any>) => void;\n  };\n  field: ResponsiveFieldDefinition;\n  tinaForm: any;\n  form: any;\n  meta: any;\n};\n\nconst ResponsiveField = (props: ResponsivePluginProps) => {\n  const { tinaForm, field, input } = props;\n\n  const editorContext = useEditorContext();\n  const configAfterAuto = useConfigAfterAuto();\n  const normalizedFieldName = toArray(field.name);\n\n  const fieldValues = normalizedFieldName.map((fieldName) =>\n    dotNotationGet(configAfterAuto, fieldName)\n  );\n\n  const scalarFieldValues = fieldValues.map((fieldValue) => {\n    return responsiveValueForceGet(\n      // value from auto, so it's safe\n      fieldValue,\n      editorContext.breakpointIndex\n    );\n  });\n\n  const uniqueValues = getUniqueValues(scalarFieldValues, (value) =>\n    typeof value === \"object\" ? JSON.stringify(value) : value\n  );\n\n  const isMixedValue = uniqueValues.length > 1;\n  const value = isMixedValue ? MIXED_VALUE : uniqueValues[0];\n  const controller = responsiveFieldController({\n    field,\n    onChange: (newValues) => {\n      input.onChange(...newValues);\n    },\n    formValues: tinaForm.values,\n    editorContext,\n    valuesAfterAuto: configAfterAuto,\n  });\n\n  const isValueDifferentFromMainBreakpoint =\n    controller.isSet &&\n    editorContext.breakpointIndex !== editorContext.mainBreakpointIndex;\n\n  const isFieldVisible =\n    !controller.isResponsive ||\n    controller.isSet ||\n    editorContext.breakpointIndex === editorContext.mainBreakpointIndex;\n\n  const uniqueFieldValues = getUniqueValues(scalarFieldValues);\n\n  const autoLabelChildren =\n    uniqueFieldValues.length > 1 && uniqueFieldValues.includes(undefined)\n      ? \"Mixed\"\n      : getAutoLabelButtonLabel(value);\n\n  const isExternalField = field.subComponent === \"external\";\n\n  const { isOpen, arrowProps, tooltipProps, triggerProps } = useTooltip({\n    isDisabled: !isValueDifferentFromMainBreakpoint,\n    onClick: () => {\n      controller.reset();\n    },\n  });\n\n  return (\n    <FieldMetaWrapper\n      {...props}\n      layout={isExternalField ? \"column\" : \"row\"}\n      renderLabel={\n        isValueDifferentFromMainBreakpoint\n          ? ({ label }) => (\n              <ResetButton aria-label=\"Revert to auto\" {...triggerProps}>\n                <Icons.Reset />\n                <ResetButtonLabel>{label}</ResetButtonLabel>\n                {isOpen && (\n                  <Tooltip {...tooltipProps}>\n                    <TooltipArrow {...arrowProps} />\n                    <TooltipBody>Revert to auto</TooltipBody>\n                  </Tooltip>\n                )}\n              </ResetButton>\n            )\n          : undefined\n      }\n    >\n      <div style={{ width: \"100%\" }}>\n        {isFieldVisible ? (\n          <FieldBuilder\n            form={tinaForm}\n            field={controller.field}\n            noWrap={true}\n          />\n        ) : (\n          <AutoLabel\n            align={isExternalField ? \"left\" : \"right\"}\n            onClick={() => {\n              controller.toggleOffAuto();\n            }}\n          >\n            {autoLabelChildren}\n          </AutoLabel>\n        )}\n      </div>\n    </FieldMetaWrapper>\n  );\n};\n\nexport const ResponsiveFieldPlugin = {\n  name: \"responsive2\" as const,\n  Component: ResponsiveField,\n};\n\nconst AutoLabel = styled.div<{ align: \"left\" | \"right\" }>`\n  ${Fonts.body};\n  color: ${Colors.black40};\n  text-align: ${(props) => props.align};\n\n  &:hover {\n    color: black;\n    cursor: pointer;\n    text-decoration: underline;\n  }\n`;\n\nconst ResetButton = styled.button`\n  display: flex;\n  align-items: center;\n  gap: 4px;\n\n  background-color: transparent;\n  border: 0;\n  padding: 0;\n\n  color: ${Colors.purple};\n\n  cursor: pointer;\n`;\n\nconst ResetButtonLabel = styled.span`\n  ${Fonts.body};\n  line-height: 16px;\n`;\n\nfunction getAutoLabelButtonLabel(value: any): string {\n  if (value === MIXED_VALUE) {\n    return \"auto: Mixed\";\n  }\n\n  /**\n   * This piece of code is crap\n   */\n  if (typeof value === \"object\") {\n    if (value.tokenId !== undefined && value.value !== undefined) {\n      const refNameParts = value.tokenId.split(\".\");\n      return `auto: ${refNameParts[refNameParts.length - 1]}`;\n    } else if (value.value !== undefined && value.id === undefined) {\n      // just value field -> token\n      return `auto: ${\n        typeof value.value === \"number\"\n          ? Math.round(value.value * 100) / 100\n          : value.value\n      }`;\n    }\n    return \"auto\";\n  }\n\n  if (typeof value === \"boolean\") {\n    return `auto: ${JSON.stringify(value)}`;\n  }\n\n  return `auto: ${value}`;\n}\n","import React, { useEffect, useRef } from \"react\";\nimport { wrapFieldsWithMeta } from \"../wrapFieldWithMeta\";\n\ntype SVGPickerProps = {\n  min: number;\n  max: number;\n  step?: number;\n};\n\nfunction transformStrokeAndFill(node: Element) {\n  const fill = node.getAttribute(\"fill\");\n  const stroke = node.getAttribute(\"stroke\");\n\n  if (fill && fill !== \"none\") {\n    node.setAttribute(\"fill\", \"currentColor\");\n  }\n  if (stroke && stroke !== \"none\") {\n    node.setAttribute(\"stroke\", \"currentColor\");\n  }\n\n  Array.from(node.children).forEach((child) => transformStrokeAndFill(child));\n}\n\nconst SVGPicker = wrapFieldsWithMeta<any, SVGPickerProps>(\n  ({ input, meta, field }) => {\n    const svgString = input.value.value;\n    const inputRef = useRef<HTMLInputElement>(null);\n\n    useEffect(() => {\n      function readFileAsString() {\n        // @ts-ignore\n        const files = this.files;\n        if (files.length === 0) {\n          return;\n        }\n\n        const reader = new FileReader();\n        reader.onload = function (event) {\n          // @ts-ignore to explore\n          const trimmed = event.target?.result.trim();\n\n          const emptyDiv = document.createElement(\"div\");\n          emptyDiv.innerHTML = trimmed;\n          const svg = emptyDiv.children[0];\n\n          svg.removeAttribute(\"width\");\n          svg.removeAttribute(\"height\");\n\n          svg.setAttribute(\n            \"style\",\n            \"position: absolute; width: 100%;height: 100%;\"\n          );\n\n          transformStrokeAndFill(svg);\n\n          if (svg.tagName.toLowerCase() !== \"svg\") {\n            alert(\"incorrect file\");\n            return;\n          }\n\n          input.onChange({\n            value: emptyDiv.innerHTML,\n          });\n        };\n        reader.readAsText(files[0]);\n      }\n\n      inputRef.current!.addEventListener(\"change\", readFileAsString);\n\n      return () => {\n        inputRef.current!.removeEventListener(\"change\", readFileAsString);\n      };\n    }, []);\n\n    return (\n      <div>\n        <div\n          style={{\n            width: 24,\n            height: 24,\n            position: \"relative\",\n            color: \"black\",\n            marginBottom: 16,\n          }}\n        >\n          <div dangerouslySetInnerHTML={{ __html: svgString }} />\n        </div>\n\n        <input type=\"file\" id=\"upload\" accept={\".svg\"} ref={inputRef} />\n      </div>\n    );\n  }\n);\n\nexport const SVGPickerFieldPlugin = {\n  __type: \"field\",\n  name: \"icon\",\n  Component: SVGPicker,\n};\n","import { RangeSlider } from \"@redsun-vn/easyblocks-design-system\";\nimport React from \"react\";\nimport { wrapFieldsWithMeta } from \"./wrapFieldWithMeta\";\n\ntype SliderProps = {\n  min: number;\n  max: number;\n  step?: number;\n};\n\nconst Slider = wrapFieldsWithMeta<any, SliderProps>(({ input, field }) => {\n  return (\n    <RangeSlider {...input} max={field.max} min={field.min} step={field.step} />\n  );\n});\n\nexport const SliderFieldPlugin = {\n  __type: \"field\",\n  name: \"slider\",\n  Component: Slider,\n};\n","import { LocalValue } from \"@redsun-vn/easyblocks-core\";\nimport { InternalField } from \"@redsun-vn/easyblocks-core/_internals\";\nimport React from \"react\";\nimport { FieldRenderProps } from \"react-final-form\";\nimport { EditorContextType, useEditorContext } from \"../../../EditorContext\";\nimport { MissingWidget } from \"./MissingWidget\";\nimport { wrapFieldsWithMeta } from \"./wrapFieldWithMeta\";\n\ntype InlineTypesResult = Record<\n  string,\n  Extract<EditorContextType[\"types\"][string], { type: \"inline\" }>\n>;\n\nfunction useInlineTypes(): InlineTypesResult {\n  const editorContext = useEditorContext();\n\n  const tokenTypes = Object.fromEntries(\n    Object.entries(editorContext.types).filter<\n      [string, InlineTypesResult[string]]\n    >(\n      (\n        typeDefinitionEntry\n      ): typeDefinitionEntry is [string, InlineTypesResult[string]] => {\n        return typeDefinitionEntry[1].type === \"inline\";\n      }\n    )\n  );\n\n  return tokenTypes;\n}\n\nconst LocalFieldPlugin = {\n  name: \"local\",\n  Component: wrapFieldsWithMeta(function LocalField({\n    field,\n    input,\n  }: FieldRenderProps<LocalValue<any>> & {\n    field: InternalField;\n  }) {\n    const inlineTypes = useInlineTypes();\n    const inlineTypeDefinition = inlineTypes[field.schemaProp.type];\n    const WidgetComponent = inlineTypeDefinition?.widget.component;\n\n    if (!WidgetComponent) {\n      return <MissingWidget type={field.schemaProp.type} />;\n    }\n\n    return (\n      <WidgetComponent\n        value={input.value.value}\n        onChange={(value) => {\n          input.onChange({\n            value,\n            widgetId: input.value.widgetId,\n          });\n        }}\n        params={\n          \"params\" in field.schemaProp ? field.schemaProp.params : undefined\n        }\n      />\n    );\n  }),\n};\n\nexport { LocalFieldPlugin };\n","import {\n  Position,\n  PositionHorizontal,\n  PositionVertical,\n} from \"@redsun-vn/easyblocks-core\";\nimport { Colors } from \"@redsun-vn/easyblocks-design-system\";\nimport * as RadixRadioGroup from \"@radix-ui/react-radio-group\";\nimport React from \"react\";\nimport { styled } from \"styled-components\";\n\nconst StyledRadioItem = styled(RadixRadioGroup.Item)<{\n  horizontal: PositionHorizontal;\n  vertical: PositionVertical;\n  position: Position;\n  p: { value: Position };\n}>`\n  all: unset;\n  position: relative;\n  display: flex;\n  justify-content: ${(props) =>\n    horizontalPositionToFlexJustifyContentValue(props.horizontal)};\n  align-items: ${(props) =>\n    verticalPositionToFlexAlignItemsValue(props.vertical)};\n  box-sizing: border-box;\n  width: 20px;\n  height: 20px;\n  padding: 8px;\n\n  &:hover > div {\n    opacity: ${(props) => (props.p.value === props.position ? 1 : 0.5)};\n  }\n`;\n\nconst positions: ReadonlyArray<{ label: string; value: Position }> = [\n  { label: \"Top Left\", value: \"top-left\" },\n  { label: \"Top Center\", value: \"top-center\" },\n  { label: \"Top Right\", value: \"top-right\" },\n  { label: \"Center Left\", value: \"center-left\" },\n  { label: \"Center Center\", value: \"center-center\" },\n  { label: \"Center Right\", value: \"center-right\" },\n  { label: \"Bottom Left\", value: \"bottom-left\" },\n  { label: \"Bottom Center\", value: \"bottom-center\" },\n  { label: \"Bottom Right\", value: \"bottom-right\" },\n];\n\nfunction horizontalPositionToFlexJustifyContentValue(\n  position: \"left\" | \"center\" | \"right\"\n) {\n  switch (position) {\n    case \"left\":\n      return \"flex-start\";\n    case \"center\":\n      return \"center\";\n    case \"right\":\n      return \"flex-end\";\n  }\n}\n\nfunction verticalPositionToFlexAlignItemsValue(\n  position: \"top\" | \"center\" | \"bottom\"\n) {\n  switch (position) {\n    case \"top\":\n      return \"flex-start\";\n    case \"center\":\n      return \"center\";\n    case \"bottom\":\n      return \"flex-end\";\n  }\n}\nfunction PositionPickerInput({\n  position,\n  onPositionChange,\n}: {\n  position: Position;\n  onPositionChange: (position: Position) => void;\n}) {\n  return (\n    <RadixRadioGroup.Root\n      value={position}\n      onValueChange={(newPosition) => {\n        onPositionChange(newPosition as Position);\n      }}\n      style={{\n        display: \"grid\",\n        gridTemplateRows: \"repeat(3, 1fr)\",\n        gridTemplateColumns: \"repeat(3, 1fr)\",\n        gap: \"0\",\n        borderRadius: \"2px\",\n        border: `1px solid ${Colors.black10}`,\n      }}\n    >\n      {positions.map((p) => {\n        const [vertical, horizontal] = p.value.split(\"-\") as [\n          PositionVertical,\n          PositionHorizontal\n        ];\n\n        return (\n          <StyledRadioItem\n            value={p.value}\n            key={p.value}\n            aria-label={p.label}\n            horizontal={horizontal}\n            vertical={vertical}\n            p={p}\n            position={position}\n          >\n            <div\n              style={{\n                width: \"2px\",\n                height: \"2px\",\n                backgroundColor: \"#d9d9d9\",\n              }}\n            ></div>\n            <div\n              style={{\n                position: \"absolute\",\n                top: \"2px\",\n                left: \"2px\",\n                display: \"flex\",\n                flexDirection: \"column\",\n                justifyContent: \"center\",\n                alignItems:\n                  horizontalPositionToFlexJustifyContentValue(horizontal),\n                gap: \"2px\",\n                width: \"16px\",\n                height: \"16px\",\n                opacity: p.value === position ? 1 : 0,\n              }}\n            >\n              <PositionIndicator\n                $size={vertical === \"top\" ? \"full\" : \"normal\"}\n              />\n              <PositionIndicator\n                $size={vertical === \"center\" ? \"full\" : \"normal\"}\n              />\n              <PositionIndicator\n                $size={vertical === \"bottom\" ? \"full\" : \"normal\"}\n              />\n            </div>\n          </StyledRadioItem>\n        );\n      })}\n    </RadixRadioGroup.Root>\n  );\n}\n\nexport { PositionPickerInput };\nexport type { Position };\n\nconst PositionIndicator = styled.div<{ $size?: \"normal\" | \"full\" }>`\n  width: ${(p) => (p.$size === \"full\" ? \"100%\" : \"75%\")};\n  height: 4px;\n  background-color: #202123;\n`;\n","import { InternalField } from \"@redsun-vn/easyblocks-core/_internals\";\nimport React from \"react\";\nimport { FieldRenderProps } from \"react-final-form\";\nimport {\n  Position,\n  PositionPickerInput,\n} from \"../../../sidebar/PositionPickerInput\";\nimport { wrapFieldsWithMeta } from \"./wrapFieldWithMeta\";\n\nfunction PositionField(\n  props: FieldRenderProps<Position, HTMLInputElement> & { field: InternalField }\n) {\n  return (\n    <PositionPickerInput\n      position={props.input.value}\n      onPositionChange={(position) => {\n        props.input.onChange(position);\n      }}\n    />\n  );\n}\n\nexport const PositionFieldPlugin = {\n  name: \"position\",\n  Component: wrapFieldsWithMeta(PositionField),\n};\n","import {\n  getDevicesWidths,\n  getFallbackLocaleForLocale,\n  isTrulyResponsiveValue,\n  responsiveValueGetDefinedValue,\n} from \"@redsun-vn/easyblocks-core\";\nimport {\n  CompilationCache,\n  InternalAnyTinaField,\n  InternalField,\n  duplicateConfig,\n  findComponentDefinitionById,\n  findPathOfFirstAncestorOfType,\n  getSchemaDefinition,\n  parsePath,\n  richTextChangedEvent,\n  traverseComponents,\n} from \"@redsun-vn/easyblocks-core/_internals\";\nimport { dotNotationGet, last, toArray } from \"@/utils\";\nimport { EditorContextType } from \"../../../EditorContext\";\nimport { getUniqueValues } from \"../../fields/components/getUniqueValues\";\nimport { isConfigPathRichTextPart } from \"../../../utils/isConfigPathRichTextPart\";\n\n// \"any\" here is on purpose (although doesn't make sense from TS perspective).\n// It suggests that in onChange you can pass event OR any value. It's a bit confusing and should be cleaned up in the future.\ntype FieldValue = React.ChangeEvent<HTMLSelectElement | HTMLInputElement> | any;\n\nfunction createFieldController({\n  field,\n  editorContext,\n  format = (v) => v,\n  parse = (v) => v,\n}: {\n  field: InternalField;\n  editorContext: EditorContextType;\n  format?:\n  | ((value: any, name: string, field: InternalAnyTinaField) => any)\n  | undefined;\n  parse?: (value: any, name: string, field: InternalAnyTinaField) => any;\n}) {\n  const { actions, contextParams, form, locales, focussedField } =\n    editorContext;\n  const normalizedFieldName = toArray(field.name);\n\n  return {\n    onChange(mainNewValue: FieldValue, ...extraNewValues: FieldValue[]) {\n      /**\n       * There are 2 modes of onChange: single param and multiple params\n       *\n       * 1. single param mode is when onChange is given ONE value (1 parameter). It means: \"apply this value for all selected fields\"\n       * 2. multiple param mode is when onChange is given more than one value. It means: \"apply each value for respective selected field\".\n       */\n\n      const newValue: FieldValue | FieldValue[] =\n        extraNewValues.length === 0\n          ? mainNewValue\n          : [mainNewValue, ...extraNewValues];\n\n      if (\n        !Array.isArray(mainNewValue) &&\n        Array.isArray(newValue) &&\n        newValue.length !== normalizedFieldName.length\n      ) {\n        throw new Error(\n          \"onChange in multiple param mode was given wrong number of values\"\n        );\n      }\n\n      if (focussedField.some(isConfigPathRichTextPart)) {\n        // For editor selection we can safely pick a first field name because:\n        // * we only can select fields that are children of @easyblocks/rich-text-part\n        // * we only can update only single property\n        const { templateId } = parsePath(normalizedFieldName[0], form);\n\n        invalidateCache(normalizedFieldName[0], editorContext);\n\n        if (templateId === \"@easyblocks/rich-text-part\") {\n          const schemaPropNameToUpdate = last(\n            normalizedFieldName[0].split(\".\")\n          );\n\n          const canvasIframe = document.getElementById(\n            \"shopstory-canvas\"\n          ) as HTMLIFrameElement | null;\n\n          if (canvasIframe === null || canvasIframe.contentWindow === null) {\n            throw new Error(\"No Shopstory canvas\");\n          }\n\n          if (extraNewValues.length > 0) {\n            const parsedValues = (newValue as Array<any>).map((value) =>\n              parse(getValue(value), normalizedFieldName[0], field)\n            );\n\n            canvasIframe.contentWindow.postMessage(\n              richTextChangedEvent({\n                prop: schemaPropNameToUpdate as any,\n                schemaProp: field.schemaProp,\n                values: parsedValues,\n              }),\n              \"*\"\n            );\n          } else {\n            const parsedValue = parse(\n              getValue(newValue),\n              normalizedFieldName[0],\n              field\n            );\n\n            canvasIframe.contentWindow.postMessage(\n              richTextChangedEvent({\n                prop: schemaPropNameToUpdate as any,\n                schemaProp: field.schemaProp,\n                values: [parsedValue],\n              }),\n              \"*\"\n            );\n          }\n\n          return;\n        }\n      }\n\n      actions.runChange(() => {\n        normalizedFieldName.forEach((path, fieldIndex) => {\n          const inputValue = Array.isArray(newValue)\n            ? getValue(newValue[fieldIndex])\n            : getValue(newValue);\n\n          const customTypeDefinition =\n            editorContext.types[field.schemaProp.type];\n\n          if (\n            customTypeDefinition &&\n            \"validate\" in customTypeDefinition &&\n            customTypeDefinition.validate &&\n            \"value\" in inputValue &&\n            (customTypeDefinition.type === \"token\"\n              ? !(\"tokenId\" in inputValue)\n              : true)\n          ) {\n            const isInputValueValid = customTypeDefinition.validate(\n              inputValue.value\n            );\n\n            if (!isInputValueValid) {\n              return;\n            }\n          }\n\n          let parsedValue = parse(inputValue, path, field);\n\n          // If path has locale token [locale] (component-collection-localised) then we must first replace it with correct token\n          if (hasLocaleToken(path)) {\n            const currentLocaleFieldName = replaceLocaleToken(\n              path,\n              contextParams.locale\n            );\n\n            const currentLocaleValue = dotNotationGet(\n              form.values,\n              currentLocaleFieldName\n            );\n\n            parsedValue = parse(inputValue, currentLocaleFieldName, field);\n\n            // If the path doesn't exist it means that there is no config for path for current locale. It means we must create it!\n            if (currentLocaleValue === undefined) {\n              const fallbackLocale = getFallbackLocaleForLocale(\n                contextParams.locale,\n                locales\n              )!;\n\n              const fieldNameSegments = path.split(\".\");\n              const localeTokenIndex = fieldNameSegments.indexOf(\"[locale]\");\n              const localisedConfigPath = [\n                ...fieldNameSegments.slice(0, localeTokenIndex + 1),\n                \"0\",\n              ].join(\".\");\n\n              const fallbackLocaleFieldName = replaceLocaleToken(\n                localisedConfigPath,\n                fallbackLocale\n              );\n\n              const localeConfigPath = replaceLocaleToken(\n                localisedConfigPath,\n                contextParams.locale\n              );\n\n              form.change(\n                localeConfigPath,\n                duplicateConfig(\n                  dotNotationGet(form.values, fallbackLocaleFieldName),\n                  editorContext\n                )\n              );\n            }\n\n            path = currentLocaleFieldName;\n          }\n\n          invalidateCache(path, editorContext);\n\n          // At this point we have correct fieldName and correct parsedValue after all [locale] issues solved\n\n          /**\n           * Below we're trying to see whether there is a custom change function for specific EditableComponent\n           */\n\n          const split = path.split(\".\");\n          const propName = last(split);\n\n          // TODO: here we can have either a component or component field. parsePath should take this into account!\n          const componentPath = split.slice(0, split.length - 1).join(\".\");\n          const { templateId } = parsePath(componentPath, editorContext.form);\n\n          const parentDefinition = findComponentDefinitionById(\n            templateId,\n            editorContext\n          )!;\n          const config = dotNotationGet(\n            editorContext.form.values,\n            componentPath\n          );\n\n          if (parentDefinition && parentDefinition.change) {\n            const values: Record<string, any> = {};\n            const closestDefinedValues: Record<string, any> = {};\n\n            parentDefinition.schema.forEach((schemaProp) => {\n              const val = config[schemaProp.prop];\n\n              values[schemaProp.prop] = isTrulyResponsiveValue(val)\n                ? val[editorContext.breakpointIndex]\n                : val;\n\n              closestDefinedValues[schemaProp.prop] =\n                responsiveValueGetDefinedValue(\n                  val,\n                  editorContext.breakpointIndex,\n                  editorContext.devices,\n                  getDevicesWidths(editorContext.devices)\n                );\n            });\n\n            const inputValue = isTrulyResponsiveValue(parsedValue)\n              ? parsedValue[editorContext.breakpointIndex]\n              : parsedValue;\n\n            const result = parentDefinition.change({\n              newValue: inputValue,\n              prop: propName,\n              values,\n\n              /**\n               * IMPORTANT!!!\n               *\n               * valuesAfterAuto are an approximation for now, they're not real auto values, they just have closest defined values.\n               *\n               */\n              valuesAfterAuto: closestDefinedValues,\n            }) ?? {\n              [propName]: inputValue,\n            };\n\n            parentDefinition.schema.forEach((schemaProp) => {\n              if (!result.hasOwnProperty(schemaProp.prop)) {\n                return;\n              }\n\n              let pathPrefix = `${componentPath}.${schemaProp.prop}`;\n              if (pathPrefix[0] === \".\") {\n                pathPrefix = pathPrefix.substring(1);\n              }\n\n              if (isTrulyResponsiveValue(config[schemaProp.prop])) {\n                form.change(\n                  `${pathPrefix}.${editorContext.breakpointIndex}`,\n                  result[schemaProp.prop]\n                );\n              } else {\n                form.change(`${pathPrefix}`, result[schemaProp.prop]);\n              }\n            });\n          } else {\n            form.change(path, parsedValue);\n          }\n        });\n      });\n    },\n    getValue() {\n      const fieldValues = normalizedFieldName.map((fieldName) => {\n        const propName = last(fieldName.split(\".\"));\n\n        if (propName.startsWith(\"$\") && \"defaultValue\" in field.schemaProp) {\n          return field.schemaProp.defaultValue;\n        }\n\n        if (hasLocaleToken(fieldName)) {\n          const resolvedFieldName = replaceLocaleToken(\n            fieldName,\n            editorContext.contextParams.locale\n          );\n\n          const fieldValue = dotNotationGet(form.values, resolvedFieldName);\n\n          if (fieldValue) {\n            return fieldValue;\n          }\n\n          const fallbackLocale = getFallbackLocaleForLocale(\n            editorContext.contextParams.locale,\n            editorContext.locales\n          )!;\n\n          const resolvedFieldFallbackName = replaceLocaleToken(\n            fieldName,\n            fallbackLocale\n          );\n\n          const fieldFallbackValue = dotNotationGet(\n            form.values,\n            resolvedFieldFallbackName\n          );\n\n          return fieldFallbackValue;\n        }\n\n        return dotNotationGet(form.values, fieldName);\n      });\n\n      const uniqueFieldValues = getUniqueValues(fieldValues, (fieldValue) => {\n        const { getHash } = getSchemaDefinition(\n          field.schemaProp,\n          editorContext\n        );\n\n        return getHash(\n          fieldValue,\n          editorContext.breakpointIndex,\n          editorContext.devices\n        );\n      });\n\n      if (uniqueFieldValues.length > 1) {\n        return { __mixed__: true };\n      }\n\n      return format(uniqueFieldValues[0], normalizedFieldName[0], field);\n    },\n  };\n}\n\nexport { createFieldController };\n\nfunction hasLocaleToken(configPath: string) {\n  return configPath.includes(\"[locale]\");\n}\n\nfunction replaceLocaleToken(configPath: string, locale: string) {\n  const localisedFieldName = configPath.replace(\"[locale]\", locale);\n  return localisedFieldName;\n}\n\nfunction getValue(\n  eventOrValue: React.ChangeEvent<HTMLSelectElement | HTMLInputElement> | any\n) {\n  // Event of course has more properties or methods, but for this case\n  // checking only for `currentTarget` is sufficient\n  const isEventObject =\n    typeof eventOrValue === \"object\" &&\n    eventOrValue !== null &&\n    \"currentTarget\" in eventOrValue;\n\n  if (isEventObject) {\n    if (\n      \"checked\" in eventOrValue.currentTarget &&\n      eventOrValue.currentTarget.type === \"checkbox\"\n    ) {\n      return eventOrValue.currentTarget.checked;\n    }\n\n    return eventOrValue.currentTarget.value;\n  } else {\n    return eventOrValue;\n  }\n}\n\ntype CacheInvalidator = (\n  cache: CompilationCache,\n  changedPath: string,\n  context: EditorContextType\n) => Array<string>;\n\n// $richText and @easyblocks/rich-text-part uses a lot of portals to display correct fields within sidebar\n// Changing value through portal won't trigger the recompilation of component using that portal.\n// When we change any $richText related component we remove cache for that component (if it is $richText)\n// and for all of its ancestors.\nconst richTextCacheInvalidator: CacheInvalidator = (\n  cache,\n  changedPath,\n  context\n) => {\n  const cacheKeysToRemove: Array<string> = [];\n  const { templateId, fieldName, parent } = parsePath(\n    changedPath,\n    context.form\n  );\n\n  const isRichTextOrRichTextAncestorComponent =\n    templateId.startsWith(\"@easyblocks/rich-text\") ||\n    parent?.templateId.startsWith(\"@easyblocks/rich-text\");\n\n  if (isRichTextOrRichTextAncestorComponent) {\n    const richTextPath =\n      templateId === \"@easyblocks/rich-text\" && fieldName\n        ? changedPath.replace(`.${fieldName}`, \"\")\n        : findPathOfFirstAncestorOfType(\n          changedPath,\n          \"@easyblocks/rich-text\",\n          context.form\n        );\n\n    const richTextConfig = dotNotationGet(context.form.values, richTextPath);\n\n    traverseComponents(richTextConfig, context, ({ componentConfig }) => {\n      if (\n        componentConfig &&\n        componentConfig._component.startsWith(\"@easyblocks/rich-text\")\n      ) {\n        cacheKeysToRemove.push(componentConfig._id!);\n      }\n    });\n  }\n\n  return cacheKeysToRemove;\n};\n\nconst cacheInvalidators: Array<CacheInvalidator> = [richTextCacheInvalidator];\n\nfunction invalidateCache(changedPath: string, context: EditorContextType) {\n  const cacheKeysToRemove = new Set(\n    cacheInvalidators.flatMap((invalidator) => {\n      return invalidator(context.compilationCache, changedPath, context);\n    })\n  );\n\n  cacheKeysToRemove.forEach((cacheKey) => {\n    context.compilationCache.remove(cacheKey);\n  });\n}\n","import { toArray } from \"@/utils\";\nimport { InternalField } from \"@redsun-vn/easyblocks-core/_internals\";\nimport { Colors, Fonts, Typography } from \"@redsun-vn/easyblocks-design-system\";\nimport React, { useContext, useMemo } from \"react\";\nimport { styled } from \"styled-components\";\nimport { useEditorContext } from \"../../EditorContext\";\nimport { Form } from \"../../form\";\nimport {\n  BlockFieldPlugin,\n  ExternalFieldPlugin,\n  FieldMetaWrapper,\n  IdentityFieldPlugin,\n  NumberFieldPlugin,\n  RadioGroupFieldPlugin,\n  ResponsiveFieldPlugin,\n  SVGPickerFieldPlugin,\n  SelectFieldPlugin,\n  SliderFieldPlugin,\n  TextFieldPlugin,\n  ToggleFieldPlugin,\n  TokenFieldPlugin,\n} from \"../fields\";\nimport { PanelContext } from \"../fields/plugins/BlockFieldPlugin\";\nimport { LocalFieldPlugin } from \"../fields/plugins/LocalFIeld\";\nimport { PositionFieldPlugin } from \"../fields/plugins/PositionFieldPlugin\";\nimport { FieldPlugin } from \"./field-plugin\";\nimport { createFieldController } from \"./utils/createFieldController\";\n\nexport interface FieldBuilderProps {\n  form: Form;\n  field: InternalField;\n  noWrap?: boolean;\n  isLabelHidden?: boolean;\n}\n\nfunction shouldFieldBeDisplayed(field: InternalField): boolean {\n  if (field.component === null) return false;\n\n  if (Array.isArray(field.name)) {\n    return true;\n  }\n\n  if (field.hidden) {\n    return false;\n  }\n\n  return true;\n}\n\nconst FIELD_COMPONENTS: Array<FieldPlugin> = [\n  TextFieldPlugin,\n  NumberFieldPlugin,\n  ToggleFieldPlugin,\n  SelectFieldPlugin,\n  RadioGroupFieldPlugin,\n  PositionFieldPlugin,\n  BlockFieldPlugin,\n  SliderFieldPlugin,\n  SVGPickerFieldPlugin,\n  ResponsiveFieldPlugin,\n  ExternalFieldPlugin,\n  TokenFieldPlugin,\n  IdentityFieldPlugin,\n  LocalFieldPlugin,\n];\n\nexport function FieldBuilder({\n  form,\n  field,\n  noWrap,\n  isLabelHidden,\n}: FieldBuilderProps) {\n  const editorContext = useEditorContext();\n\n  if (!shouldFieldBeDisplayed(field)) {\n    return null;\n  }\n\n  const fieldComponent = FIELD_COMPONENTS.find(\n    (component) => component.name === (field.component as string)\n  );\n\n  const { onChange, getValue } = createFieldController({\n    field,\n    editorContext,\n    format: field.format ?? fieldComponent?.format,\n    parse: field.parse ?? fieldComponent?.parse,\n  });\n\n  const fieldParsed = useMemo(() => {\n    let fieldResult = field;\n\n    if (typeof field.label === \"object\") {\n      field.label =\n        field.label?.[editorContext.contextParams.locale] ?? field.label;\n    }\n\n    return fieldResult;\n  }, [field]);\n\n  if (fieldComponent) {\n    return (\n      <fieldComponent.Component\n        // Let's talk about this code\n        // This branch of code is created to display single input and label that handles multiple inputs under the hood\n        // To make this work, we had to skip usage of `Field` from `Final Form` because it requires a single field object with single name\n        // Moreover, since we don't use `Field` anymore we have to pretend that it still exists to make fields works as it was there.\n        // In the future, this code should become a part of new component (ex. FieldWrapper)\n        // and new controller should be introduced (ex. fieldWrapperController) to have single source of truth about behaviour of responsive field.\n        input={{\n          value: getValue(),\n          onChange,\n        }}\n        // MetaFieldWrapper accesses `error` property of this object, it's needed to prevent runtime error\n        meta={{}}\n        tinaForm={form}\n        form={form.finalForm}\n        field={fieldParsed}\n        noWrap={noWrap}\n        isLabelHidden={isLabelHidden}\n      />\n    );\n  }\n\n  if (typeof field.component !== \"string\" && field.component !== null) {\n    console.log(\"not a string\");\n\n    return (\n      <field.component\n        input={{\n          value: getValue(),\n          onChange,\n        }}\n        meta={{}}\n        tinaForm={form}\n        form={form.finalForm}\n        field={field}\n        noWrap={noWrap}\n        isLabelHidden={isLabelHidden}\n      />\n    );\n  }\n\n  return (\n    <FieldMetaWrapper\n      input={{\n        value: getValue(),\n        onChange,\n      }}\n      field={field}\n      layout=\"column\"\n    >\n      <Typography>Unrecognized field type</Typography>\n    </FieldMetaWrapper>\n  );\n}\n\nexport interface FieldsBuilderProps {\n  form: Form;\n  fields: InternalField[];\n}\n\nconst HorizontalLine = styled.div`\n  height: 1px;\n  margin-top: -1px;\n  background-color: ${Colors.black10};\n`;\n\nexport function FieldsBuilder({ form, fields }: FieldsBuilderProps) {\n  const editorContext = useEditorContext();\n  const panelContext = useContext(PanelContext);\n  const grouped: Record<string, Array<InternalField>> = {};\n  const ungrouped: Array<InternalField> = [];\n\n  fields.forEach((field) => {\n    if (!shouldFieldBeDisplayed(field)) {\n      return;\n    }\n\n    if (field.group) {\n      grouped[field.group] = grouped[field.group] || [];\n      grouped[field.group].push(field);\n    } else {\n      if (field.component === \"identity\") {\n        return;\n      }\n\n      ungrouped.push(field);\n    }\n  });\n\n  const horizontalLine = <HorizontalLine />;\n\n  const identityField = fields.find((field) => field.component === \"identity\");\n\n  const breakpointIndex = panelContext\n    ? editorContext.breakpointIndex\n    : undefined;\n\n  return (\n    <FieldsGroup>\n      {identityField !== undefined && (\n        <React.Fragment>\n          <FieldBuilder field={identityField} form={form} />\n          {horizontalLine}\n        </React.Fragment>\n      )}\n      {Object.keys(grouped).map((groupName) => (\n        <div key={groupName}>\n          <FieldsGroupLabel>{groupName}</FieldsGroupLabel>\n          {grouped[groupName].map((field, index, fields) => (\n            <FieldWrapper\n              key={generateFieldKey(field, breakpointIndex)}\n              isLast={index === fields.length - 1}\n            >\n              <FieldBuilder\n                field={field}\n                form={form}\n                isLabelHidden={field.schemaProp.isLabelHidden}\n              />\n            </FieldWrapper>\n          ))}\n          {horizontalLine}\n        </div>\n      ))}\n      {ungrouped.map((field, index, fields) => (\n        <FieldWrapper\n          key={generateFieldKey(field, breakpointIndex)}\n          isLast={index === fields.length - 1}\n        >\n          <FieldBuilder\n            field={field}\n            form={form}\n            isLabelHidden={field.schemaProp.isLabelHidden}\n          />\n        </FieldWrapper>\n      ))}\n      {horizontalLine}\n    </FieldsGroup>\n  );\n}\n\nfunction generateFieldKey(\n  field: InternalField,\n  breakpointIndex: string | undefined\n) {\n  const key = `${toArray(field.name).join(\"_\")}_${field.schemaProp.type}${\n    breakpointIndex ? `_${breakpointIndex}` : \"\"\n  }`;\n  return key;\n}\n\nconst FieldWrapper = styled.div<{ isLast: boolean }>`\n  margin-bottom: ${(props) => (props.isLast ? \"8px\" : 0)};\n`;\n\nconst FieldsGroupLabel = styled.div`\n  display: flex;\n  align-items: center;\n\n  padding: 20px 16px 10px 16px;\n\n  ${Fonts.label};\n  color: #000;\n`;\n\nconst FieldsGroup = styled.div`\n  position: relative;\n  display: block;\n  width: 100%;\n  padding: 0;\n  white-space: nowrap;\n  overflow-x: hidden;\n  overflow-y: auto !important;\n`;\n","import { styled, createGlobalStyle, css } from \"styled-components\";\n\nconst theme = css`\n  :root {\n    --tina-color-primary-light: #2296fe;\n    --tina-color-primary: #2296fe;\n    --tina-color-primary-dark: #0574e4;\n    --tina-color-error-light: #eb6337;\n    --tina-color-error: #ec4815;\n    --tina-color-error-dark: #dc4419;\n    --tina-color-warning-light: #f5e06e;\n    --tina-color-warning: #e9d050;\n    --tina-color-warning-dark: #d3ba38;\n    --tina-color-success-light: #57c355;\n    --tina-color-success: #3cad3a;\n    --tina-color-success-dark: #249a21;\n    --tina-color-grey-0: #ffffff;\n    --tina-color-grey-1: #f6f6f9;\n    --tina-color-grey-2: #edecf3;\n    --tina-color-grey-3: #e1ddec;\n    --tina-color-grey-4: #b2adbe;\n    --tina-color-grey-5: #918c9e;\n    --tina-color-grey-6: #716c7f;\n    --tina-color-grey-7: #565165;\n    --tina-color-grey-8: #433e52;\n    --tina-color-grey-9: #363145;\n    --tina-color-grey-10: #282828;\n\n    --tina-radius-small: 5px;\n    --tina-radius-big: 24px;\n\n    --tina-padding-small: 12px;\n    --tina-padding-big: 20px;\n\n    --tina-font-size-0: 12px;\n    --tina-font-size-1: 13px;\n    --tina-font-size-2: 15px;\n    --tina-font-size-3: 16px;\n    --tina-font-size-4: 18px;\n    --tina-font-size-5: 20px;\n    --tina-font-size-6: 22px;\n    --tina-font-size-7: 26px;\n    --tina-font-size-8: 32px;\n\n    --tina-font-family: \"Inter\", sans-serif;\n\n    --tina-font-weight-regular: 400;\n    --tina-font-weight-bold: 600;\n\n    --tina-shadow-big: 0px 2px 3px rgba(0, 0, 0, 0.05),\n      0 4px 12px rgba(0, 0, 0, 0.1);\n    --tina-shadow-small: 0px 2px 3px rgba(0, 0, 0, 0.12);\n\n    --tina-timing-short: 85ms;\n    --tina-timing-medium: 150ms;\n    --tina-timing-long: 250ms;\n\n    --tina-z-index-0: 500;\n    --tina-z-index-1: 1000;\n    --tina-z-index-2: 1500;\n    --tina-z-index-3: 2000;\n    --tina-z-index-4: 2500;\n    --tina-z-index-5: 3000;\n\n    --tina-sidebar-width: 340px;\n    --tina-sidebar-header-height: 60px;\n    --tina-toolbar-height: 62px;\n  }\n`;\n\nexport const GlobalStyles = createGlobalStyle`\n  ${theme};\n`;\n\nconst tina_reset_styles = css`\n  * {\n    font-family: \"Inter\", sans-serif;\n    &::-webkit-scrollbar {\n      width: 8px;\n    }\n    ::-webkit-scrollbar-track {\n      background: transparent;\n      border-left: 1px solid var(--tina-color-grey-2);\n    }\n    &::-webkit-scrollbar-thumb {\n      background-color: var(--tina-color-grey-3);\n      border-radius: 0;\n      border: none;\n    }\n  }\n\n  *,\n  *:before,\n  *:after {\n    box-sizing: border-box;\n  }\n\n  hr {\n    border-color: var(--tina-color-grey-2);\n    color: var(--tina-color-grey-2);\n    margin-bottom: var(--tina-padding-big);\n    margin-left: calc(var(--tina-padding-big) * -1);\n    margin-right: calc(var(--tina-padding-big) * -1);\n    border-top: 1px solid var(--tina-color-grey-2);\n    border-bottom: none;\n    height: 0;\n    box-sizing: content-box;\n  }\n  h1,\n  h2,\n  h3,\n  h4,\n  h5,\n  h6,\n  p {\n    :not([class]) {\n      font-family: \"Inter\", sans-serif;\n      &:first-child {\n        margin-top: 0;\n      }\n      &:last-child {\n        margin-bottom: 0;\n      }\n    }\n  }\n  td,\n  th {\n    padding: 0;\n    width: auto;\n    height: auto;\n    border: inherit;\n    margin: 0;\n  }\n  h1,\n  h2,\n  h3,\n  h4,\n  h5,\n  h6 {\n    :not([class]) {\n      font-weight: var(--tina-font-weight-bold);\n    }\n  }\n  h1:not([class]) {\n    font-size: var(--tina-font-size-8);\n  }\n  h2:not([class]) {\n    font-size: var(--tina-font-size-7);\n  }\n  h3:not([class]) {\n    font-size: var(--tina-font-size-5);\n  }\n  h4:not([class]) {\n    font-size: var(--tina-font-size-4);\n  }\n  h5:not([class]) {\n    font-size: var(--tina-font-size-3);\n  }\n  h6:not([class]) {\n    font-size: var(--tina-font-size-2);\n  }\n`;\n\nexport const StyleReset = styled.div`\n  ${tina_reset_styles}\n`;\n","import { styled, css } from \"styled-components\";\n\ninterface ButtonProps {\n  primary?: boolean;\n  small?: boolean;\n  margin?: boolean;\n  grow?: boolean;\n  open?: boolean;\n  busy?: boolean;\n  disabled?: boolean;\n}\n\nconst Button = styled.button<ButtonProps>`\n  text-align: center;\n  border: 0;\n  border-radius: var(--tina-radius-big);\n  box-shadow: var(--tina-shadow-small);\n  background-color: var(--tina-color-grey-0);\n  border: 1px solid var(--tina-color-grey-2);\n  color: var(--tina-color-primary);\n  fill: var(--tina-color-primary);\n  font-weight: var(--tina-font-weight-regular);\n  cursor: pointer;\n  font-size: var(--tina-font-size-1);\n  height: 40px;\n  padding: 0 var(--tina-padding-big);\n  transition: all 85ms ease-out;\n\n  &:hover {\n    background-color: var(--tina-color-grey-1);\n  }\n  &:active {\n    background-color: var(--tina-color-grey-2);\n    outline: none;\n  }\n\n  ${(p) =>\n    p.disabled &&\n    css`\n      opacity: 0.3;\n      pointer: not-allowed;\n      pointer-events: none;\n    `};\n\n  ${(p) =>\n    p.primary &&\n    css`\n      background-color: var(--tina-color-primary);\n      color: var(--tina-color-grey-0);\n      fill: var(--tina-color-grey-0);\n      border: none;\n      &:hover {\n        background-color: var(--tina-color-primary-light);\n      }\n      &:active {\n        background-color: var(--tina-color-primary-dark);\n      }\n    `};\n\n  ${(p) =>\n    p.small &&\n    css`\n      height: 32px;\n      font-size: var(--tina-font-size-0);\n      padding: 0 var(--tina-padding-big);\n    `};\n\n  ${(p) =>\n    p.margin &&\n    css`\n      &:not(:first-child) {\n        margin-left: 8px;\n      }\n    `};\n\n  ${(p) =>\n    p.grow &&\n    css`\n      flex-grow: 1;\n    `};\n\n  ${(p) =>\n    p.busy &&\n    css`\n      cursor: wait;\n    `};\n`;\n\nexport const ICON_BUTTON_SIZE = 18;\nconst ICON_SIZE = 18;\n\nexport const IconButton = styled(Button)`\n  padding: 0;\n  width: ${ICON_BUTTON_SIZE}px;\n  height: ${ICON_BUTTON_SIZE}px;\n  margin: 0;\n  position: relative;\n  transform-origin: 50% 50%;\n  transition: all 150ms ease-out;\n  padding: 0;\n  display: flex;\n  flex-shrink: 0;\n  justify-content: center;\n  align-items: center;\n\n  svg {\n    width: ${ICON_SIZE}px;\n    height: ${ICON_SIZE}px;\n    transition: all 150ms ease-out;\n  }\n\n  ${(props) =>\n    props.open &&\n    css`\n      background-color: var(--tina-color-grey-0);\n      border-color: var(--tina-color-grey-2);\n      outline: none;\n      fill: var(--tina-color-primary);\n      svg {\n        transform: rotate(45deg);\n      }\n      &:hover {\n        background-color: var(--tina-color-grey-1);\n      }\n      &:active {\n        background-color: var(--tina-color-grey-2);\n      }\n    `};\n`;\n","import { InternalField } from \"@redsun-vn/easyblocks-core/_internals\";\nimport React, { MouseEvent } from \"react\";\nimport { styled } from \"styled-components\";\nimport { useEditorContext } from \"./EditorContext\";\nimport { SidebarFooter } from \"./SidebarFooter\";\nimport { FieldsBuilder } from \"./tinacms/form-builder\";\nimport { StyleReset } from \"./tinacms/styles\";\n\ninterface InlineSettingsProps {\n  fields: InternalField[];\n}\n\nexport function InlineSettings({ fields }: InlineSettingsProps) {\n  const hasNoExtraFields = !(fields && fields.length);\n\n  if (hasNoExtraFields) {\n    return null;\n  }\n\n  return (\n    <StyleReset\n      onClick={(e: MouseEvent) => {\n        e.stopPropagation();\n      }}\n      style={{ height: \"100%\" }}\n    >\n      {/* IMPORTANT: This stop propagation fixes issues with toggle unclicking */}\n      <SettingsContent fields={fields} />\n    </StyleReset>\n  );\n}\ninterface SettingsContentProps {\n  title?: string;\n  fields: InternalField[];\n}\n\nfunction SettingsContent({ fields }: SettingsContentProps) {\n  const { form, focussedField } = useEditorContext();\n\n  return (\n    <FormBody id={\"sidebar-panels-root\"}>\n      <Wrapper>\n        <FieldsBuilder form={form} fields={fields} />\n        <SidebarFooter paths={focussedField} />\n      </Wrapper>\n    </FormBody>\n  );\n}\n\nconst FormBody = styled.div`\n  position: relative;\n  flex: 1 1 auto;\n  display: flex;\n  flex-direction: column;\n  width: 100%;\n  height: 100%;\n  border-top: 1px solid var(--tina-color-grey-2);\n  background-color: white;\n`;\n\nconst Wrapper = styled.div`\n  display: block;\n  margin: 0 auto;\n  width: 100%;\n  height: 100%;\n  overflow-y: auto;\n`;\n","import { CompiledComponentConfig } from \"@redsun-vn/easyblocks-core\";\nimport { Fonts } from \"@redsun-vn/easyblocks-design-system\";\nimport { dotNotationGet } from \"@/utils\";\nimport React from \"react\";\nimport { styled } from \"styled-components\";\nimport { buildTinaFields } from \"./buildTinaFields\";\nimport { useEditorContext } from \"./EditorContext\";\nimport { InlineSettings } from \"./inline-settings\";\nimport { mergeCommonFields } from \"./tinacms/form-builder/utils/mergeCommonFields\";\nimport { Form } from \"./form\";\n\ntype EditorSidebarProps = {\n  focussedField: Array<string>;\n  form: Form;\n};\n\nconst Error = styled.div`\n  ${Fonts.body}\n  padding: 7px 6px 7px;\n  color: hsl(0deg 0% 50% / 0.8);\n  white-space: normal;\n  background: hsl(0deg 100% 50% / 0.2);\n  margin-right: 10px;\n  border-radius: 2px;\n  margin: 16px;\n`;\n\nexport const EditorSidebar: React.FC<EditorSidebarProps> = (props) => {\n  const { focussedField, form } = props;\n  const editorContext = useEditorContext();\n\n  const error = (() => {\n    if (focussedField.length === 1) {\n      const path = focussedField[0];\n      const compiledComponent: CompiledComponentConfig = dotNotationGet(\n        editorContext.compiledComponentConfig,\n        path\n      );\n      const editableComponent = dotNotationGet(form.values, path);\n      if (compiledComponent?._component === \"@easyblocks/missing-component\") {\n        return `Cant find definition for component: ${editableComponent._component} in your project. Please contact your developers to resolve this issue.`;\n      }\n    }\n\n    return null;\n  })();\n\n  const areMultipleFieldsSelected = focussedField.length > 1;\n  const focusedFields = focussedField.length === 0 ? [\"\"] : focussedField;\n  const fieldsPerFocusedField = focusedFields.map((focusedField) => {\n    return buildTinaFields(focusedField, editorContext);\n  });\n\n  const mergedFields = areMultipleFieldsSelected\n    ? mergeCommonFields({\n        fields: fieldsPerFocusedField,\n      })\n    : fieldsPerFocusedField.flat();\n\n  return (\n    <>\n      {error && <Error>{error}</Error>}\n      <InlineSettings fields={mergedFields} />\n    </>\n  );\n};\n","import { Devices, Locale } from \"@redsun-vn/easyblocks-core\";\nimport {\n  ButtonGhost,\n  ButtonPrimary,\n  ButtonDanger,\n  Colors,\n  Fonts,\n  Icons,\n  Select,\n  SelectItem,\n  Toggle,\n  ToggleGroup,\n  ToggleGroupItem,\n  Tooltip,\n  TooltipContent,\n  TooltipTrigger,\n  Typography,\n} from \"@redsun-vn/easyblocks-design-system\";\nimport React, { ReactNode, useRef } from \"react\";\nimport { styled } from \"styled-components\";\n\nexport const TOP_BAR_HEIGHT = 40;\n\nconst TopBar = styled.div`\n  position: relative;\n  box-sizing: border-box;\n  background-color: white;\n  border-bottom: 1px solid #eaeaea;\n  padding: 0 64px;\n  min-height: ${TOP_BAR_HEIGHT}px;\n  display: flex;\n  flex-direction: row;\n  justify-content: center;\n  align-items: center;\n`;\n\nconst Label = styled.div`\n  background: ${Colors.purple};\n  height: 24px;\n  ${Fonts.label}\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  padding-left: 12px;\n  padding-right: 12px;\n  border-radius: 12px;\n  color: white;\n`;\n\nconst TopBarLeft = styled.div`\n  position: absolute;\n  top: 0;\n  left: 4px;\n  height: 100%;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  gap: 4px;\n`;\n\nconst TopBarRight = styled.div`\n  position: absolute;\n  top: 0;\n  right: 8px;\n  height: 100%;\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n  gap: 16px;\n`;\n\nconst TopBarCenter = styled.div`\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  transform: translate(-50%, -50%);\n`;\n\nconst ImageContainer = styled.div`\n  position: relative;\n  width: 20px;\n  height: 20px;\n`;\n\nconst Image = styled.img`\n  width: 100%;\n  height: 100%;\n  object-fit: contain;\n`;\n\nexport const EditorTopBar: React.FC<{\n  saveLabel: string;\n  onClose?: () => void;\n  onSaveDocument?: () => void;\n  onIsEditingChange: () => void;\n  viewport: string;\n  onViewportChange: (viewport: string) => void;\n  devices: Devices;\n  isEditing: boolean;\n  onUndo: () => void;\n  onRedo: () => void;\n  locales: Locale[];\n  locale: string;\n  onLocaleChange: (locale: string) => void;\n  hideCloseButton: boolean;\n  readOnly: boolean;\n}> = ({\n  onClose,\n  onSaveDocument,\n  onViewportChange,\n  devices,\n  viewport,\n  onIsEditingChange,\n  isEditing,\n  onUndo,\n  onRedo,\n  locales,\n  locale,\n  onLocaleChange,\n  hideCloseButton,\n  readOnly\n}) => {\n    const headingRef = useRef<HTMLDivElement>(null);\n    const router = new URLSearchParams(window.location.search);\n    const themeId = router.get(\"themeId\");\n    const shopId = router.get(\"shopId\");\n\n    return (\n      <TopBar ref={headingRef}>\n        <TopBarLeft>\n          {!hideCloseButton && (\n            <>\n              <ButtonGhost icon={Icons.Close} hideLabel onClick={onClose}>\n                Close\n              </ButtonGhost>\n\n              <div\n                style={{ height: \"100%\", background: Colors.black10, width: 1 }}\n              />\n            </>\n          )}\n          <ButtonGhost\n            icon={Icons.Undo}\n            hideLabel\n            onClick={() => {\n              onUndo();\n            }}\n          >\n            Undo\n          </ButtonGhost>\n          <ButtonGhost\n            icon={Icons.Redo}\n            hideLabel\n            onClick={() => {\n              onRedo();\n            }}\n          >\n            Redo\n          </ButtonGhost>\n\n          {readOnly && <Label>Read-Only</Label>}\n\n          <ButtonDanger\n            className=\"cursor-pointer\"\n            component=\"label\"\n            onClick={() => onSaveDocument?.()}\n          >\n            Save\n          </ButtonDanger>\n\n        </TopBarLeft>\n\n        <TopBarCenter>\n          <DeviceSwitch\n            devices={devices}\n            deviceId={viewport}\n            onDeviceChange={onViewportChange}\n          />\n        </TopBarCenter>\n\n        <TopBarRight>\n          <div\n            style={{\n              display: \"flex\",\n              flexDirection: \"row\",\n              gap: \"6px\",\n              alignItems: \"center\",\n            }}\n          >\n            <Select value={locale} onChange={onLocaleChange}>\n              {locales.map((l) => (\n                <SelectItem key={l.code} value={l.code}>\n                  <div\n                    style={{\n                      display: \"flex\",\n                      alignItems: \"center\",\n                      justifyContent: \"center\",\n                      cursor: \"pointer\",\n                      gap: 4,\n                    }}\n                  >\n                    {l.icon ? (\n                      <ImageContainer>\n                        <Image src={l.icon} alt={l.name} />\n                      </ImageContainer>\n                    ) : null}\n                    {l.name}\n                  </div>\n                </SelectItem>\n              ))}\n            </Select>\n\n            <a href={`/?previewId=${themeId}&shopId=${shopId}`} target=\"_blank\">\n              <ButtonPrimary component=\"label\" className=\"cursor-pointer\">\n                Preview\n              </ButtonPrimary>\n            </a>\n\n            <Typography\n              variant={\"body\"}\n              component=\"label\"\n              htmlFor=\"easyblocks-edit-mode-button\"\n            >\n              Edit mode\n            </Typography>{\" \"}\n\n            <Toggle\n              name=\"easyblocks-edit-mode-button\"\n              checked={isEditing}\n              onChange={() => {\n                onIsEditingChange();\n              }}\n            />\n          </div>\n        </TopBarRight>\n      </TopBar>\n    );\n  };\n\nconst DEVICE_ID_TO_ICON: Record<\n  Devices[number][\"id\"] | \"fit-screen\",\n  ReactNode\n> = {\n  xs: (\n    <svg\n      width=\"16\"\n      height=\"16\"\n      viewBox=\"0 0 16 16\"\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      <path\n        fillRule=\"evenodd\"\n        clipRule=\"evenodd\"\n        d=\"M10 2.51691H6C5.44772 2.51691 5 2.96463 5 3.51691L5.00005 12.483C5.00005 13.0353 5.44777 13.483 6.00005 13.483H10.0001C10.5523 13.483 11.0001 13.0353 11.0001 12.483L11 3.51691C11 2.96463 10.5523 2.51691 10 2.51691ZM6 1.51691C4.89543 1.51691 4 2.41234 4 3.51691L4.00005 12.483C4.00005 13.5876 4.89548 14.483 6.00005 14.483H10.0001C11.1046 14.483 12.0001 13.5876 12.0001 12.483L12 3.51691C12 2.41234 11.1046 1.51691 10 1.51691H6Z\"\n        fill=\"black\"\n      />\n      <path\n        fillRule=\"evenodd\"\n        clipRule=\"evenodd\"\n        d=\"M8.99548 12.5H7.00452V11.5H8.99548V12.5Z\"\n        fill=\"black\"\n      />\n    </svg>\n  ),\n  sm: (\n    <svg\n      width=\"16\"\n      height=\"16\"\n      viewBox=\"0 0 16 16\"\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      <path\n        fillRule=\"evenodd\"\n        clipRule=\"evenodd\"\n        d=\"M2.51694 6.00005L2.51694 10C2.51694 10.5523 2.96466 11 3.51694 11L12.4831 11C13.0353 11 13.4831 10.5523 13.4831 9.99999L13.4831 5.99999C13.4831 5.44771 13.0353 4.99999 12.4831 4.99999L3.51694 5.00005C2.96466 5.00005 2.51694 5.44776 2.51694 6.00005ZM1.51694 10C1.51694 11.1046 2.41238 12 3.51694 12L12.4831 12C13.5876 12 14.4831 11.1046 14.4831 9.99999L14.4831 5.99999C14.4831 4.89542 13.5876 3.99999 12.4831 3.99999L3.51694 4.00005C2.41237 4.00005 1.51694 4.89548 1.51694 6.00005L1.51694 10Z\"\n        fill=\"black\"\n      />\n      <path\n        fillRule=\"evenodd\"\n        clipRule=\"evenodd\"\n        d=\"M12.5 7.00452L12.5 8.99548L11.5 8.99548L11.5 7.00452L12.5 7.00452Z\"\n        fill=\"black\"\n      />\n    </svg>\n  ),\n  md: (\n    <svg\n      width=\"16\"\n      height=\"18\"\n      viewBox=\"0 0 16 18\"\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      <path\n        fillRule=\"evenodd\"\n        clipRule=\"evenodd\"\n        d=\"M12.4918 1.97229L3.50793 1.9723C2.95565 1.9723 2.50793 2.42001 2.50793 2.9723L2.50797 15.0277C2.50797 15.58 2.95569 16.0277 3.50797 16.0277L12.4918 16.0277C13.0441 16.0277 13.4918 15.58 13.4918 15.0277L13.4918 2.97229C13.4918 2.42001 13.0441 1.97229 12.4918 1.97229ZM3.50793 0.972299C2.40337 0.972299 1.50793 1.86773 1.50793 2.9723L1.50797 15.0277C1.50797 16.1323 2.4034 17.0277 3.50797 17.0277L12.4918 17.0277C13.5964 17.0277 14.4918 16.1323 14.4918 15.0277L14.4918 2.97229C14.4918 1.86772 13.5964 0.97229 12.4918 0.97229L3.50793 0.972299Z\"\n        fill=\"black\"\n      />\n      <path\n        fillRule=\"evenodd\"\n        clipRule=\"evenodd\"\n        d=\"M10 14.9777H6V13.9777H10V14.9777Z\"\n        fill=\"black\"\n      />\n    </svg>\n  ),\n  lg: (\n    <svg\n      width=\"18\"\n      height=\"16\"\n      viewBox=\"0 0 18 16\"\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      <path\n        fillRule=\"evenodd\"\n        clipRule=\"evenodd\"\n        d=\"M1.97229 3.50815L1.9723 12.492C1.9723 13.0443 2.42001 13.492 2.9723 13.492L15.0277 13.492C15.58 13.492 16.0277 13.0443 16.0277 12.492L16.0277 3.50812C16.0277 2.95583 15.58 2.50812 15.0277 2.50812L2.97229 2.50815C2.42 2.50815 1.97229 2.95587 1.97229 3.50815ZM0.972299 12.492C0.972299 13.5966 1.86773 14.492 2.9723 14.492L15.0277 14.492C16.1323 14.492 17.0277 13.5965 17.0277 12.492L17.0277 3.50812C17.0277 2.40355 16.1323 1.50812 15.0277 1.50812L2.97229 1.50815C1.86772 1.50815 0.97229 2.40359 0.97229 3.50815L0.972299 12.492Z\"\n        fill=\"black\"\n      />\n      <path\n        fillRule=\"evenodd\"\n        clipRule=\"evenodd\"\n        d=\"M14.9778 6L14.9778 10L13.9778 10L13.9778 6L14.9778 6Z\"\n        fill=\"black\"\n      />\n    </svg>\n  ),\n  xl: (\n    <svg\n      width=\"16\"\n      height=\"16\"\n      viewBox=\"0 0 16 16\"\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      <path\n        fillRule=\"evenodd\"\n        clipRule=\"evenodd\"\n        d=\"M14.5111 13.0004L1.48889 13.0004L1.48889 12.0004L14.5111 12.0004V13.0004Z\"\n        fill=\"black\"\n      />\n      <path\n        fillRule=\"evenodd\"\n        clipRule=\"evenodd\"\n        d=\"M12.5828 3.99961H3.41723V9.91598H12.5828V3.99961ZM2.5 2.99961V10.916H13.5V2.99961H2.5Z\"\n        fill=\"black\"\n      />\n    </svg>\n  ),\n  \"2xl\": (\n    <svg\n      width=\"16\"\n      height=\"16\"\n      viewBox=\"0 0 16 16\"\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      <path\n        fillRule=\"evenodd\"\n        clipRule=\"evenodd\"\n        d=\"M14 3.00213H2V10.9979H14V3.00213ZM1 2.00213V11.9979H15V2.00213H1Z\"\n        fill=\"black\"\n      />\n      <path\n        fillRule=\"evenodd\"\n        clipRule=\"evenodd\"\n        d=\"M11 13.9979L5 13.9979V12.9979L11 12.9979V13.9979Z\"\n        fill=\"black\"\n      />\n    </svg>\n  ),\n  \"fit-screen\": (\n    <svg\n      width=\"16\"\n      height=\"16\"\n      viewBox=\"0 0 16 16\"\n      fill=\"none\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n    >\n      <path\n        d=\"M14.2872 7.97504L12.2872 5.79322M14.2872 7.97504C14.2872 7.97504 13.0683 9.30481 12.2872 10.1569M14.2872 7.97504L10.0372 7.97504\"\n        stroke=\"black\"\n      />\n      <path\n        d=\"M1.79272 7.97503L3.79272 10.1568M1.79272 7.97503C1.79272 7.97503 3.01168 6.64527 3.79272 5.79321M1.79272 7.97503L6.04272 7.97503\"\n        stroke=\"black\"\n      />\n      <path\n        fillRule=\"evenodd\"\n        clipRule=\"evenodd\"\n        d=\"M3.96777 2.52881H12.0323V4.49858H13.0323V1.52881H2.96777V4.49858H3.96777V2.52881ZM3.96777 11.5014H2.96777V14.4712H13.0323V11.5014H12.0323V13.4712H3.96777V11.5014Z\"\n        fill=\"black\"\n      />\n    </svg>\n  ),\n};\n\nfunction DeviceSwitch({\n  deviceId,\n  devices,\n  onDeviceChange,\n}: {\n  devices: Devices;\n  deviceId: string;\n  onDeviceChange: (deviceId: string) => void;\n}) {\n  return (\n    <ToggleGroup\n      value={deviceId}\n      onChange={(deviceId) => {\n        if (deviceId === \"\") {\n          return;\n        }\n\n        onDeviceChange(deviceId);\n      }}\n    >\n      {devices.map((d) => {\n        if (d.hidden) {\n          return null;\n        }\n\n        return (\n          <Tooltip key={d.id}>\n            <TooltipTrigger>\n              <ToggleGroupItem value={d.id}>\n                {DEVICE_ID_TO_ICON[d.id]}\n              </ToggleGroupItem>\n            </TooltipTrigger>\n\n            <TooltipContent>\n              <Typography color=\"white\">{d.label ?? d.id}</Typography>\n            </TooltipContent>\n          </Tooltip>\n        );\n      })}\n\n      <Tooltip>\n        <TooltipTrigger>\n          <ToggleGroupItem value=\"fit-screen\">\n            {DEVICE_ID_TO_ICON[\"fit-screen\"]}\n          </ToggleGroupItem>\n        </TooltipTrigger>\n\n        <TooltipContent>\n          <Typography color=\"white\">Fit screen</Typography>\n        </TooltipContent>\n      </Tooltip>\n    </ToggleGroup>\n  );\n}\n","export function normalizeToStringArray(arg: string | string[] | undefined) {\n  return typeof arg === \"string\" ? [arg] : Array.isArray(arg) ? arg : [];\n}\n","import { EditorContextType } from \"./EditorContext\";\nimport { ComponentDefinitionShared } from \"@redsun-vn/easyblocks-core\";\nimport { normalizeToStringArray } from \"./normalizeToStringArray\";\n\nexport function getAllComponentTypes(editorContext: EditorContextType) {\n  const componentTypes = getComponentTypesFromDefinitions(\n    editorContext.definitions.components\n  );\n  return Array.from(new Set([...componentTypes]));\n}\n\nfunction getComponentTypesFromDefinitions(\n  definitions: ComponentDefinitionShared[]\n) {\n  const types = new Set<string>();\n\n  definitions.forEach(({ type }) => {\n    normalizeToStringArray(type).forEach((componentType) => {\n      types.add(componentType);\n    });\n  });\n\n  return Array.from(types);\n}\n","import { EditorContextType } from \"./EditorContext\";\nimport {\n  ComponentDefinitionShared,\n  isNoCodeComponentOfType,\n} from \"@redsun-vn/easyblocks-core\";\n\nexport function getAllComponentsOfType(\n  type: string,\n  editorContext: EditorContextType\n) {\n  return getAllComponentsOfTypeFromDefinitionsArray(\n    type,\n    editorContext.definitions.components\n  );\n}\n\nfunction getAllComponentsOfTypeFromDefinitionsArray(\n  type: string,\n  definitions: ComponentDefinitionShared[]\n) {\n  return definitions.filter((definition) =>\n    isNoCodeComponentOfType(definition, type)\n  );\n}\n","import { EditorContextType } from \"./EditorContext\";\nimport { getAllComponentTypes } from \"./getAllComponentTypes\";\nimport { normalizeToStringArray } from \"./normalizeToStringArray\";\nimport { getAllComponentsOfType } from \"./getAllComponentsOfType\";\nimport { findComponentDefinitionById } from \"@redsun-vn/easyblocks-core/_internals\";\nimport { ComponentDefinitionShared } from \"@redsun-vn/easyblocks-core\";\n\nexport function unrollAcceptsFieldIntoComponents(\n  accepts: string | string[] | undefined,\n  editorContext: EditorContextType\n) {\n  const allComponentTypes = getAllComponentTypes(editorContext);\n  const idsSet = new Set<ComponentDefinitionShared>();\n\n  normalizeToStringArray(accepts).forEach((acceptsEntry) => {\n    if (allComponentTypes.includes(acceptsEntry)) {\n      const componentType = acceptsEntry;\n      const components = getAllComponentsOfType(componentType, editorContext);\n\n      components.forEach((component) => {\n        idsSet.add(component);\n      });\n    } else {\n      const componentId = acceptsEntry;\n      const component = findComponentDefinitionById(componentId, editorContext);\n      if (component) {\n        idsSet.add(component);\n      }\n    }\n  });\n\n  return Array.from(idsSet);\n}\n","import {\n  NoCodeComponentEntry,\n  ComponentSchemaProp,\n  Template,\n} from \"@redsun-vn/easyblocks-core\";\nimport {\n  duplicateConfig,\n  findComponentDefinition,\n  normalize,\n} from \"@redsun-vn/easyblocks-core/_internals\";\nimport { dotNotationGet } from \"@/utils\";\nimport React, { FC } from \"react\";\nimport { useEditorContext } from \"./EditorContext\";\nimport { SearchableSmallPickerModal } from \"./SearchableSmallPickerModal\";\nimport { SectionPickerModal } from \"./SectionPicker\";\nimport { TemplatePicker, TemplatesDictionary } from \"./TemplatePicker\";\nimport { OpenComponentPickerConfig } from \"./types\";\nimport { unrollAcceptsFieldIntoComponents } from \"./unrollAcceptsFieldIntoComponents\";\n\ntype ModalProps = {\n  config: OpenComponentPickerConfig;\n  onClose: (config?: NoCodeComponentEntry) => void;\n  pickers?: Record<string, TemplatePicker>;\n};\n\nexport const ModalPicker: FC<ModalProps> = ({ config, onClose, pickers }) => {\n  const editorContext = useEditorContext();\n  const { form } = editorContext;\n\n  const split = config.path.split(\".\"); // TODO: right now only for collections\n  const parentPath = split.slice(0, split.length - 1).join(\".\");\n  const fieldName = split[split.length - 1];\n\n  const parentData: NoCodeComponentEntry = dotNotationGet(\n    form.values,\n    parentPath\n  );\n  const schemaProp = findComponentDefinition(\n    parentData,\n    editorContext\n  )!.schema.find((x) => x.prop === fieldName) as ComponentSchemaProp;\n\n  const componentTypes = config.componentTypes ?? schemaProp.accepts;\n  const components = unrollAcceptsFieldIntoComponents(\n    componentTypes,\n    editorContext\n  );\n\n  let templatesDictionary: TemplatesDictionary | undefined = undefined;\n\n  if (editorContext.templates) {\n    templatesDictionary = {};\n\n    components.forEach((component) => {\n      templatesDictionary![component.id] = {\n        component,\n        templates: [],\n      };\n\n      editorContext.templates!.forEach((template) => {\n        if (component.id === template.entry._component) {\n          templatesDictionary![component.id].templates.push(template);\n        }\n      });\n\n      if (templatesDictionary![component.id].templates.length === 0) {\n        delete templatesDictionary![component.id];\n      }\n    });\n  }\n\n  const picker = schemaProp.picker ?? \"compact\";\n\n  // const defaultPickerMode =\n  //   accepts.includes(\"section\") || componentTypes.includes(\"card\")\n  //     ? \"big\"\n  //     : \"small\";\n  //\n  // const pickerMode = schemaProp.picker || defaultPickerMode;\n\n  const close = (config: NoCodeComponentEntry) => {\n    const _itemProps = {\n      [parentData._component]: {\n        [fieldName]: {},\n      },\n    };\n\n    const newComponent = fieldName.startsWith(\"$\")\n      ? config\n      : duplicateConfig(\n          normalize(\n            {\n              ...config,\n              _itemProps,\n            },\n            editorContext\n          ),\n          editorContext\n        );\n\n    onClose(newComponent);\n  };\n\n  const onModalClose = (template?: Template) => {\n    if (template) {\n      close(normalize(template.entry, editorContext));\n    } else {\n      onClose();\n    }\n  };\n\n  return pickers?.[picker] ? (\n    pickers[picker]({\n      isOpen: true,\n      onClose: onModalClose,\n      templates: templatesDictionary,\n      mode: picker,\n    })\n  ) : (\n    <div>Unknown picker: {picker}</div>\n  );\n};\n","import React, { MouseEvent, useEffect, useState } from \"react\";\nimport {\n  OpenTemplateModalAction,\n  OpenTemplateModalActionCreate,\n} from \"./types\";\nimport {\n  FormElement,\n  ButtonDanger,\n  ButtonPrimary,\n  Input,\n  Modal,\n  useToaster,\n} from \"@redsun-vn/easyblocks-design-system\";\nimport { useEditorContext } from \"./EditorContext\";\nimport { Backend, Template } from \"@redsun-vn/easyblocks-core\";\n\ntype TemplateModalProps = {\n  action: OpenTemplateModalAction;\n  onClose: () => void;\n  backend: Backend;\n};\n\nexport const TemplateModal: React.FC<TemplateModalProps> = (props) => {\n  const [error, setError] = useState<null | string>(null);\n  const mode = props.action.mode;\n  const backend = props.backend;\n\n  const editorContext = useEditorContext();\n  const [isLoadingEdit, setLoadingEdit] = useState(false);\n  const [isLoadingDelete, setLoadingDelete] = useState(false);\n\n  const toaster = useToaster();\n  const [template, setTemplate] = useState(() => {\n    if (props.action.mode === \"edit\") {\n      return props.action.template;\n    } else {\n      return {\n        label: \"\",\n        group: \"\",\n        thumbnail: \"\",\n        thumbnailLabel: \"\",\n        entry: props.action.config,\n      };\n    }\n  });\n\n  const {\n    label = \"\",\n    group = \"\",\n    thumbnail = \"\",\n    thumbnailLabel = \"\",\n  } = template as Template;\n  const open = props.action !== undefined;\n  const canSend = label.trim() !== \"\";\n  const ctaLabel = \"Save\";\n\n  useEffect(() => {\n    if (open) {\n      setError(null);\n    }\n  }, [open]);\n\n  return (\n    <Modal\n      title={`Template details`}\n      isOpen={true}\n      onRequestClose={() => {\n        props.onClose();\n      }}\n      mode={\"center-small\"}\n      headerLine={true}\n    >\n      <form\n        onSubmit={(e) => {\n          e.preventDefault();\n\n          setError(null);\n\n          if (!canSend) {\n            return;\n          }\n\n          setLoadingEdit(true);\n\n          if (mode === \"create\") {\n            const createAction = props.action as OpenTemplateModalActionCreate;\n\n            backend.templates\n              .create({\n                label,\n                group,\n                thumbnail,\n                thumbnailLabel,\n                entry: createAction.config,\n                width: createAction.width,\n                widthAuto: createAction.widthAuto,\n              })\n              .then((newTemplate) => {\n                editorContext.syncTemplates({\n                  mode: \"create\",\n                  template: {\n                    id: newTemplate.id,\n                    ...template,\n                  },\n                });\n                toaster.success(\"Template created!\");\n                props.onClose();\n              })\n              .catch(() => {\n                toaster.error(\"Couldn't save template\");\n              })\n              .finally(() => {\n                setLoadingEdit(false);\n              });\n          } else {\n            backend.templates\n              .update({\n                label,\n                group,\n                thumbnail,\n                thumbnailLabel,\n                id: (template as Template).id!,\n              })\n              .then(() => {\n                editorContext.syncTemplates({\n                  mode: \"edit\",\n                  template: template as Template,\n                });\n                toaster.success(\"Template updated!\");\n                props.onClose();\n              })\n              .catch(() => {\n                toaster.error(\"Couldn't update template\");\n              })\n              .finally(() => {\n                setLoadingEdit(false);\n              });\n          }\n        }}\n      >\n        {error && <div>{error}</div>}\n\n        <div\n          style={{\n            display: \"flex\",\n            flexDirection: \"column\",\n            gap: \"12px\",\n            marginTop: \"8px\",\n          }}\n        >\n          <FormElement name=\"label\" label=\"Name\">\n            <Input\n              placeholder=\"My template name\"\n              required={true}\n              value={label}\n              onChange={(e) => {\n                setTemplate({\n                  ...template,\n                  label: e.target.value,\n                });\n              }}\n              withBorder={true}\n              autoFocus\n            />\n          </FormElement>\n\n          <FormElement name=\"group\" label=\"Group\">\n            <Input\n              placeholder=\"My template group\"\n              value={group}\n              onChange={(e) => {\n                setTemplate({\n                  ...template,\n                  group: e.target.value,\n                });\n              }}\n              withBorder={true}\n              autoFocus\n            />\n          </FormElement>\n\n          <FormElement name=\"thumbnail\" label=\"Thumbnail url\">\n            <Input\n              placeholder=\"My template thumbnail url\"\n              value={thumbnail}\n              onChange={(e) => {\n                setTemplate({\n                  ...template,\n                  thumbnail: e.target.value,\n                });\n              }}\n              withBorder={true}\n              autoFocus\n            />\n          </FormElement>\n\n          <FormElement name=\"thumbnailLabel\" label=\"Thumbnail label\">\n            <Input\n              placeholder=\"My template thumbnail label\"\n              value={thumbnailLabel}\n              onChange={(e) => {\n                setTemplate({\n                  ...template,\n                  thumbnailLabel: e.target.value,\n                });\n              }}\n              withBorder={true}\n              autoFocus\n            />\n          </FormElement>\n\n          <div\n            style={{\n              display: \"flex\",\n              flexDirection: \"row\",\n              justifyContent: \"space-between\",\n              marginTop: 8,\n            }}\n          >\n            <div>\n              {mode === \"edit\" && (\n                <ButtonDanger\n                  onClick={(e: MouseEvent) => {\n                    e.preventDefault();\n\n                    setLoadingDelete(true);\n\n                    backend.templates\n                      .delete({ id: (template as Template).id! })\n                      .then(() => {\n                        editorContext.syncTemplates({\n                          mode: \"delete\",\n                          template: template as Template,\n                        });\n                        toaster.success(\"Template deleted\");\n                        props.onClose();\n                      })\n                      .catch(() => {\n                        toaster.error(\"Couldn't delete template\");\n                      })\n                      .finally(() => {\n                        setLoadingDelete(false);\n                      });\n                  }}\n                  isLoading={isLoadingDelete}\n                >\n                  Delete\n                </ButtonDanger>\n              )}\n            </div>\n\n            <ButtonPrimary\n              type={\"submit\"}\n              disabled={!canSend}\n              isLoading={isLoadingEdit}\n            >\n              {ctaLabel}\n            </ButtonPrimary>\n          </div>\n        </div>\n      </form>\n    </Modal>\n  );\n};\n","import {\n  NoCodeComponentEntry,\n  ComponentSchemaProp,\n  isNoCodeComponentOfType,\n} from \"@redsun-vn/easyblocks-core\";\nimport {\n  CompilationContextType,\n  duplicateConfig,\n  findComponentDefinitionById,\n  parsePath,\n} from \"@redsun-vn/easyblocks-core/_internals\";\nimport {\n  dotNotationGet,\n  last,\n  preOrderPathComparator,\n} from \"@/utils\";\nimport { EditorContextType } from \"./EditorContext\";\nimport { Form } from \"./form\";\nimport { ResolveDestination } from \"./paste/destinationResolver\";\nimport { PasteCommand } from \"./paste/manager\";\nimport {\n  DuplicateItemActionType,\n  MoveItemActionType,\n  RemoveItemActionType,\n} from \"./types\";\n\nfunction duplicateItem(\n  form: Form,\n  { name, sourceIndex, targetIndex }: DuplicateItemActionType,\n  compilationContext: CompilationContextType\n) {\n  // Placeholders are not copyable\n  if (isPlaceholder(name + \".\" + sourceIndex, form.values)) {\n    return;\n  }\n\n  const configToDuplicate = dotNotationGet(\n    form.values,\n    name + \".\" + sourceIndex\n  );\n\n  form.mutators.insert(\n    name,\n    targetIndex,\n    duplicateConfig(configToDuplicate, compilationContext)\n  );\n}\n\nfunction pasteItems({\n  what,\n  where,\n  resolveDestination,\n  pasteCommand,\n}: {\n  what: Array<NoCodeComponentEntry>;\n  where: Array<string>;\n  resolveDestination: ResolveDestination;\n  pasteCommand: PasteCommand;\n}): Array<string> | undefined {\n  const successfulInsertsPaths: string[] = [];\n\n  takeLastOfEachParent(where)\n    .sort(preOrderPathComparator())\n    .map((initialDestination) => {\n      const destination = successfulInsertsPaths.reduce(\n        (acc, current) => shiftPath(acc, current, \"downward\"),\n        initialDestination\n      );\n\n      const resolvedDestinations = resolveDestination(destination);\n\n      return pasteCommand(resolvedDestinations);\n    })\n    .forEach((paste) => {\n      what.forEach((item) => {\n        const insertedPath = paste(item);\n        if (insertedPath) {\n          successfulInsertsPaths.push(insertedPath);\n        }\n      });\n    });\n\n  return successfulInsertsPaths.length !== 0 ? successfulInsertsPaths : where;\n}\n\n/**\n * Duplicates fields given in `fieldNames` within given `form`.\n * `compilationContext` is used to properly duplicate elements associated with given names.\n * @returns Array of fields to focus\n */\nfunction duplicateItems(\n  form: Form,\n  fieldNames: Array<string>,\n  compilationContext: CompilationContextType\n): Array<string> | undefined {\n  const duplicatableFieldNames = fieldNames.filter((fieldName) =>\n    isFieldDuplicatable(fieldName, form, compilationContext)\n  );\n\n  if (duplicatableFieldNames.length === 0) {\n    return;\n  }\n\n  const fieldsGroupedByParentPath = groupFieldsByParentPath(\n    duplicatableFieldNames,\n    \"ascending\"\n  );\n\n  const nextFocusedFieldsPerGroup: Array<Array<string>> = [];\n\n  Object.values(fieldsGroupedByParentPath).forEach(\n    (sortedFields, fieldsGroupIndex) => {\n      nextFocusedFieldsPerGroup.push([]);\n\n      const lastFieldIndex = getFieldPathIndex(last(sortedFields));\n\n      sortedFields.forEach((focusedField, fieldIndex) => {\n        const sourceIndex = getFieldPathIndex(focusedField);\n        const targetIndex = lastFieldIndex + 1 + fieldIndex;\n        const parentPath = getParentPath(focusedField);\n\n        duplicateItem(\n          form,\n          {\n            name: parentPath,\n            sourceIndex,\n            targetIndex,\n          },\n          compilationContext\n        );\n\n        nextFocusedFieldsPerGroup[fieldsGroupIndex].push(\n          `${parentPath}.${lastFieldIndex + 1 + fieldIndex}`\n        );\n      });\n    }\n  );\n\n  return nextFocusedFieldsPerGroup.flat();\n}\n\nfunction moveItem(form: Form, { from, to, name }: MoveItemActionType) {\n  // Placeholders are not movable\n  if (isPlaceholder(name + \".\" + from, form.values)) {\n    return;\n  }\n\n  form.mutators.move(name, from, to);\n}\n\n/**\n * Moves fields given in `fieldNamesToRemove` within given `form` in given `direction`.\n * @returns Array of fields to focus.\n */\nfunction moveItems(\n  form: Form,\n  fieldsToMove: Array<string>,\n  direction: \"top\" | \"right\" | \"bottom\" | \"left\"\n): Array<string> | undefined {\n  const nextFocusedFields: Array<string> = [];\n  const isMovingMultipleFields = fieldsToMove.length > 1;\n\n  if (direction === \"top\" || direction === \"left\") {\n    const fieldsGroupedByParentPath = groupFieldsByParentPath(\n      fieldsToMove,\n      \"ascending\"\n    );\n\n    Object.values(fieldsGroupedByParentPath).forEach((sortedFields) => {\n      let wasAnyFieldWithinCurrentGroupMoved = false;\n\n      sortedFields.forEach((fieldName, fieldNameIndex) => {\n        const index = getFieldPathIndex(fieldName);\n        const parentPath = getParentPath(fieldName);\n\n        if (isFirst(fieldName)) {\n          if (isMovingMultipleFields) {\n            nextFocusedFields.push(fieldName);\n          }\n\n          return;\n        }\n\n        if (\n          isMovingMultipleFields &&\n          fieldNameIndex > 0 &&\n          !wasAnyFieldWithinCurrentGroupMoved\n        ) {\n          nextFocusedFields.push(fieldName);\n          return;\n        }\n\n        moveItem(form, {\n          from: index,\n          name: parentPath,\n          to: index - 1,\n        });\n\n        if (!wasAnyFieldWithinCurrentGroupMoved) {\n          wasAnyFieldWithinCurrentGroupMoved = true;\n        }\n\n        nextFocusedFields.push(`${parentPath}.${index - 1}`);\n      });\n    });\n\n    if (nextFocusedFields.length > 0) {\n      return nextFocusedFields;\n    }\n  } else {\n    const fieldsGroupedByParentPath = groupFieldsByParentPath(\n      fieldsToMove,\n      \"descending\"\n    );\n\n    Object.values(fieldsGroupedByParentPath).forEach((sortedFields) => {\n      let wasAnyFieldWithinCurrentGroupMoved = false;\n\n      sortedFields.forEach((fieldName, fieldNameIndex) => {\n        if (isLast(fieldName, form)) {\n          if (isMovingMultipleFields) {\n            nextFocusedFields.push(fieldName);\n          }\n\n          return;\n        }\n\n        if (\n          isMovingMultipleFields &&\n          fieldNameIndex > 0 &&\n          !wasAnyFieldWithinCurrentGroupMoved\n        ) {\n          nextFocusedFields.push(fieldName);\n          return;\n        }\n\n        const index = getFieldPathIndex(fieldName);\n        const parentPath = getParentPath(fieldName);\n\n        moveItem(form, {\n          name: parentPath,\n          from: index,\n          to: index + 1,\n        });\n\n        if (!wasAnyFieldWithinCurrentGroupMoved) {\n          wasAnyFieldWithinCurrentGroupMoved = true;\n        }\n\n        nextFocusedFields.push(`${parentPath}.${index + 1}`);\n      });\n    });\n\n    if (nextFocusedFields.length > 0) {\n      return nextFocusedFields;\n    }\n  }\n}\n\nfunction removeItem(form: Form, { index, name }: RemoveItemActionType) {\n  const configPathToRemove = name + \".\" + index;\n\n  // Placeholders are not removable\n  if (isPlaceholder(configPathToRemove, form.values)) {\n    return;\n  }\n\n  const componentConfigValue = dotNotationGet(form.values, name);\n\n  if (componentConfigValue.length === 1) {\n    form.change(name, []);\n  } else {\n    form.mutators.remove(name, index);\n  }\n}\n\n/**\n * Removes fields given in `fieldNamesToRemove` from given `form`.\n * @returns Array of fields to focus\n */\nfunction removeItems(\n  form: Form,\n  fieldNamesToRemove: Array<string>,\n  compilationContext: CompilationContextType\n): Array<string> | undefined {\n  const removableFieldNames = fieldNamesToRemove.filter((fieldName) =>\n    isFieldRemovable(fieldName, form, compilationContext)\n  );\n\n  if (removableFieldNames.length === 0) {\n    return;\n  }\n\n  const isRemovingMultipleFields = removableFieldNames.length > 1;\n\n  const fieldsGroupedByParentPath = groupFieldsByParentPath(\n    removableFieldNames,\n    \"descending\"\n  );\n\n  if (!isRemovingMultipleFields) {\n    const { index, parent, templateId } = parsePath(\n      removableFieldNames[0],\n      form\n    );\n\n    if (index === undefined || !parent) {\n      throw new Error(\"Invalid path\");\n    }\n\n    const fieldPath = `${parent.path}${parent.path === \"\" ? \"\" : \".\"}${parent.fieldName\n      }`;\n    const itemsLength = dotNotationGet(form.values, fieldPath).length;\n    const isOnlyItem = itemsLength === 1;\n    const isLastItem = itemsLength - 1 === index;\n\n    removeItem(form, {\n      index,\n      name: fieldPath,\n    });\n\n    const definition = findComponentDefinitionById(\n      templateId,\n      compilationContext\n    );\n    const isTextWrapper =\n      definition &&\n      isNoCodeComponentOfType(definition, \"@easyblocks/text-wrapper\");\n\n    // If we're removing item from the text wrapper field let's focus the component holding that field for better UX\n    // TODO: We shouldn't decide based on the component type but rather on the source of the removal (canvas vs sidebar)\n    if (isTextWrapper) {\n      return [parent.path];\n    }\n\n    if (isOnlyItem) {\n      return [];\n    } else if (isLastItem) {\n      return [`${fieldPath}.${index - 1}`];\n    } else {\n      return [`${fieldPath}.${index}`];\n    }\n  }\n\n  Object.values(fieldsGroupedByParentPath).forEach((sortedFields) => {\n    sortedFields.forEach((focusedField) => {\n      const field = dotNotationGet(form.values, focusedField);\n\n      // Field could be already removed if its parent element was also selected\n      if (!field) {\n        return;\n      }\n\n      const index = getFieldPathIndex(focusedField);\n      const parentPath = getParentPath(focusedField);\n\n      removeItem(form, {\n        index,\n        name: parentPath,\n      });\n    });\n  });\n\n  return [];\n}\n\nfunction replaceItems(\n  paths: string[],\n  newConfig: NoCodeComponentEntry,\n  editorContext: EditorContextType\n) {\n  paths.forEach((path) => {\n    const oldConfig: NoCodeComponentEntry = dotNotationGet(\n      editorContext.form.values,\n      path\n    );\n\n    editorContext.form.change(\n      path,\n      duplicateConfig(\n        // newConfig && oldConfig\n        //   ? changeComponentConfig(oldConfig, newConfig, editorContext)\n        //   : newConfig,\n        newConfig,\n        editorContext\n      )\n    );\n  });\n}\n\nfunction logItems(form: Form, configPaths: Array<string>) {\n  const configValues = configPaths.map((configPath) => {\n    return dotNotationGet(form.values, configPath);\n  });\n\n  configValues.forEach((config, index) => {\n    console.log(\"Config for\", configPaths[index], config);\n  });\n}\n\nexport {\n  duplicateItems,\n  logItems,\n  moveItems,\n  pasteItems,\n  removeItems,\n  replaceItems,\n};\n\nfunction groupFieldsByParentPath(\n  fields: Array<string>,\n  sortDirection: \"ascending\" | \"descending\"\n): Record<string, Array<string>> {\n  const fieldsIndicesGroupedByParentPath = fields.reduce(\n    (accumulator, currentField) => {\n      const index = getFieldPathIndex(currentField);\n      const parentPath = getParentPath(currentField);\n\n      const indices = accumulator[parentPath];\n\n      if (indices) {\n        accumulator[parentPath] = [...indices, index].sort((a, b) => {\n          return sortDirection === \"descending\" ? b - a : a - b;\n        });\n        return accumulator;\n      }\n\n      accumulator[parentPath] = [index];\n\n      return accumulator;\n    },\n    {} as Record<string, Array<number>>\n  );\n\n  return Object.fromEntries(\n    Object.entries(fieldsIndicesGroupedByParentPath).map(\n      ([parentPath, indices]) => {\n        return [parentPath, indices.map((index) => parentPath + \".\" + index)];\n      }\n    )\n  );\n}\n\nfunction getFieldPathIndex(fieldPath: string): number {\n  const index = +last(fieldPath.split(\".\"));\n\n  if (Number.isNaN(index)) {\n    return -1;\n  }\n\n  return index;\n}\n\nfunction getParentPath(fieldPath: string): string {\n  const fieldPathParts = fieldPath.split(\".\");\n\n  return fieldPathParts.slice(0, -1).join(\".\");\n}\n\nfunction isFirst(fieldPath: string): boolean {\n  const index = getFieldPathIndex(fieldPath);\n\n  return index === 0;\n}\n\nfunction isLast(fieldPath: string, form: Form): boolean {\n  const index = getFieldPathIndex(fieldPath);\n  const parentPath = getParentPath(fieldPath);\n  const parentFieldElementsCount = dotNotationGet(\n    form.values,\n    parentPath\n  ).length;\n\n  return index === parentFieldElementsCount - 1;\n}\n\nfunction isPlaceholder(path: string, values: any) {\n  const templateId = dotNotationGet(values, path)._component;\n  return templateId.startsWith(\"$Placeholder\");\n}\n\nfunction isFieldRemovable(\n  fieldName: string,\n  form: Form,\n  compilationContext: CompilationContextType\n): boolean {\n  const { parent } = parsePath(fieldName, form);\n\n  if (parent) {\n    const parentComponentDefinition = findComponentDefinitionById(\n      parent.templateId,\n      compilationContext\n    );\n\n    const fieldNameParent = last(getParentPath(fieldName).split(\".\"));\n    const fieldSchema = parentComponentDefinition?.schema.find(\n      (schema) => schema.prop === fieldNameParent\n    );\n\n    if (\n      fieldSchema &&\n      fieldSchema.type === \"component\" &&\n      (fieldSchema as ComponentSchemaProp).required\n    ) {\n      return false;\n    }\n  }\n\n  return true;\n}\n\nfunction isFieldDuplicatable(\n  fieldName: string,\n  form: Form,\n  compilationContext: CompilationContextType\n): boolean {\n  return isFieldRemovable(fieldName, form, compilationContext);\n}\n\nexport const shiftPath = (\n  originalPath: string,\n  shiftingPath: string,\n  direction: \"upward\" | \"downward\" = \"downward\"\n) => {\n  const directionFactor = direction === \"downward\" ? 1 : -1;\n\n  const original = shiftingPath.split(\".\");\n  const shifting = originalPath.split(\".\");\n\n  if (original.length < 2) {\n    return originalPath;\n  }\n\n  let index = 0;\n\n  while (index < original.length - 1 && index < shifting.length - 1) {\n    if (shifting[index] !== original[index]) {\n      return originalPath;\n    }\n\n    if (shifting[index + 1] !== original[index + 1]) {\n      const numberA = Number(original[index + 1]);\n      const numberB = Number(shifting[index + 1]);\n\n      if (\n        numberA < numberB &&\n        (index + 1 == original.length - 1 || index + 1 === shifting.length - 1)\n      ) {\n        shifting.splice(index + 1, 1, String(numberB + directionFactor));\n        return shifting.join(\".\");\n      } else {\n        return originalPath;\n      }\n    }\n    index += 2;\n  }\n\n  return originalPath;\n};\n\nexport function takeLastOfEachParent(where: string[]) {\n  const lastOfEachParent = where.reduce((acc, curr) => {\n    const trimmed = getParentPath(curr);\n    const index = getFieldPathIndex(curr);\n\n    acc[trimmed] = Math.max(index, acc[trimmed] ?? Number.MIN_SAFE_INTEGER);\n\n    return acc;\n  }, {} as Record<string, number>);\n\n  return Object.entries(lastOfEachParent).map(\n    ([key, value]) => `${key}.${value}`\n  );\n}\n","import { CompilationContextType } from \"@redsun-vn/easyblocks-core/_internals\";\nimport { normalize } from \"@redsun-vn/easyblocks-core/_internals\";\nimport { NoCodeComponentEntry } from \"@redsun-vn/easyblocks-core\";\n\nexport function reconcile({\n  context,\n  templateId,\n  fieldName,\n}: {\n  context: CompilationContextType;\n  templateId?: string;\n  fieldName?: string;\n}) {\n  return (item: NoCodeComponentEntry) => {\n    if (!fieldName || !templateId) {\n      return item;\n    }\n\n    const contextMatches =\n      item._itemProps?.[templateId]?.[fieldName] !== undefined;\n\n    if (contextMatches) {\n      return item;\n    }\n\n    return normalize(\n      {\n        ...item,\n        _itemProps: {\n          [templateId]: {\n            [fieldName]: {},\n          },\n        },\n      },\n      context\n    );\n  };\n}\n","import {\n  ComponentCollectionSchemaProp,\n  NoCodeComponentEntry,\n  ComponentSchemaProp,\n  SchemaProp,\n} from \"@redsun-vn/easyblocks-core\";\nimport {\n  CompilationContextType,\n  duplicateConfig,\n  findComponentDefinition,\n} from \"@redsun-vn/easyblocks-core/_internals\";\nimport { includesAny } from \"@/utils\";\nimport { Form } from \"../form\";\nimport { normalizeToStringArray } from \"../normalizeToStringArray\";\nimport { reconcile } from \"./reconcile\";\n\nconst getTypes = (schema?: SchemaProp) => {\n  if (schema?.type === \"component-collection\" || schema?.type === \"component\") {\n    return (schema as ComponentCollectionSchemaProp | ComponentSchemaProp)\n      .accepts;\n  }\n  return [];\n};\n\nconst insertCommand = ({\n  context,\n  form,\n  schema,\n  templateId,\n}: {\n  context: CompilationContextType;\n  form: Form;\n  schema?: SchemaProp;\n  templateId?: string;\n}) => {\n  const types = getTypes(schema);\n\n  const reconcileItem = reconcile({\n    context,\n    templateId,\n    fieldName: schema?.prop,\n  });\n\n  return (path: string, index: number, item: NoCodeComponentEntry) => {\n    const itemDefinition = findComponentDefinition(item, context);\n    if (!itemDefinition) {\n      return null;\n    }\n\n    const itemTypes = [\n      itemDefinition.id,\n      ...normalizeToStringArray(itemDefinition.type),\n    ];\n    if (!includesAny(types, itemTypes)) {\n      return null;\n    }\n\n    const reconciledItem = reconcileItem(item);\n    const duplicatedItem = duplicateConfig(reconciledItem, context);\n\n    form.mutators.insert(path, index, duplicatedItem);\n\n    return `${path}.${index}`;\n  };\n};\n\nexport { insertCommand };\n","import { SchemaProp } from \"@redsun-vn/easyblocks-core\";\nimport {\n  CompilationContextType,\n  InternalRenderableComponentDefinition,\n  PathInfo,\n  findComponentDefinitionById,\n  parsePath,\n} from \"@redsun-vn/easyblocks-core/_internals\";\nimport { dotNotationGet } from \"@/utils\";\nimport { Form } from \"../form\";\nimport { insertCommand } from \"./insert\";\n\nexport interface Destination {\n  name: string;\n  index: number;\n  insert: ReturnType<typeof insertCommand>;\n}\n\nexport type ResolveDestination = ReturnType<typeof destinationResolver>;\n\nfunction getSchema(path: PathInfo, context: CompilationContextType) {\n  const parentDefinition = findComponentDefinitionById(\n    path.parent?.templateId ?? \"\",\n    context\n  );\n\n  const schema = (parentDefinition?.schema ?? []).find(\n    (s) => s.prop === path.parent?.fieldName\n  );\n\n  return schema;\n}\n\nconst toName = (destination: PathInfo) =>\n  [destination.parent?.path, destination.parent?.fieldName]\n    .filter(Boolean)\n    .join(\".\");\n\nconst fixIndexInCollection = (index = 0, schema?: SchemaProp) => {\n  if (schema?.type === \"component-collection\") {\n    return index + 1;\n  }\n  return index;\n};\n\nfunction destinationResolver({\n  form,\n  context,\n}: {\n  context: CompilationContextType;\n  form: Form;\n}) {\n  return function (initialDestinationPath: string) {\n    const resolvedDestinations: Destination[] = [];\n\n    const resolvedPaths = new Set<string>();\n    const pathsQueue = [initialDestinationPath];\n\n    while (pathsQueue.length > 0) {\n      const path = pathsQueue.shift();\n      if (!path) {\n        continue;\n      }\n\n      if (resolvedPaths.has(path)) {\n        continue;\n      }\n\n      if (!dotNotationGet(form.values, path)) {\n        continue;\n      }\n\n      const parsed = parsePath(path, form);\n\n      const definition = findComponentDefinitionById(\n        parsed.templateId ?? \"\",\n        context\n      );\n\n      if (!definition) {\n        continue;\n      }\n\n      const schema = getSchema(parsed, context);\n\n      resolvedDestinations.push({\n        index: fixIndexInCollection(parsed.index, schema),\n        name: toName(parsed),\n        insert: insertCommand({\n          context,\n          form,\n          schema,\n          templateId: parsed.parent?.templateId,\n        }),\n      });\n\n      for (const slot of (definition as InternalRenderableComponentDefinition)\n        .pasteSlots ?? []) {\n        const slotSchema = definition.schema.find(({ prop }) => prop === slot);\n\n        if (!slotSchema) {\n          continue;\n        }\n\n        const slotPath = `${path}.${slot}`;\n\n        const slotValues = dotNotationGet(form.values, slotPath) ?? [];\n\n        if (slotValues.length === 0) {\n          resolvedDestinations.push({\n            name: slotPath,\n            index: 0,\n            insert: insertCommand({\n              context,\n              form,\n              schema: slotSchema,\n              templateId: definition.id,\n            }),\n          });\n        } else if (slotSchema.type === \"component\") {\n          pathsQueue.push(`${slotPath}.0`);\n        } else if (slotSchema.type === \"component-collection\") {\n          pathsQueue.push(\n            ...Array.from(Array(slotValues.length).keys())\n              .map((idx) => `${slotPath}.${idx}`)\n              .reverse()\n          );\n        }\n      }\n    }\n\n    return resolvedDestinations;\n  };\n}\n\nexport { destinationResolver };\n","import { NoCodeComponentEntry } from \"@redsun-vn/easyblocks-core\";\nimport { Destination } from \"./destinationResolver\";\n\nfunction pasteManager() {\n  const inserts = new Map<string, number>();\n  return (destinations: Destination[]) => (item: NoCodeComponentEntry) => {\n    let i = 0;\n\n    while (i < destinations.length) {\n      const { index, name, insert } = destinations[i];\n\n      const path = `${name}.${index}`;\n      const latestDestinationInserts = inserts.get(path) ?? 0;\n\n      const result = insert(name, index + latestDestinationInserts, item);\n\n      if (result) {\n        inserts.set(path, latestDestinationInserts + 1);\n        return result;\n      }\n\n      i++;\n    }\n\n    return null;\n  };\n}\n\nexport type PasteCommand = ReturnType<typeof pasteManager>;\n\nexport { pasteManager };\n","function editorVariable<T extends string>(name: T): `--shopstory-editor-${T}` {\n  return `--shopstory-editor-${name}`;\n}\n\nconst BEFORE_ADD_BUTTON_DISPLAY = editorVariable(\"before-add-button-display\");\nconst BEFORE_ADD_BUTTON_TOP = editorVariable(\"before-add-button-top\");\nconst BEFORE_ADD_BUTTON_LEFT = editorVariable(\"before-add-button-left\");\n\nconst AFTER_ADD_BUTTON_DISPLAY = editorVariable(\"after-add-button-display\");\nconst AFTER_ADD_BUTTON_TOP = editorVariable(\"after-add-button-top\");\nconst AFTER_ADD_BUTTON_LEFT = editorVariable(\"after-add-button-left\");\n\nexport {\n  BEFORE_ADD_BUTTON_DISPLAY,\n  BEFORE_ADD_BUTTON_TOP,\n  BEFORE_ADD_BUTTON_LEFT,\n  AFTER_ADD_BUTTON_DISPLAY,\n  AFTER_ADD_BUTTON_TOP,\n  AFTER_ADD_BUTTON_LEFT,\n};\n","import React from \"react\";\nimport { styled, css } from \"styled-components\";\nimport { IconButton, ICON_BUTTON_SIZE } from \"../tinacms/styles\";\nimport {\n  AFTER_ADD_BUTTON_DISPLAY,\n  AFTER_ADD_BUTTON_LEFT,\n  AFTER_ADD_BUTTON_TOP,\n  BEFORE_ADD_BUTTON_DISPLAY,\n  BEFORE_ADD_BUTTON_LEFT,\n  BEFORE_ADD_BUTTON_TOP,\n} from \"./cssVariables\";\n\ninterface AddButtonProps {\n  position: \"before\" | \"after\";\n  index?: number;\n  offset?: number | { x: number; y: number };\n  onClick?: () => void;\n}\n\nfunction AddButton({ position, index, offset, onClick }: AddButtonProps) {\n  const [isOpen, setIsOpen] = React.useState(false);\n  const addBlockButtonRef = React.useRef<HTMLButtonElement>(null);\n\n  const handleOpenBlockMenu = (event: React.MouseEvent) => {\n    event.stopPropagation();\n    event.preventDefault();\n\n    // Custom add action\n    if (onClick) {\n      onClick();\n      return;\n    }\n  };\n\n  React.useEffect(() => {\n    const inactivateBlockMenu = () => setIsOpen(false);\n    document.addEventListener(\"mouseup\", inactivateBlockMenu, false);\n    return () => document.removeEventListener(\"mouseup\", inactivateBlockMenu);\n  }, []);\n\n  return (\n    <AddButtonWrapper\n      index={index}\n      offset={offset}\n      position={position}\n      isOpen={isOpen}\n    >\n      <AddIconButton\n        ref={addBlockButtonRef}\n        onClick={handleOpenBlockMenu}\n        isOpen={isOpen}\n        primary\n        small\n      >\n        <svg\n          xmlns=\"http://www.w3.org/2000/svg\"\n          width=\"18\"\n          height=\"18\"\n          viewBox=\"0 0 23 23\"\n          fill=\"none\"\n        >\n          <line x1=\"11.5\" y1=\"4\" x2=\"11.5\" y2=\"19\" stroke=\"currentColor\" />\n          <line x1=\"4\" y1=\"11.5\" x2=\"19\" y2=\"11.5\" stroke=\"currentColor\" />\n        </svg>\n      </AddIconButton>\n    </AddButtonWrapper>\n  );\n}\n\nexport { AddButton, ICON_BUTTON_SIZE as ADD_BUTTON_SIZE };\n\ninterface AddMenuProps {\n  isOpen?: boolean;\n  active?: boolean;\n  openTop?: boolean;\n}\n\nconst AddIconButton = styled(IconButton)<AddMenuProps>`\n  display: flex;\n  align-items: center;\n\n  &:focus {\n    outline: none !important;\n  }\n\n  ${(props) =>\n    props.isOpen &&\n    css`\n      pointer-events: none;\n    `};\n`;\n\ninterface AddButtonWrapperProps {\n  index?: number;\n  offset?: number | { x: number; y: number };\n  position: \"before\" | \"after\";\n  isOpen: boolean;\n}\n\nconst AddButtonWrapper = styled.div<AddButtonWrapperProps>`\n  position: absolute;\n\n  top: var(\n    ${({ position }) =>\n      position === \"before\" ? BEFORE_ADD_BUTTON_TOP : AFTER_ADD_BUTTON_TOP}\n  );\n  left: var(\n    ${({ position }) =>\n      position === \"before\" ? BEFORE_ADD_BUTTON_LEFT : AFTER_ADD_BUTTON_LEFT}\n  );\n\n  display: var(\n    ${({ position }) =>\n      position === \"before\"\n        ? BEFORE_ADD_BUTTON_DISPLAY\n        : AFTER_ADD_BUTTON_DISPLAY},\n    none\n  );\n\n  pointer-events: all;\n`;\n","import { styled } from \"styled-components\";\n\nconst Wrapper = styled.div`\n  position: absolute;\n  top: 0;\n  left: 0;\n  bottom: 0;\n  right: 0;\n  display: grid;\n  place-items: center;\n  pointer-events: none;\n`;\n\ntype FrameWrapperProps = {\n  width: number;\n  height: number;\n  transform: string;\n};\n\nconst FrameWrapper = styled.div.attrs<FrameWrapperProps>(\n  ({ width, height, transform }) => {\n    return {\n      style: {\n        width,\n        height,\n        transform,\n      },\n    };\n  }\n)`\n  position: relative;\n  z-index: 1;\n\n  display: grid;\n  place-items: center;\n\n  transform-origin: left;\n`;\n\nexport { Wrapper, FrameWrapper };\n","import type { EditingInfoBase } from \"@redsun-vn/easyblocks-core\";\nimport { ADD_BUTTON_SIZE } from \"./AddButton\";\n\nfunction calculateAddButtonsProperties(\n  direction: Required<EditingInfoBase>[\"direction\"],\n  targetElementRect: DOMRect,\n  viewport: {\n    width: number;\n    height: number;\n  },\n  containerElementRect?: DOMRect\n): {\n  before: { top: number; left: number; display: \"block\" | \"none\" };\n  after: { top: number; left: number; display: \"block\" | \"none\" };\n} {\n  const halfButtonSize = Math.floor(ADD_BUTTON_SIZE / 2);\n\n  if (direction === \"vertical\") {\n    const beforeButtonTopOffset = Math.floor(\n      targetElementRect.top - halfButtonSize\n    );\n    const afterButtonTopOffset = Math.floor(\n      targetElementRect.top + targetElementRect.height - halfButtonSize\n    );\n    const buttonsLeftOffset = Math.floor(\n      targetElementRect.left + targetElementRect.width / 2 - halfButtonSize\n    );\n\n    const isBeforeButtonWithinViewport = isButtonWithinViewport(\n      {\n        top: beforeButtonTopOffset + halfButtonSize,\n        left: buttonsLeftOffset + halfButtonSize,\n      },\n      viewport\n    );\n\n    const isAfterButtonWithinViewport = isButtonWithinViewport(\n      {\n        top: afterButtonTopOffset + halfButtonSize,\n        left: buttonsLeftOffset + halfButtonSize,\n      },\n      viewport\n    );\n\n    if (containerElementRect) {\n      return {\n        before: {\n          top: beforeButtonTopOffset,\n          left: buttonsLeftOffset,\n          display:\n            isBeforeButtonWithinViewport\n              ? \"block\"\n              : \"none\",\n        },\n        after: {\n          top: afterButtonTopOffset,\n          left: buttonsLeftOffset,\n          display:\n            isAfterButtonWithinViewport\n              ? \"block\"\n              : \"none\",\n        },\n      };\n    } else {\n      return {\n        before: {\n          top: beforeButtonTopOffset,\n          left: buttonsLeftOffset,\n          display: isBeforeButtonWithinViewport ? \"block\" : \"none\",\n        },\n        after: {\n          top: afterButtonTopOffset,\n          left: buttonsLeftOffset,\n          display: isAfterButtonWithinViewport ? \"block\" : \"none\",\n        },\n      };\n    }\n  } else {\n    const buttonsTopOffset = Math.floor(\n      targetElementRect.top + targetElementRect.height / 2 - halfButtonSize\n    );\n    const beforeButtonLeftOffset = Math.floor(\n      targetElementRect.left - halfButtonSize\n    );\n    const afterButtonLeftOffset = Math.floor(\n      targetElementRect.left + targetElementRect.width - halfButtonSize\n    );\n\n    const isBeforeButtonWithinViewport = isButtonWithinViewport(\n      {\n        top: buttonsTopOffset + halfButtonSize,\n        left: beforeButtonLeftOffset + halfButtonSize,\n      },\n      viewport\n    );\n    const isAfterButtonWithinViewport = isButtonWithinViewport(\n      {\n        top: buttonsTopOffset + halfButtonSize,\n        left: afterButtonLeftOffset + halfButtonSize,\n      },\n      viewport\n    );\n\n    if (containerElementRect) {\n      return {\n        before: {\n          top: buttonsTopOffset,\n          left: beforeButtonLeftOffset,\n          display: isBeforeButtonWithinViewport ? \"block\" : \"none\",\n        },\n        after: {\n          top: buttonsTopOffset,\n          left: afterButtonLeftOffset,\n          display: isAfterButtonWithinViewport ? \"block\" : \"none\",\n        },\n      };\n    } else {\n      return {\n        before: {\n          top: buttonsTopOffset,\n          left: beforeButtonLeftOffset,\n          display: isBeforeButtonWithinViewport ? \"block\" : \"none\",\n        },\n        after: {\n          top: buttonsTopOffset,\n          left: afterButtonLeftOffset,\n          display: isAfterButtonWithinViewport ? \"block\" : \"none\",\n        },\n      };\n    }\n  }\n}\n\nexport { calculateAddButtonsProperties };\n\nfunction isButtonWithinViewport(\n  target: { top: number; left: number },\n  viewport: { width: number; height: number }\n) {\n  return (\n    target.top >= 0 &&\n    target.top <= viewport.height &&\n    target.left >= 0 &&\n    target.left <= viewport.width\n  );\n}\n\nfunction isButtonWithinContainer(\n  target: { top: number; left: number },\n  container: DOMRect\n) {\n  return (\n    target.top >= container.top &&\n    target.top <= container.bottom &&\n    target.left >= container.left &&\n    target.left <= container.right\n  );\n}\n","import {\n  CompiledShopstoryComponentConfig,\n  EditingInfoBase,\n} from \"@redsun-vn/easyblocks-core\";\nimport {\n  SelectionFramePositionChangedEvent,\n  findComponentDefinitionById,\n  isSchemaPropCollection,\n  parsePath,\n} from \"@redsun-vn/easyblocks-core/_internals\";\nimport { dotNotationGet } from \"@/utils\";\nimport React, { useLayoutEffect } from \"react\";\nimport { EditorContextType, useEditorContext } from \"../EditorContext\";\nimport { pathToCompiledPath } from \"../pathToCompiledPath\";\nimport { AddButton } from \"./AddButton\";\nimport { FrameWrapper, Wrapper } from \"./SelectionFrame.styles\";\nimport { calculateAddButtonsProperties } from \"./calculateAddButtonProperties\";\nimport {\n  AFTER_ADD_BUTTON_DISPLAY,\n  AFTER_ADD_BUTTON_LEFT,\n  AFTER_ADD_BUTTON_TOP,\n  BEFORE_ADD_BUTTON_DISPLAY,\n  BEFORE_ADD_BUTTON_LEFT,\n  BEFORE_ADD_BUTTON_TOP,\n} from \"./cssVariables\";\nimport {\n  isConfigPathRichTextPart,\n  RICH_TEXT_PART_CONFIG_PATH_REGEXP,\n} from \"../utils/isConfigPathRichTextPart\";\n\ntype SelectionFrameProps = {\n  width: number;\n  height: number;\n  transform: string;\n};\n\nfunction SelectionFrame({ width, height, transform }: SelectionFrameProps) {\n  const editorContext = useEditorContext();\n  const { focussedField, form, actions } = editorContext;\n\n  const compiledFocusedField =\n    focussedField.length === 1\n      ? pathToCompiledPath(focussedField[0], editorContext)\n      : undefined;\n\n  const compiledComponentConfig: CompiledShopstoryComponentConfig =\n    compiledFocusedField\n      ? dotNotationGet(\n          editorContext.compiledComponentConfig,\n          compiledFocusedField\n        )\n      : undefined;\n\n  const { direction = \"vertical\" } = compiledComponentConfig?.__editing ?? {};\n\n  const isAddingEnabled = isAddingEnabledForSelectedFields(\n    focussedField,\n    editorContext\n  );\n\n  useLayoutEffect(() => {\n    if (focussedField.length === 0) {\n      hideAddButtons();\n    }\n  }, [focussedField]);\n\n  useLayoutEffect(() => {\n    function handleSelectionFrameMessages(\n      event: SelectionFramePositionChangedEvent\n    ) {\n      if (!isAddingEnabled) {\n        hideAddButtons();\n        return;\n      }\n\n      if (\n        event.data.type ===\n        \"@easyblocks-editor/selection-frame-position-changed\"\n      ) {\n        updateAddButtons(\n          direction,\n          event.data.payload.target,\n          {\n            width,\n            height,\n          },\n          event.data.payload.container\n        );\n      }\n    }\n\n    window.addEventListener(\"message\", handleSelectionFrameMessages);\n\n    return () => {\n      window.removeEventListener(\"message\", handleSelectionFrameMessages);\n    };\n  }, [direction, height, isAddingEnabled, width]);\n\n  async function handleAddButtonClick(which: \"before\" | \"after\") {\n    let path = focussedField.length === 1 ? focussedField[0] : undefined;\n\n    if (!path) {\n      return;\n    }\n\n    if (isConfigPathRichTextPart(path)) {\n      path = path.replace(RICH_TEXT_PART_CONFIG_PATH_REGEXP, \"\");\n    }\n\n    const { parent, index } = parsePath(path, form);\n\n    if (!parent || index === undefined) {\n      return;\n    }\n\n    const definition = findComponentDefinitionById(\n      parent.templateId,\n      editorContext\n    );\n\n    const schemaProp = definition?.schema.find(\n      (schemaProp) => schemaProp.prop === parent.fieldName\n    );\n\n    if (!schemaProp) {\n      return;\n    }\n\n    const parentPath =\n      parent.path + (parent.path === \"\" ? \"\" : \".\") + parent.fieldName;\n\n    const config = await actions.openComponentPicker({ path: parentPath });\n\n    if (config) {\n      actions.insertItem({\n        name:\n          schemaProp.type === \"component-collection-localised\"\n            ? `${parentPath}.${editorContext.contextParams.locale}`\n            : parentPath,\n        index: which === \"before\" ? index : index + 1,\n        block: config,\n      });\n    }\n  }\n\n  return (\n    <Wrapper>\n      <FrameWrapper width={width} height={height} transform={transform}>\n        <AddButton\n          position=\"before\"\n          onClick={() => handleAddButtonClick(\"before\")}\n        />\n        <AddButton\n          position=\"after\"\n          onClick={() => handleAddButtonClick(\"after\")}\n        />\n      </FrameWrapper>\n    </Wrapper>\n  );\n}\n\nexport { SelectionFrame };\n\nfunction updateAddButtons(\n  direction: Required<EditingInfoBase>[\"direction\"],\n  targetElementRect: DOMRect,\n  viewport: {\n    width: number;\n    height: number;\n  },\n  containerElementRect?: DOMRect\n) {\n  const { after, before } = calculateAddButtonsProperties(\n    direction,\n    targetElementRect,\n    viewport,\n    containerElementRect\n  );\n\n  setCssVariable(BEFORE_ADD_BUTTON_TOP, before.top + \"px\");\n  setCssVariable(BEFORE_ADD_BUTTON_LEFT, before.left + \"px\");\n  setCssVariable(AFTER_ADD_BUTTON_TOP, after.top + \"px\");\n  setCssVariable(AFTER_ADD_BUTTON_LEFT, after.left + \"px\");\n  setCssVariable(BEFORE_ADD_BUTTON_DISPLAY, before.display);\n  setCssVariable(AFTER_ADD_BUTTON_DISPLAY, after.display);\n}\n\nfunction hideAddButtons() {\n  setCssVariable(BEFORE_ADD_BUTTON_DISPLAY, \"none\");\n  setCssVariable(AFTER_ADD_BUTTON_DISPLAY, \"none\");\n}\n\nfunction setCssVariable(name: string, value: number | string) {\n  document.documentElement.style.setProperty(name, value.toString());\n}\n\nfunction isAddingEnabledForSelectedFields(\n  focusedFields: Array<string>,\n  editorContext: EditorContextType\n) {\n  if (focusedFields.length === 0) {\n    return false;\n  } else if (focusedFields.length === 1) {\n    if (isConfigPathRichTextPart(focusedFields[0])) {\n      return false;\n    }\n\n    const { parent } = parsePath(focusedFields[0], editorContext.form);\n\n    if (!parent) return false;\n\n    const parentDefinition = findComponentDefinitionById(\n      parent.templateId,\n      editorContext\n    );\n\n    const schemaProp = parentDefinition?.schema.find(\n      (schemaProp) => schemaProp.prop === parent.fieldName\n    );\n\n    if (!schemaProp) return false;\n\n    return isSchemaPropCollection(schemaProp);\n  } else {\n    return false;\n  }\n}\n","import {\n  NoCodeComponentEntry,\n  SchemaProp,\n  TrulyResponsiveValue,\n  isTrulyResponsiveValue,\n} from \"@redsun-vn/easyblocks-core\";\nimport {\n  CompilationContextType,\n  findComponentDefinition,\n} from \"@redsun-vn/easyblocks-core/_internals\";\n\n/**\n * Traverses recursively the config tree (similar to traverseConfig) but behaves like \"Array.map\". It returns new tree with elements mapped to new ones.\n * Responsive values are mapped \"per breakpoint\", it smells a bit, maybe in the future we'll have to apply some flag to have option whether we want to disassemble responsives or not.\n */\n\ntype ConfigMapCallback = (arg: {\n  value: any;\n  schemaProp: SchemaProp;\n  path: string;\n}) => any;\n\nfunction configMapArray(\n  configArray: NoCodeComponentEntry[] | undefined,\n  context: CompilationContextType,\n  callback: ConfigMapCallback,\n  prefix: string\n) {\n  /**\n   * Why this?\n   *\n   * Sometimes you might need configMap for config that have not yet been normalized. Such config still can be considered correct if it has a component that have a new schema property. Example of this is mergeSingleLocaleConfigsIntoConfig.\n   */\n  if (configArray === undefined) {\n    return;\n  }\n\n  if (!Array.isArray(configArray)) {\n    return;\n  }\n\n  return configArray.map((x, index) =>\n    configMapInternal(x, context, callback, `${prefix}.${index}`)\n  );\n}\n\nfunction configMap(\n  config: NoCodeComponentEntry,\n  context: CompilationContextType,\n  callback: ConfigMapCallback\n): NoCodeComponentEntry {\n  return configMapInternal(config, context, callback, \"\");\n}\n\nfunction configMapInternal(\n  config: NoCodeComponentEntry,\n  context: CompilationContextType,\n  callback: ConfigMapCallback,\n  prefix?: string\n): NoCodeComponentEntry {\n  const componentDefinition = findComponentDefinition(config, context);\n\n  const result: NoCodeComponentEntry = { ...config };\n\n  if (!componentDefinition) {\n    return result;\n  }\n\n  prefix = prefix === undefined || prefix === \"\" ? \"\" : `${prefix}.`;\n\n  componentDefinition.schema.forEach((schemaProp) => {\n    if (schemaProp.type === \"component-collection-localised\") {\n      if (config[schemaProp.prop] === undefined) {\n        return;\n      }\n\n      result[schemaProp.prop] = {};\n\n      for (const locale in config[schemaProp.prop]) {\n        if (locale === \"__fallback\") {\n          continue;\n        }\n\n        result[schemaProp.prop][locale] = configMapArray(\n          config[schemaProp.prop][locale],\n          context,\n          callback,\n          `${prefix}${schemaProp.prop}.${locale}`\n        );\n      }\n\n      result[schemaProp.prop] = callback({\n        value: result[schemaProp.prop],\n        path: `${prefix}${schemaProp.prop}`,\n        schemaProp,\n      });\n    } else if (\n      schemaProp.type === \"component\" ||\n      schemaProp.type === \"component-collection\"\n    ) {\n      result[schemaProp.prop] = configMapArray(\n        config[schemaProp.prop],\n        context,\n        callback,\n        `${prefix}${schemaProp.prop}`\n      );\n\n      result[schemaProp.prop] = callback({\n        value: result[schemaProp.prop],\n        path: `${prefix}${schemaProp.prop}`,\n        schemaProp,\n      });\n    } else {\n      if (isTrulyResponsiveValue(result[schemaProp.prop])) {\n        const mappedVal: TrulyResponsiveValue<any> = { $res: true };\n\n        for (const key in result[schemaProp.prop]) {\n          if (key === \"$res\") {\n            continue;\n          }\n          mappedVal[key] = callback({\n            value: result[schemaProp.prop][key],\n            schemaProp,\n            path: `${prefix}${schemaProp.prop}.${key}`,\n          });\n        }\n        result[schemaProp.prop] = mappedVal;\n      } else {\n        result[schemaProp.prop] = callback({\n          value: result[schemaProp.prop],\n          schemaProp,\n          path: `${prefix}${schemaProp.prop}`,\n        });\n      }\n    }\n  });\n\n  return result;\n}\n\nexport { configMap };\n","import {\n  buildRichTextNoCodeEntry,\n  NoCodeComponentEntry,\n  InternalTemplate,\n  Template,\n  UserDefinedTemplate,\n  getDefaultLocale,\n} from \"@redsun-vn/easyblocks-core\";\nimport {\n  InternalComponentDefinition,\n  findComponentDefinitionById,\n  normalize,\n} from \"@redsun-vn/easyblocks-core/_internals\";\nimport { uniqueId } from \"@/utils\";\nimport { EditorContextType } from \"../EditorContext\";\nimport { configMap } from \"../utils/config/configMap\";\n\nfunction getDefaultTemplateForDefinition(\n  def: InternalComponentDefinition,\n  editorContext: EditorContextType\n): InternalTemplate {\n  // Text has different way of building a default config\n  const config: NoCodeComponentEntry =\n    def.id === \"@easyblocks/rich-text\"\n      ? buildRichTextNoCodeEntry({\n          color: getDefaultTokenId(editorContext.theme.colors),\n          font: getDefaultTokenId(editorContext.theme.fonts),\n        })\n      : {\n          _component: def.id,\n          _id: uniqueId(),\n        };\n\n  return {\n    id: `${def.id}_default`,\n    label: def.label ?? def.id,\n    entry: config,\n    isUserDefined: false,\n  };\n}\n\nfunction getDefaultTokenId(tokens: EditorContextType[\"theme\"][string]) {\n  return Object.entries(tokens).find(([, value]) => value.isDefault)?.[0];\n}\n\nexport async function getTemplates(\n  editorContext: EditorContextType,\n  configTemplates: InternalTemplate[] = []\n): Promise<Template[]> {\n  const remoteUserDefinedTemplates: UserDefinedTemplate[] =\n    !editorContext.disableCustomTemplates\n      ? await editorContext.backend.templates.getAll()\n      : [];\n\n  return getTemplatesInternal(\n    editorContext,\n    configTemplates,\n    remoteUserDefinedTemplates\n  );\n}\n\nfunction getNecessaryDefaultTemplates(\n  components: InternalComponentDefinition[],\n  templates: Template[],\n  editorContext: EditorContextType\n) {\n  const result: InternalTemplate[] = [];\n\n  components.forEach((component) => {\n    const componentTemplates = templates.filter(\n      (template) => template.entry._component === component.id\n    );\n    if (componentTemplates.length === 0) {\n      result.push(getDefaultTemplateForDefinition(component, editorContext));\n    }\n  });\n\n  return result;\n}\n\nfunction normalizeTextLocales(\n  config: NoCodeComponentEntry,\n  editorContext: EditorContextType\n) {\n  return configMap(config, editorContext, ({ value, schemaProp }) => {\n    if (schemaProp.type === \"text\") {\n      const firstDefinedValue = Object.values(value.value).filter(\n        (x) => x !== null && x !== undefined\n      )[0];\n\n      return {\n        ...value,\n        value: {\n          [getDefaultLocale(editorContext.locales).code]: firstDefinedValue,\n        },\n      };\n    } else if (schemaProp.type === \"component-collection-localised\") {\n      const firstDefinedValue = Object.values(value).filter(\n        (x) => x !== null && x !== undefined\n      )[0];\n\n      return {\n        [getDefaultLocale(editorContext.locales).code]: firstDefinedValue,\n      };\n    }\n\n    return value;\n  });\n}\n\nfunction getTemplatesInternal(\n  editorContext: EditorContextType,\n  configTemplates: InternalTemplate[],\n  remoteUserDefinedTemplates: UserDefinedTemplate[]\n): Template[] {\n  // If a component doesn't have a template, here's one added\n  const allBuiltinTemplates = [\n    ...configTemplates,\n    ...getNecessaryDefaultTemplates(\n      editorContext.definitions.components,\n      configTemplates,\n      editorContext\n    ),\n  ];\n\n  const allUserTemplates = [\n    ...remoteUserDefinedTemplates,\n    ...allBuiltinTemplates,\n  ];\n\n  const result = allUserTemplates\n    .filter((template) => {\n      const definition = findComponentDefinitionById(\n        template.entry._component,\n        editorContext\n      );\n\n      if (!definition || definition.hideTemplates) {\n        return false;\n      }\n\n      return true;\n    })\n    .map((template) => {\n      const newTemplate: Template = {\n        ...template,\n        entry: normalizeTextLocales(\n          normalize({ ...template.entry, _itemProps: {} }, editorContext),\n          editorContext\n        ),\n      };\n\n      return newTemplate;\n    });\n\n  return result;\n}\n","import {\n  InternalAnyField,\n  InternalField,\n} from \"@redsun-vn/easyblocks-core/_internals\";\nimport { dotNotationGet } from \"@/utils\";\nimport { Config, FORM_ERROR, FormApi, FormState, createForm } from \"final-form\";\nimport arrayMutators from \"final-form-arrays\";\n\nexport interface FormOptions<S, F extends InternalField = InternalAnyField>\n  extends Config<S> {\n  id: any;\n  label: string;\n  fields?: F[];\n  __type?: string;\n  reset?(): void;\n  actions?: any[];\n  buttons?: {\n    save: string;\n    reset: string;\n  };\n  loadInitialValues?: () => Promise<S>;\n  onChange?(values: FormState<S>): void;\n}\n\nexport class Form<\n  S extends Record<string, any> = any,\n  F extends InternalField = InternalAnyField\n> {\n  private _reset?(): void;\n\n  __type: string;\n  id: any;\n  label: string;\n  fields: F[];\n  finalForm: FormApi<S>;\n  actions: any[];\n  buttons: {\n    save: string;\n    reset: string;\n  };\n  loading = false;\n\n  constructor({\n    id,\n    label,\n    fields,\n    actions,\n    buttons,\n    reset,\n    loadInitialValues,\n    onChange,\n    ...options\n  }: FormOptions<S, F>) {\n    const initialValues = options.initialValues || ({} as S);\n    this.__type = options.__type || \"form\";\n    this.id = id;\n    this.label = label;\n    this.fields = fields || [];\n    this.onSubmit = options.onSubmit;\n    this.finalForm = createForm<S>({\n      ...options,\n      initialValues,\n      onSubmit: this.handleSubmit,\n      mutators: {\n        ...arrayMutators,\n        ...options.mutators,\n      },\n    });\n\n    this._reset = reset;\n    this.actions = actions || [];\n    this.buttons = buttons || {\n      save: \"Save\",\n      reset: \"Reset\",\n    };\n    this.updateFields(this.fields);\n\n    if (loadInitialValues) {\n      this.loading = true;\n      loadInitialValues()\n        .then((initialValues) => {\n          this.updateInitialValues(initialValues);\n        })\n        .finally(() => {\n          this.loading = false;\n        });\n    }\n\n    if (onChange) {\n      let firstUpdate = true;\n      this.subscribe(\n        (formState) => {\n          if (firstUpdate) {\n            firstUpdate = false;\n          } else {\n            onChange(formState);\n          }\n        },\n        { values: true }\n      );\n    }\n  }\n\n  /**\n   * Returns the current values of the form.\n   *\n   * if the form is still loading it returns `undefined`.\n   */\n  get values(): S | undefined {\n    if (this.loading) {\n      return undefined;\n    }\n    return this.finalForm.getState().values || (this.initialValues as S);\n  }\n\n  /**\n   * The values the form was initialized with.\n   */\n  get initialValues() {\n    return this.finalForm.getState().initialValues;\n  }\n\n  /**\n   * @deprecated Unnecessary indirection\n   */\n  updateFields(fields: F[]) {\n    this.fields = fields;\n  }\n\n  /**\n   * Subscribes to changes to the form. The subscriber will only be called when\n   * values specified in subscription change. A form can have many subscribers.\n   */\n  subscribe: FormApi<S>[\"subscribe\"] = (cb, options) => {\n    return this.finalForm.subscribe(cb, options);\n  };\n\n  onSubmit: Config<S>[\"onSubmit\"];\n\n  private handleSubmit: Config<S>[\"onSubmit\"] = async (values, form, cb) => {\n    try {\n      const response = await this.onSubmit(values, form, cb);\n      form.initialize(values);\n      return response;\n    } catch (error) {\n      return { [FORM_ERROR]: error };\n    }\n  };\n\n  /**\n   * Changes the value of the given field.\n   *\n   * @param name\n   * @param value\n   */\n  change(name: string, value?: any) {\n    if (process.env.NODE_ENV === \"development\") {\n      console.groupCollapsed(\"Change to\", name === \"\" ? '\"\"' : `\"${name}\"`);\n      console.log(\"Old config\", this.values);\n      console.log(\"Old value\", dotNotationGet(this.values, name));\n      this.finalForm.change(name as keyof S, value);\n      console.log(\"New config\", this.values);\n      console.log(\"New value\", value);\n      console.groupEnd();\n      return;\n    }\n\n    return this.finalForm.change(name as keyof S, value);\n  }\n\n  get mutators() {\n    return this.finalForm.mutators;\n  }\n\n  /**\n   * Updates multiple fields in the form.\n   *\n   * The updates are batched so that it only triggers one `onChange` event.\n   *\n   * In order to prevent disruptions to the user's editing experience this\n   * function will _not_ update the value of any field that is currently\n   * being edited.\n   *\n   * @param values\n   */\n  updateValues(values: S) {\n    this.finalForm.batch(() => {\n      const activePath: any = this.finalForm.getState().active;\n\n      if (!activePath) {\n        updateEverything<S>(this.finalForm, values);\n      } else {\n        updateSelectively<S>(this.finalForm, values);\n      }\n    });\n  }\n\n  /**\n   * Replaces the initialValues of the form without deleting the current values.\n   *\n   * This function is helpful when the initialValues are loaded asynchronously.\n   *\n   * @param initialValues\n   */\n  updateInitialValues(initialValues: S) {\n    this.finalForm.batch(() => {\n      const values = this.values || ({} as S);\n      this.finalForm.initialize(initialValues);\n      const activePath: any = this.finalForm.getState().active;\n\n      if (!activePath) {\n        updateEverything<S>(this.finalForm, values);\n      } else {\n        updateSelectively<S>(this.finalForm, values);\n      }\n    });\n  }\n}\n\nfunction updateEverything<S extends Record<string, any>>(\n  form: FormApi<any>,\n  values: S\n) {\n  Object.entries(values).forEach(([path, value]) => {\n    form.change(path, value);\n  });\n}\n\nfunction updateSelectively<S extends Record<string, any>>(\n  form: FormApi<any>,\n  values: S,\n  prefix?: string\n) {\n  const activePath: any = form.getState().active!;\n\n  Object.entries(values).forEach(([name, value]) => {\n    const path = prefix ? `${prefix}.${name}` : name;\n\n    if (typeof value === \"object\") {\n      if (activePath.startsWith(path)) {\n        updateSelectively(form, value, path);\n      } else {\n        form.change(path, value);\n      }\n    } else if (path !== activePath) {\n      form.change(path, value);\n    }\n  });\n}\n","import { InternalField } from \"@redsun-vn/easyblocks-core/_internals\";\nimport React from \"react\";\nimport { Form, FormOptions } from \"../../form\";\n\ninterface WatchableFormValue {\n  values: any;\n  label: FormOptions<any>[\"label\"];\n  fields: FormOptions<any>[\"fields\"];\n}\n\n/**\n * A hook that creates a form and updates it's watched properties.\n */\nexport function useForm<FormShape = any>(\n  { loadInitialValues, ...options }: FormOptions<any>,\n  watch: Partial<WatchableFormValue> = {}\n): [FormShape, Form, boolean] {\n  /**\n   * `initialValues` will be usually be undefined if `loadInitialValues` is used.\n   *\n   * If the form helper is using `watch.values`, which would contain\n   * the current state of the form, then we set that to the `initialValues`\n   * so the form is initialized with some state.\n   *\n   * This is beneficial for SSR and will hopefully not be noticeable\n   * when editing the site as the actual `initialValues` will be set\n   * behind the scenes.\n   */\n  options.initialValues = options.initialValues || watch.values;\n\n  const [, setValues] = React.useState(options.initialValues);\n  const [form, setForm] = React.useState<Form>(() => {\n    return createForm(options, (form: any) => {\n      setValues(form.values);\n    });\n  });\n\n  React.useEffect(\n    function () {\n      if (form.id === options.id) return;\n      setForm(\n        createForm(options, (form: any) => {\n          setValues(form.values);\n        })\n      );\n    },\n    [options.id]\n  );\n\n  const [formIsLoading, setFormIsLoading] = React.useState(() =>\n    loadInitialValues ? true : false\n  );\n  const loadFormData = React.useCallback(async () => {\n    if (loadInitialValues) {\n      setFormIsLoading(true);\n      await loadInitialValues()\n        .then((values: any) => {\n          form.updateInitialValues(values);\n        })\n        .finally(() => {\n          setFormIsLoading(false);\n        });\n    }\n  }, [form, setFormIsLoading]);\n  React.useEffect(() => {\n    loadFormData();\n  }, [form, loadFormData]);\n\n  useUpdateFormFields(form, watch.fields);\n  useUpdateFormLabel(form, watch.label);\n  useUpdateFormValues(form, watch.values);\n\n  return [form ? form.values : options.initialValues, form, formIsLoading];\n}\n\nfunction createForm(options: FormOptions<any>, handleChange: any): Form {\n  const form = new Form(options);\n  form.subscribe(handleChange, { values: true });\n  return form;\n}\n\n/**\n * A React Hook that update's the `Form` if `fields` are changed.\n *\n * This hook is useful when dynamically creating fields, or updating\n * them via hot module replacement.\n */\nfunction useUpdateFormFields(form: Form, fields?: InternalField[]) {\n  React.useEffect(() => {\n    if (typeof fields === \"undefined\") return;\n    form.updateFields(fields);\n  }, [form, fields]);\n}\n\n/**\n * A React Hook that update's the `Form` if the `label` is changed.\n *\n * This hook is useful when dynamically creating creating the label,\n * or updating it via hot module replacement.\n */\nfunction useUpdateFormLabel(form: Form, label?: string) {\n  React.useEffect(() => {\n    if (typeof label === \"undefined\") return;\n    form.label = label;\n  }, [form, label]);\n}\n\n/**\n * Updates the Form with new values.\n *\n * Only updates fields that are:\n *\n * 1. registered with the form\n * 2. not currently [active](https://final-form.org/docs/final-form/types/FieldState#active)\n *\n * This hook is useful when the form must be kept in sync with the data source.\n */\nfunction useUpdateFormValues(form: Form, values?: any) {\n  React.useEffect(() => {\n    if (typeof values === \"undefined\") return;\n    form.updateValues(values);\n  }, [form, values]);\n}\n","import { NoCodeComponentEntry } from \"@redsun-vn/easyblocks-core\";\nimport { deepClone } from \"@/utils\";\n\n/**\n * Outputs comparable config that is FULL COPY of config\n */\nfunction getConfigSnapshot(config: NoCodeComponentEntry): NoCodeComponentEntry {\n  const strippedConfig = deepClone(config);\n  return strippedConfig;\n}\nexport { getConfigSnapshot };\n","import { NoCodeComponentEntry } from \"@redsun-vn/easyblocks-core\";\nimport { CompilationContextType } from \"@redsun-vn/easyblocks-core/_internals\";\nimport { configMap } from \"../config/configMap\";\n\nexport function addLocalizedFlag(\n  config: NoCodeComponentEntry,\n  context: CompilationContextType\n) {\n  return configMap(config, context, ({ value, schemaProp }) => {\n    if (\n      (schemaProp.type === \"text\" && value.id?.startsWith(\"local.\")) ||\n      schemaProp.type === \"component-collection-localised\"\n    ) {\n      return {\n        __localized: true,\n        ...value,\n      };\n    }\n\n    return value;\n  });\n}\n","import { NoCodeComponentEntry } from \"@redsun-vn/easyblocks-core\";\nimport { CompilationContextType } from \"@redsun-vn/easyblocks-core/_internals\";\nimport { configMap } from \"../config/configMap\";\n\nexport function removeLocalizedFlag(\n  config: NoCodeComponentEntry,\n  context: CompilationContextType\n) {\n  return configMap(config, context, ({ value, schemaProp }) => {\n    if (\n      (schemaProp.type === \"text\" && value?.id.startsWith(\"local.\")) ||\n      schemaProp.type === \"component-collection-localised\"\n    ) {\n      delete value.__localized;\n    }\n\n    return value;\n  });\n}\n","import { NoCodeComponentEntry, Document } from \"@redsun-vn/easyblocks-core\";\nimport { deepClone, deepCompare, sleep } from \"@/utils\";\nimport { useEffect, useRef, useState } from \"react\";\nimport { EditorContextType } from \"./EditorContext\";\nimport { getConfigSnapshot } from \"./utils/config/getConfigSnapshot\";\nimport { addLocalizedFlag } from \"./utils/locales/addLocalizedFlag\";\nimport { removeLocalizedFlag } from \"./utils/locales/removeLocalizedFlag\";\nimport { useToaster, Toaster } from \"@redsun-vn/easyblocks-design-system\";\n\n/**\n * useDataSaver works in a realm of SINGLE CONFIG.\n * @param initialDocument\n * Data saver will use this document as a starting point. It can be `null` if there is no document yet.\n * Data saver will perform first save when any local change is detected.\n */\nexport function useDataSaver(\n  initialDocument: Document | null,\n  editorContext: EditorContextType\n) {\n  const remoteDocument = useRef<Document | null>(initialDocument);\n  const toaster = useToaster();\n\n  /**\n   * This state variable is going to be used ONLY for comparison with local config in case of missing document.\n   * It's not going to change at any time during the lifecycle of this hook.\n   */\n  const [initialConfigInCaseOfMissingDocument] = useState<NoCodeComponentEntry>(\n    deepClone(editorContext.form.values)\n  );\n  const onTickRef = useRef<() => Promise<void>>(() => Promise.resolve());\n\n  const onTick = async () => {\n    // Playground mode is a special case, we don't want to save anything\n    if (editorContext.readOnly) {\n      return;\n    }\n\n    const localConfig = editorContext.form.values;\n    const localConfigSnapshot = getConfigSnapshot(localConfig);\n\n    const previousConfig = remoteDocument.current\n      ? remoteDocument.current.entry\n      : initialConfigInCaseOfMissingDocument;\n    const previousConfigSnapshot = getConfigSnapshot(previousConfig);\n\n    const isConfigTheSame = deepCompare(\n      localConfigSnapshot,\n      previousConfigSnapshot\n    );\n\n    const configToSaveWithLocalisedFlag = addLocalizedFlag(\n      localConfigSnapshot,\n      editorContext\n    );\n\n    async function runSaveCallback() {\n      await editorContext.save(remoteDocument.current!);\n    }\n\n    // New document\n    if (remoteDocument.current === null) {\n      console.debug(\"New document\");\n\n      // There must be at least one change in order to create a new document, we're not storing empty temporary documents\n      if (isConfigTheSame) {\n        console.debug(\"no change -> bye\");\n        return;\n      }\n\n      console.debug(\"change detected! -> create\");\n\n      const newDocument = await editorContext.backend.documents.create({\n        entry: configToSaveWithLocalisedFlag,\n      });\n\n      remoteDocument.current = {\n        ...newDocument,\n        // @ts-ignore\n        config: {\n          config: configToSaveWithLocalisedFlag,\n        },\n      };\n\n      await runSaveCallback();\n    }\n    // Document update\n    else {\n      console.debug(\"Existing document\");\n\n      try {\n        const latestDocument = await editorContext.backend.documents.get({\n          id: remoteDocument.current.id,\n        });\n        const latestRemoteDocumentVersion = latestDocument.version ?? -1;\n\n        const isNewerDocumentVersionAvailable =\n          remoteDocument.current.version < latestRemoteDocumentVersion;\n\n        // Newer version of document is available\n        if (isNewerDocumentVersionAvailable) {\n          console.debug(\"new remote version detected, updating\");\n\n          if (!latestDocument) {\n            throw new Error(\"unexpected error\");\n          }\n\n          const latestConfig = removeLocalizedFlag(\n            latestDocument.entry,\n            editorContext\n          );\n\n          editorContext.actions.runChange(() => {\n            editorContext.form.change(\"\", latestConfig);\n            return [];\n          });\n\n          remoteDocument.current = latestDocument;\n\n          // Notify when local config was modified\n          if (!isConfigTheSame) {\n            console.debug(\"there were local changes -> notify\");\n\n            editorContext.actions.notify(\n              \"Remote changes detected, local changes have been overwritten.\"\n            );\n          }\n\n          return;\n        }\n        // No remote change occurred\n        else {\n          if (isConfigTheSame) {\n            console.debug(\"no local changes -> bye\");\n            // Let's do nothing, no remote and local change\n          } else {\n            console.debug(\"updating the document\", remoteDocument.current.id);\n\n            const updatedDocument =\n              await editorContext.backend.documents.update({\n                id: remoteDocument.current.id,\n                entry: configToSaveWithLocalisedFlag,\n                version: remoteDocument.current.version,\n              });\n\n            if (updatedDocument?.id) {\n              toaster.success(\"Saved.\");\n            } else {\n              toaster.error(\"Error saving... Please try again.\");\n            }\n\n            remoteDocument.current.entry = localConfigSnapshot;\n            remoteDocument.current.version = updatedDocument.version;\n\n            await runSaveCallback();\n          }\n        }\n      } catch (error) {\n        toaster.error(\"Error saving... Please try again!\");\n      }\n    }\n  };\n\n  // We're keeping this in ref, because of setInterval keeping initial closure\n  onTickRef.current = onTick;\n\n  const inProgress = useRef<boolean>(false);\n  const wasSaveNowCalled = useRef<boolean>(false);\n\n  useEffect(() => {\n    const interval = setInterval(() => {\n      // We ignore ticks when previous requests are in progress\n      if (inProgress.current || wasSaveNowCalled.current) {\n        return;\n      }\n\n      inProgress.current = true;\n      onTickRef.current().finally(() => {\n        inProgress.current = false;\n      });\n    }, 5000);\n\n    return () => {\n      clearInterval(interval);\n    };\n  }, []);\n\n  return {\n    saveNow: async () => {\n      wasSaveNowCalled.current = true;\n\n      // Wait until inProgress is false\n      while (true) {\n        if (inProgress.current) {\n          console.debug(\"waiting...\");\n          await sleep(500);\n        } else {\n          break;\n        }\n      }\n\n      console.debug(\"Last save!\");\n      await onTick();\n    }\n  };\n}\n","import {\n  EditorContextType,\n  duplicateConfig,\n} from \"@redsun-vn/easyblocks-core/_internals\";\nimport { dotNotationGet, preOrderPathComparator } from \"@/utils\";\nimport { useEffect } from \"react\";\n\nconst GLOBAL_SHORTCUTS_KEYS = [\n  \"Delete\",\n  \"Backspace\",\n  \"ArrowUp\",\n  \"ArrowDown\",\n  \"ArrowLeft\",\n  \"ArrowRight\",\n  \"l\",\n  \"L\",\n];\n\nconst DATA_TRANSFER_FORMAT = \"text/x-shopstory\";\n\nfunction useEditorGlobalKeyboardShortcuts(editorContext: EditorContextType) {\n  let isDeleting = false;\n  useEffect(() => {\n    const { focussedField: focusedFields, actions } = editorContext;\n\n    function handleKeydown(event: KeyboardEvent): void {\n      if (isTargetInputElement(event.target)) {\n        return;\n      }\n\n      if (!isGlobalShortcut(event) || !isAnyFieldSelected(focusedFields)) {\n        return;\n      }\n\n      if (\n        (event.key === \"Delete\" || event.key === \"Backspace\") &&\n        !isDeleting\n      ) {\n        isDeleting = true;\n\n        actions.removeItems(focusedFields);\n\n        setTimeout(() => {\n          isDeleting = false;\n        }, 2000);\n      } else if (event.key === \"ArrowUp\" || event.key === \"ArrowLeft\") {\n        actions.moveItems(focusedFields, \"top\");\n      } else if (event.key === \"ArrowDown\" || event.key === \"ArrowRight\") {\n        actions.moveItems(focusedFields, \"bottom\");\n      } else if (event.key.toUpperCase() === \"L\") {\n        actions.logSelectedItems();\n      }\n    }\n\n    function handleCopy(event: ClipboardEvent): void {\n      if (!canHandleCopyPaste(focusedFields, event)) {\n        return;\n      }\n\n      const configs = getConfigsToCopy(focusedFields, editorContext);\n\n      event.preventDefault();\n      event.clipboardData?.setData(\n        DATA_TRANSFER_FORMAT,\n        JSON.stringify(configs)\n      );\n    }\n\n    function handleCut(event: ClipboardEvent): void {\n      if (!canHandleCopyPaste(focusedFields, event)) {\n        return;\n      }\n\n      const configs = getConfigsToCopy(focusedFields, editorContext);\n\n      event.preventDefault();\n      event.clipboardData?.setData(\n        DATA_TRANSFER_FORMAT,\n        JSON.stringify(configs)\n      );\n\n      actions.removeItems(focusedFields);\n    }\n\n    function handlePaste(event: ClipboardEvent): void {\n      if (!canHandleCopyPaste(focusedFields, event)) {\n        return;\n      }\n\n      const rawData = event.clipboardData?.getData(DATA_TRANSFER_FORMAT);\n\n      if (!rawData || rawData === \"\") {\n        return;\n      }\n\n      try {\n        const parsedData = JSON.parse(rawData);\n\n        const data = Array.isArray(parsedData) ? parsedData : [parsedData];\n\n        actions.pasteItems(data);\n        event.preventDefault();\n      } catch (e) {\n        console.error(e);\n        return;\n      }\n    }\n\n    window.document.addEventListener(\"keydown\", handleKeydown);\n    window.document.addEventListener(\"copy\", handleCopy);\n    window.document.addEventListener(\"cut\", handleCut);\n    window.document.addEventListener(\"paste\", handlePaste);\n\n    return () => {\n      window.document.removeEventListener(\"keydown\", handleKeydown);\n      window.document.removeEventListener(\"copy\", handleCopy);\n      window.document.removeEventListener(\"cut\", handleCut);\n      window.document.removeEventListener(\"paste\", handlePaste);\n    };\n  });\n}\n\nfunction isTargetInputElement(target: EventTarget | null): boolean {\n  return (\n    isTargetHtmlElement(target) &&\n    ([\"INPUT\", \"TEXTAREA\", \"SELECT\"].includes(target.tagName) ||\n      (target.tagName === \"DIV\" && target.getAttribute(\"role\") === \"textbox\"))\n  );\n}\n\nfunction isTargetHtmlElement(\n  element: EventTarget | null\n): element is HTMLElement {\n  return element !== null;\n}\n\nfunction getConfigsToCopy(paths: string[], editorContext: EditorContextType) {\n  const sortedPaths = [...paths].sort(preOrderPathComparator(\"ascending\"));\n  return sortedPaths.map((path) => {\n    const config = dotNotationGet(editorContext.form.values, path);\n    return duplicateConfig(config, editorContext);\n  });\n}\n\nfunction canHandleCopyPaste(focusedFields: string[], event: ClipboardEvent) {\n  const notInsideInputElement = !(\n    isTargetInputElement(event.target) ||\n    isTargetInputElement(document.activeElement)\n  );\n\n  const insideEditorIFrame = window.frameElement;\n  const focusedFieldsSelected = isAnyFieldSelected(focusedFields);\n\n  return notInsideInputElement && insideEditorIFrame && focusedFieldsSelected;\n}\n\nfunction isGlobalShortcut(event: KeyboardEvent): boolean {\n  return GLOBAL_SHORTCUTS_KEYS.includes(event.key);\n}\n\n// FIXME: This is my mistake, because I was lazy at the beginning and it was easier for me to introduce changes\n// by assuming that non empty array with empty string means no fields selected.\n// IMO this is stupid and can lead to confusion.\nfunction isAnyFieldSelected(focusedFields: string[]) {\n  return focusedFields.length > 0 && focusedFields[0] !== \"\";\n}\n\nexport { useEditorGlobalKeyboardShortcuts };\n","import { NoCodeComponentEntry } from \"@redsun-vn/easyblocks-core\";\nimport { deepCompare } from \"@/utils\";\n\nconst HISTORY_SIZE = 50;\n\nexport interface HistoryEntry {\n  focussedField: Array<string>;\n  config: NoCodeComponentEntry;\n}\n\nclass EditorHistory {\n  private values: HistoryEntry[];\n  private currentIndex: number;\n\n  constructor() {\n    this.values = [];\n    this.currentIndex = -1;\n  }\n\n  push(value: HistoryEntry) {\n    const isCurrentIndexLastEntry =\n      this.values.length - 1 === this.currentIndex;\n\n    // If we push to history while `currentIndex` is not set on latest history entry\n    // our history would me messed up. We need to rewrite our history by removing all\n    // entries after the current index.\n    if (!isCurrentIndexLastEntry) {\n      this.values.splice(\n        this.currentIndex + 1,\n        this.values.length - 1 - this.currentIndex\n      );\n    }\n\n    const isAboutToReachSizeLimit = this.values.length + 1 > HISTORY_SIZE;\n\n    if (isAboutToReachSizeLimit) {\n      this.values.shift();\n    }\n\n    this.values.push(value);\n    this.currentIndex = this.values.length - 1;\n  }\n\n  replace(value: HistoryEntry) {\n    this.values[this.currentIndex] = value;\n  }\n\n  replaceAt(oldValue: HistoryEntry, newValue: HistoryEntry) {\n    const entryIndex = this.values.findIndex(\n      (value) => value.config === oldValue.config\n    );\n\n    if (entryIndex !== -1) {\n      this.values[entryIndex] = newValue;\n    }\n  }\n\n  forward() {\n    if (!this.canGoForward()) {\n      this.currentIndex = this.values.length - 1;\n      return null;\n    }\n\n    const currentEntry = this.values[this.currentIndex];\n\n    while (this.canGoForward()) {\n      this.currentIndex += 1;\n      const nextEntry = this.values[this.currentIndex];\n\n      if (!deepCompare(nextEntry.config, currentEntry.config)) {\n        return nextEntry;\n      }\n    }\n\n    return null;\n  }\n\n  back() {\n    if (!this.canGoBack()) {\n      return null;\n    }\n\n    const currentEntry = this.values[this.currentIndex];\n\n    while (this.canGoBack()) {\n      this.currentIndex -= 1;\n      const previousEntry = this.values[this.currentIndex];\n\n      if (!deepCompare(previousEntry.config, currentEntry.config)) {\n        return previousEntry;\n      }\n    }\n\n    return null;\n  }\n\n  getEntries(): Array<HistoryEntry> {\n    return this.values.map((value) => ({\n      ...value,\n    }));\n  }\n\n  private canGoForward() {\n    return this.currentIndex < this.values.length - 1;\n  }\n\n  private canGoBack() {\n    return this.currentIndex > 0;\n  }\n}\n\nexport { EditorHistory };\n","import type { NoCodeComponentEntry } from \"@redsun-vn/easyblocks-core\";\nimport { useRef } from \"react\";\nimport ReactDOM from \"react-dom\";\nimport { EditorHistory, HistoryEntry } from \"./EditorHistory\";\n\ninterface UseEditorHistoryParameters {\n  onChange: (editorHistoryChange: EditorHistoryChange) => void;\n}\n\ninterface EditorHistoryChange {\n  config?: NoCodeComponentEntry;\n  focusedField: Array<string>;\n  type: \"undo\" | \"redo\";\n}\n\nfunction useEditorHistory({ onChange }: UseEditorHistoryParameters) {\n  const editorHistory = useRef<EditorHistory>(new EditorHistory()).current;\n\n  function undo(): void {\n    ReactDOM.unstable_batchedUpdates(() => {\n      const entry = editorHistory.back();\n\n      if (entry === null) {\n        return;\n      }\n\n      const { focussedField, ...rest } = entry;\n      onChange({\n        focusedField: focussedField,\n        ...rest,\n        type: \"undo\",\n      });\n    });\n  }\n\n  function redo() {\n    ReactDOM.unstable_batchedUpdates(() => {\n      const entry = editorHistory.forward();\n\n      if (!entry) {\n        return null;\n      }\n\n      const { focussedField, ...rest } = entry;\n\n      onChange({\n        focusedField: focussedField,\n        ...rest,\n        type: \"redo\",\n      });\n    });\n  }\n\n  function push(entry: HistoryEntry) {\n    editorHistory.push(entry);\n  }\n\n  return {\n    push,\n    redo,\n    undo,\n    editorHistoryInstance: editorHistory,\n  };\n}\n\nexport { useEditorHistory };\n","import { getDefaultLocale, Locale } from \"@redsun-vn/easyblocks-core\";\n\nexport function checkLocalesCorrectness(locales: Locale[]): boolean {\n  if (locales.length === 0) {\n    throw new Error(\"Locales array can't be empty\");\n  }\n\n  const defaultLocales = locales.filter((l) => l.isDefault);\n  if (defaultLocales.length === 0) {\n    throw new Error(\"One locale must be set as default, you didn't set any\");\n  }\n\n  if (defaultLocales.length > 1) {\n    throw new Error(\n      \"Only one locale must be set as default, you set more than one\"\n    );\n  }\n\n  const defaultLocale = defaultLocales[0];\n\n  if (defaultLocale.fallback) {\n    throw new Error(\"Default locale can't have fallback\");\n  }\n\n  // Check for incorrect fallbacks\n  locales.forEach((locale) => {\n    if (locale.fallback) {\n      const fallback = locales.find((x) => x.code === locale.fallback);\n\n      if (!fallback) {\n        throw new Error(\n          `Locale ${locale} has a fallback ${locale.fallback} which doesn't exist in the locales list.`\n        );\n      }\n    }\n    // If there is no fallback, then we treat default locale as a fallback!\n  });\n\n  // Let's check for circulars\n  locales.forEach((locale) => {\n    const localeChain: string[] = [];\n\n    let currentLocale = locale;\n\n    do {\n      localeChain.push(currentLocale.code);\n      const fallbackId =\n        currentLocale.fallback ?? getDefaultLocale(locales).code;\n\n      // If we got to the default locale then we're fine\n      if (fallbackId === getDefaultLocale(locales).code) {\n        break;\n      }\n\n      // If fallbackId does already exists in localeChain then it means we have circular!\n      if (localeChain.includes(fallbackId)) {\n        throw new Error(\n          `There is circular reference in locales: ${[\n            ...localeChain,\n            fallbackId,\n          ].join(\",\")}`\n        );\n      }\n\n      currentLocale = locales.find((x) => x.code === fallbackId)!;\n    } while (true);\n  });\n\n  return true;\n}\n","import { dotNotationGet, sleep, uniqueId, useForceRerender } from \"@/utils\";\nimport {\n  CompilationCache,\n  CompilationMetadata,\n  Config,\n  DeviceRange,\n  Document,\n  ExternalData,\n  FetchOutputResources,\n  InlineTypeWidgetComponentProps,\n  NoCodeComponentEntry,\n  NonEmptyRenderableContent,\n  Template,\n  TokenTypeWidgetComponentProps,\n  UserDefinedTemplate,\n  WidgetComponentProps,\n  buildEntry,\n  compileInternal,\n  createCompilationContext,\n  findExternals,\n  getDefaultLocale,\n  mergeCompilationMeta,\n  normalize,\n  normalizeInput,\n  responsiveValueGet,\n  validate,\n} from \"@redsun-vn/easyblocks-core\";\nimport {\n  CompilationContextType,\n  ComponentPickerOpenedEvent,\n  ItemInsertedEvent,\n  ItemMovedEvent,\n  componentPickerClosed,\n  duplicateConfig,\n  findComponentDefinitionById,\n  parsePath,\n  traverseComponents,\n} from \"@redsun-vn/easyblocks-core/_internals\";\nimport { Colors, Fonts, useToaster } from \"@redsun-vn/easyblocks-design-system\";\nimport throttle from \"lodash.throttle\";\nimport React, {\n  ComponentType,\n  memo,\n  useCallback,\n  useEffect,\n  useMemo,\n  useRef,\n  useState,\n} from \"react\";\nimport Modal from \"react-modal\";\nimport { styled } from \"styled-components\";\nimport { ConfigAfterAutoContext } from \"./ConfigAfterAutoContext\";\nimport { ExternalDataChangeHandler } from \"./EasyblocksEditorProps\";\nimport { EditorContext, EditorContextType } from \"./EditorContext\";\nimport { EditorExternalDataProvider } from \"./EditorExternalDataProvider\";\nimport { EditorIframe } from \"./EditorIframe\";\nimport { EditorSidebar } from \"./EditorSidebar\";\nimport { EditorTopBar, TOP_BAR_HEIGHT } from \"./EditorTopBar\";\nimport { ModalPicker } from \"./ModalPicker\";\nimport { TemplateModal } from \"./TemplateModal\";\nimport { TemplatePicker } from \"./TemplatePicker\";\nimport {\n  duplicateItems,\n  logItems,\n  moveItems,\n  pasteItems,\n  removeItems,\n  replaceItems,\n} from \"./editorActions\";\nimport { Form } from \"./form\";\nimport { destinationResolver } from \"./paste/destinationResolver\";\nimport { pasteManager } from \"./paste/manager\";\nimport { SelectionFrame } from \"./selectionFrame/SelectionFrame\";\nimport { getTemplates } from \"./templates/getTemplates\";\nimport { useForm } from \"./tinacms/react-core\";\nimport {\n  ActionsType,\n  OpenComponentPickerConfig,\n  OpenTemplateModalAction,\n} from \"./types\";\nimport { useDataSaver } from \"./useDataSaver\";\nimport { useEditorGlobalKeyboardShortcuts } from \"./useEditorGlobalKeyboardShortcuts\";\nimport { useEditorHistory } from \"./useEditorHistory\";\nimport { checkLocalesCorrectness } from \"./utils/locales/checkLocalesCorrectness\";\nimport { removeLocalizedFlag } from \"./utils/locales/removeLocalizedFlag\";\n\ndeclare global {\n  interface Window {\n    editorWindowAPI?: {\n      editorContext?: EditorContextType;\n      meta?: CompilationMetadata;\n      compiled?: NonEmptyRenderableContent;\n      externalData?: ExternalData;\n      onUpdate?: () => void;\n    };\n  }\n}\n\nconst ContentContainer = styled.div`\n  position: relative;\n  flex: 1 1 auto;\n  display: flex;\n  flex-direction: column;\n`;\n\nconst SidebarAndContentContainer = styled.div<{ height: \"100vh\" | \"100%\" }>`\n  height: ${(props) => `calc(${props.height} - ${TOP_BAR_HEIGHT}px)`};\n  width: 100%;\n  background: #fafafa;\n  display: flex;\n  flex-direction: row;\n  align-items: stretch;\n`;\n\nconst SidebarContainer = styled.div`\n  flex: 0 0 240px;\n  background: ${Colors.white};\n  border-left: 1px solid ${Colors.black100};\n  box-sizing: border-box;\n\n  > * {\n    box-sizing: border-box;\n  }\n\n  overflow-y: auto;\n`;\n\nconst DataSaverRoot = styled.div`\n  position: fixed;\n  width: 100%;\n  height: 100%;\n  z-index: 100000;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n`;\n\nconst DataSaverOverlay = styled.div`\n  z-index: -1;\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  background: rgba(0, 0, 0, 0.25);\n`;\n\nconst DataSaverModal = styled.div`\n  background: white;\n  padding: 32px;\n  border-radius: 8px;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  ${Fonts.body}\n  font-size: 16px;\n`;\n\nconst AuthenticationScreen = styled.div`\n  width: 100vw;\n  height: 100vh;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n  gap: 24px;\n  text-align: center;\n  ${Fonts.bodyLarge}\n`;\n\ntype EditorProps = {\n  config: Config;\n  locale?: string;\n  readOnly: boolean;\n  isAdminMode?: boolean;\n  documentId: string | null;\n  rootComponentId: string | null;\n  rootTemplateId: string | null;\n  save?: (document: Document) => Promise<void>;\n  onClose?: () => void;\n  externalData: FetchOutputResources;\n  onExternalDataChange: ExternalDataChangeHandler;\n  widgets?: Record<\n    string,\n    | ComponentType<WidgetComponentProps<any>>\n    | ComponentType<InlineTypeWidgetComponentProps<any>>\n    | ComponentType<TokenTypeWidgetComponentProps<any>>\n  >;\n  components?: Record<string, ComponentType<any>>;\n  pickers?: Record<string, TemplatePicker>;\n};\n\nexport const Editor = EditorBackendInitializer;\n\nfunction EditorBackendInitializer(props: EditorProps) {\n  const [enabled, setEnabled] = useState<boolean>(false);\n  const [error, setError] = useState<string | undefined>(undefined);\n  const [document, setDocument] = useState<Document | null>(null);\n\n  useEffect(() => {\n    async function run() {\n      try {\n        if (props.documentId) {\n          const document = await props.config.backend.documents.get({\n            id: props.documentId,\n          });\n\n          if (!document) {\n            throw new Error(\n              `Can't fetch document with id: ${props.documentId}`\n            );\n          }\n\n          setDocument(document);\n        }\n      } catch (error) {\n        console.error(error);\n        setError(\n          `Backend initialization error, check out console for more details.`\n        );\n        return;\n      }\n\n      setEnabled(true);\n    }\n\n    run();\n  }, []);\n\n  if (!enabled) {\n    return <AuthenticationScreen>Loading...</AuthenticationScreen>;\n  }\n\n  if (error) {\n    return (\n      <DataSaverRoot>\n        <DataSaverOverlay></DataSaverOverlay>\n        <DataSaverModal>{error}</DataSaverModal>\n      </DataSaverRoot>\n    );\n  }\n\n  return <EditorWrapper {...props} document={document} />;\n}\n\nconst EditorWrapper = memo(\n  (props: EditorProps & { document: Document | null }) => {\n    if (!props.document) {\n      if (props.rootTemplateId) {\n        if (props.rootComponentId) {\n          throw new Error(\n            \"You can't pass both 'rootContainer' and 'rootTemplate' parameters to the editor\"\n          );\n        }\n\n        const template = props.config.templates?.find(\n          (template) => template.id === props.rootTemplateId\n        );\n\n        if (!template) {\n          throw new Error(\n            `The template given in \"rootTemplate\" (\"${props.rootTemplateId}\") doesn't exist in Config.templates`\n          );\n        }\n      } else {\n        if (props.rootComponentId === null) {\n          throw new Error(\n            \"When you create a new document you must pass a 'rootContainer' or 'rootTemplate' parameter to the editor\"\n          );\n        }\n\n        if (\n          !props.config.components?.find(\n            (component) => component.id === props.rootComponentId\n          )\n        ) {\n          throw new Error(\n            `The component given in rootContainer (\"${props.rootComponentId}\") doesn't exist in Config.components`\n          );\n        }\n      }\n    }\n\n    // Locales\n    if (!props.config.locales) {\n      throw new Error(\"Required property Config.locales is empty\");\n    }\n\n    checkLocalesCorrectness(props.config.locales); // very important to check locales correctness, circular references etc. Other functions\n    const locale = props.locale ?? getDefaultLocale(props.config.locales).code;\n\n    const rootTemplateEntry = props.rootTemplateId\n      ? props.config.templates?.find((t) => t.id === props.rootTemplateId)\n          ?.entry\n      : null;\n\n    const rootComponentId = props.document\n      ? props.document.entry._component\n      : rootTemplateEntry?._component ?? props.rootComponentId;\n\n    const compilationContext = createCompilationContext(\n      props.config,\n      {\n        locale,\n      },\n      rootComponentId!\n    );\n\n    const initialEntry = props.document\n      ? adaptRemoteConfig(props.document.entry, compilationContext)\n      : normalize(\n          rootTemplateEntry ?? {\n            _id: uniqueId(),\n            _component: rootComponentId!,\n          },\n          compilationContext\n        );\n\n    return (\n      <EditorContent\n        {...props}\n        compilationContext={compilationContext}\n        initialDocument={props.document}\n        initialEntry={initialEntry}\n      />\n    );\n  }\n);\n\ntype EditorContentProps = EditorProps & {\n  compilationContext: CompilationContextType;\n  initialDocument: Document | null;\n  initialEntry: NoCodeComponentEntry;\n  heightMode?: \"viewport\" | \"full\";\n};\n\nfunction parseExternalDataId(externalDataId: string): {\n  configId: string;\n  fieldName: string;\n  breakpointIndex: string | undefined;\n} {\n  const [configId, fieldName, breakpointIndex] = externalDataId.split(\".\");\n\n  return {\n    configId,\n    fieldName,\n    breakpointIndex,\n  };\n}\n\nfunction useBuiltContent(\n  editorContext: EditorContextType,\n  config: Config,\n  rawContent: NoCodeComponentEntry,\n  externalData: ExternalData,\n  onExternalDataChange: ExternalDataChangeHandler\n): NonEmptyRenderableContent & {\n  meta: CompilationMetadata;\n} {\n  const buildEntryResult = useRef<ReturnType<typeof buildEntry>>();\n\n  // cached inputs (needed to calculated \"inputChanged\")\n  const inputRawContent = useRef<NoCodeComponentEntry>();\n  const inputIsEditing = useRef<boolean>();\n  const inputBreakpointIndex = useRef<string>();\n\n  const inputChanged =\n    inputRawContent.current !== rawContent ||\n    inputIsEditing.current !== editorContext.isEditing ||\n    inputBreakpointIndex.current !== editorContext.breakpointIndex;\n\n  if (!buildEntryResult.current || inputChanged) {\n    /*\n     * Why do we merge meta instead of overriding?\n     * It might seem redundant. We could only take the newest meta and re-render, right?\n     *\n     * The problem is when we have nested Shopstory content.\n     * The first call \"buildSync\" only compiles 1 level deep, doesn't compile deeper nested items.\n     * Deeper nested items are compiled only when fetch is finished.\n     *\n     * Because of that, when we switch isEditing from true to false following thing will happen:\n     * 1. We'll get only Metadata from 1 level compile.\n     * 2. Shopstory Editor will try to re-render everything.\n     * 3. It will remember old RenderableContent in the resources.\n     * 4. But the metadata from old RenderableContent is not yet added.\n     * 5. This will cause errors because there won't be enough definitions in the metadata.\n     *\n     * The solution is merging. Metadata code + definitions is growing incrementally in the editor.\n     * There is no performance overhead of this operation and we might be sure that any definitions\n     * that were added at any point will be available later.\n     *\n     */\n\n    buildEntryResult.current = buildEntry({\n      entry: rawContent,\n      config,\n      locale: editorContext.contextParams.locale,\n      externalData,\n      compiler: {\n        findExternals,\n        validate,\n        compile: (content) => {\n          let resultMeta: CompilationMetadata = {\n            vars: {\n              devices: editorContext.devices,\n              locale: editorContext.contextParams.locale,\n              definitions: {\n                actions: [],\n                components: [],\n                links: [],\n                textModifiers: [],\n              },\n            },\n          };\n\n          const normalizedContent = normalizeInput(content);\n\n          const { meta, ...rest } = compileInternal(\n            normalizedContent,\n            editorContext,\n            editorContext.compilationCache\n          );\n\n          resultMeta = mergeCompilationMeta(resultMeta, meta);\n\n          return {\n            ...rest,\n            meta: resultMeta,\n          };\n        },\n      },\n      isExternalDataChanged(externalDataValue, defaultIsExternalDataChanged) {\n        // When editing, we consider external data to be changed in more ways.\n        const storedExternalData = externalData[externalDataValue.id];\n\n        // If external data for given id is already stored, but now the external id is empty it means that the user\n        // has removed that external value and thus the user of editor has to remove it from its external data.\n        if (storedExternalData && externalDataValue.externalId === null) {\n          return true;\n        }\n\n        // If external data for given is is already stored, but now the external id is different it means that the user\n        // has changed the selected external value and thus the user of editor has to update it in its external data.\n        if (\n          storedExternalData &&\n          externalDataValue.externalId &&\n          inputRawContent.current\n        ) {\n          const { breakpointIndex, configId, fieldName } = parseExternalDataId(\n            externalDataValue.id\n          );\n\n          const config = findConfigById(\n            inputRawContent.current,\n            editorContext,\n            configId === \"$\" ? inputRawContent.current._id : configId\n          );\n\n          if (!config) {\n            return false;\n          }\n\n          const value = breakpointIndex\n            ? responsiveValueGet(config[fieldName], breakpointIndex)\n            : config[fieldName];\n\n          const hasExternalIdChanged =\n            value === undefined || value.id !== externalDataValue.externalId;\n\n          return hasExternalIdChanged;\n        }\n\n        return defaultIsExternalDataChanged(externalDataValue);\n      },\n    });\n\n    if (Object.keys(buildEntryResult.current.externalData).length > 0) {\n      onExternalDataChange(\n        buildEntryResult.current.externalData,\n        editorContext.contextParams\n      );\n    }\n  }\n\n  inputRawContent.current = rawContent;\n  inputIsEditing.current = editorContext.isEditing;\n  inputBreakpointIndex.current = editorContext.breakpointIndex;\n\n  return {\n    renderableContent: (buildEntryResult.current as NonEmptyRenderableContent)\n      .renderableContent,\n    configAfterAuto: (buildEntryResult.current as NonEmptyRenderableContent)\n      .configAfterAuto,\n    meta: buildEntryResult.current.meta,\n  };\n}\n\nfunction calculateViewportRelatedStuff(\n  viewport: string,\n  devices: DeviceRange[],\n  mainBreakpointIndex: string,\n  availableSize?: { width: number; height: number }\n) {\n  let activeDevice: DeviceRange;\n\n  // Calculate active device\n  if (viewport === \"fit-screen\") {\n    if (!availableSize) {\n      activeDevice = devices.find(\n        (device) => device.id === mainBreakpointIndex\n      )!;\n    } else {\n      const matchingDevice = getMatchingDevice(devices, availableSize.width);\n      if (!matchingDevice) {\n        throw new Error(\"can't find matching device\");\n      }\n\n      activeDevice = matchingDevice;\n    }\n  } else {\n    activeDevice = devices.find((device) => device.id === viewport)!;\n  }\n\n  const activeDeviceindex = devices.findIndex(\n    (device) => device.id === activeDevice.id\n  );\n\n  // Calculate width, height and scale\n  let width, height: number;\n  let scaleFactor: number | null = null;\n  let offsetY = 0;\n\n  if (!availableSize) {\n    // lack of available size (first render) should wait until size is available to perform calculations\n    width = 0;\n    height = 0;\n  } else {\n    if (viewport === \"fit-screen\") {\n      width = availableSize.width;\n      height = availableSize.height;\n    } else {\n      const smallestNonScaledWidth =\n        activeDeviceindex === 0\n          ? 0\n          : devices[activeDeviceindex - 1].breakpoint!;\n\n      width = activeDevice.w;\n      height =\n        activeDevice.h === null\n          ? availableSize.height\n          : Math.min(activeDevice.h, availableSize.height);\n\n      if (activeDevice.w <= availableSize.width) {\n        // fits\n      } else if (smallestNonScaledWidth <= availableSize.width) {\n        // fits currently selected device range\n        width = availableSize.width;\n      } else {\n        // we must scale\n        scaleFactor = availableSize.width / activeDevice.w;\n\n        if (activeDevice.h === null) {\n          height = availableSize.height / scaleFactor;\n          offsetY = (availableSize.height - height) / 2;\n        }\n      }\n    }\n  }\n\n  return {\n    breakpointIndex: activeDevice.id,\n    iframeSize: {\n      width,\n      height,\n      transform:\n        scaleFactor === null\n          ? \"none\"\n          : `translateY(${offsetY}px) scale(${scaleFactor})`,\n    },\n  };\n}\n\nfunction useRerenderOnIframeResize(iframe?: HTMLIFrameElement | null) {\n  const { forceRerender } = useForceRerender();\n\n  const resizeObserver = useRef(\n    new ResizeObserver(\n      throttle(() => {\n        forceRerender();\n      }, 100)\n    )\n  );\n\n  useEffect(() => {\n    if (!iframe) {\n      return;\n    }\n\n    resizeObserver.current.observe(iframe);\n\n    return () => {\n      resizeObserver.current.unobserve(iframe);\n    };\n  }, [iframe]);\n}\n\nconst EditorContent = ({\n  compilationContext,\n  heightMode = \"viewport\",\n  initialDocument,\n  initialEntry,\n  externalData,\n  isAdminMode = false,\n  ...props\n}: EditorContentProps) => {\n  const [currentViewport, setCurrentViewport] = useState<string>(\n    compilationContext.mainBreakpointIndex\n  ); // \"{ breakpoint }\" or \"fit-screen\"\n\n  const iframeContainerRef = useRef<HTMLIFrameElement>(null);\n  const availableSize = iframeContainerRef.current\n    ? {\n        width: iframeContainerRef.current.clientWidth,\n        height: iframeContainerRef.current.clientHeight,\n      }\n    : undefined;\n\n  const { breakpointIndex, iframeSize } = calculateViewportRelatedStuff(\n    currentViewport,\n    compilationContext.devices,\n    compilationContext.mainBreakpointIndex,\n    availableSize\n  );\n\n  useRerenderOnIframeResize(iframeContainerRef.current); // re-render on resize (recalculates viewport size, active breakpoint for fit-screen etc);\n\n  const compilationCache = useRef(new CompilationCache());\n  const [isEditing, setEditing] = useState(true);\n  const [currentLocale, setCurrentLocale] = useState(\n    compilationContext.contextParams.locale\n  );\n  const prevLocale = useRef<string>(\"\");\n  const [componentPickerData, setComponentPickerData] = useState<\n    | {\n        promiseResolve: (config: NoCodeComponentEntry | undefined) => void;\n        config: OpenComponentPickerConfig;\n      }\n    | undefined\n  >(undefined);\n  const [focussedField, setFocussedField] = useState<Array<string>>([]);\n\n  const handleSetFocussedField = React.useRef(\n    (field: Array<string> | string) => {\n      const nextFocusedField = Array.isArray(field) ? field : [field];\n      setFocussedField(nextFocusedField);\n    }\n  ).current;\n\n  const isEditMode = useMemo(() => {\n    if (!prevLocale.current || prevLocale.current === currentLocale) {\n      return isEditing;\n    }\n    return !isEditing;\n  }, [currentLocale, isEditing]);\n\n  const handleSetEditing = useCallback(() => {\n    compilationCache.current.clear();\n    setEditing(!isEditing);\n  }, [isEditing]);\n\n  const closeComponentPickerModal = (config?: NoCodeComponentEntry) => {\n    setComponentPickerData(undefined);\n    componentPickerData!.promiseResolve(config);\n  };\n\n  const sidebarNodeRef = useRef<HTMLDivElement | null>(null);\n\n  const [editableData, form] = useForm({\n    id: \"easyblocks-editor\",\n    label: \"Edit entry\",\n    fields: [],\n    initialValues: initialEntry,\n    onSubmit: async () => {},\n  });\n\n  const { undo, redo, push } = useEditorHistory({\n    onChange: ({ config, focusedField }) => {\n      setFocussedField(focusedField);\n      form.finalForm.change(\"\", config);\n    },\n  });\n\n  const [templates, setTemplates] = useState<Template[] | undefined>(undefined);\n\n  const [openTemplateModalAction, setOpenTemplateModalAction] = useState<\n    OpenTemplateModalAction | undefined\n  >(undefined);\n\n  const { notify } = useToaster();\n\n  const actions: ActionsType = {\n    openTemplateModal: setOpenTemplateModalAction,\n    notify: (message) => {\n      notify(message);\n    },\n    openComponentPicker: function (config) {\n      return new Promise((resolve) => {\n        setComponentPickerData({\n          promiseResolve: resolve,\n          config,\n        });\n      });\n    },\n    replaceItems: (paths, newConfig) => {\n      actions.runChange(() => {\n        replaceItems(paths, newConfig, editorContext);\n      });\n    },\n    moveItems: (fieldNames, direction) => {\n      actions.runChange(() => {\n        return moveItems(form, fieldNames, direction);\n      });\n    },\n    removeItems: (fieldNames) => {\n      actions.runChange(() => {\n        return removeItems(form, fieldNames, editorContext);\n      });\n    },\n    insertItem: ({ name, index, block }) => {\n      actions.runChange(() => {\n        form.mutators.insert(\n          name,\n          index,\n          duplicateConfig(block, compilationContext)\n        );\n\n        return [`${name}.${index}`];\n      });\n    },\n    duplicateItems: (fieldNames) => {\n      actions.runChange(() => {\n        return duplicateItems(form, fieldNames, compilationContext);\n      });\n    },\n    pasteItems: (what) => {\n      actions.runChange(() =>\n        pasteItems({\n          what,\n          where: focussedField,\n          resolveDestination: destinationResolver({\n            form,\n            context: compilationContext,\n          }),\n          pasteCommand: pasteManager(),\n        })\n      );\n    },\n    runChange: (configChangeCallback) => {\n      let fieldsToFocus!: Array<string>;\n\n      // When multiple fields are selected, the update could probably invoke `form.change` multiple times.\n      // To avoid multiple rerenders, we batch them to trigger single update.\n      form.finalForm.batch(() => {\n        // This shallow copy of `focussedField` array is SUPER IMPORTANT!\n        // Here is why...\n        //\n        // We invoke `configChangeCallback`, but since we are in batch, changes made to form state won't notify\n        // any listeners that there were any changes. This means `window.editorWindowAPI.onUpdate` won't be invoked.\n        //\n        // Next, update of `focussedField` is going to be queued up. React's heuristics will treat this update\n        // as update with high priority and synchronously rerender. `EditorContent` is going to rerender with updated\n        // `focussedField` state, but also with updated `editableData` because it's a result of **getter**!\n        // `useEffect` that is responsible for invoking `window.editorWindowAPI.onUpdate` will receive new dependencies,\n        // save them as the the latest, but it won't be immediately invoked after component have returned.\n        // Then the batch ends and all form listeners are going to be notified. `EditorContent` will rerender again,\n        // but `editableData` and `focussedField` are the same! `useEffect` will be invoked again, it will compare its dependencies\n        // and finds that the haven't changed.\n        //\n        // Making a shallow copy of `focussedField` will make the second invocation of `useEffect` different from the first\n        // triggered by calling `setFocussedField`.\n        fieldsToFocus = configChangeCallback() ?? [...focussedField];\n\n        push({\n          config: form.values,\n          focussedField: fieldsToFocus,\n        });\n\n        setFocussedField(fieldsToFocus);\n      });\n    },\n    logSelectedItems: () => {\n      logItems(editorContext.form, focussedField);\n    },\n  };\n\n  const syncTemplates = ({\n    mode,\n    template,\n  }: { mode?: \"create\" | \"edit\" | \"delete\"; template?: Template } = {}) => {\n    let templateDefined;\n    if (template) {\n      templateDefined = {\n        ...(template as UserDefinedTemplate),\n        isUserDefined: true,\n      };\n    }\n\n    switch (mode) {\n      case \"create\": {\n        if (templateDefined) {\n          setTemplates((prev) => {\n            if (!prev) {\n              return [templateDefined];\n            }\n\n            return [...prev, templateDefined];\n          });\n        }\n        break;\n      }\n\n      case \"edit\": {\n        if (templateDefined) {\n          setTemplates((prev) => {\n            if (!prev) {\n              return [templateDefined];\n            }\n\n            const templateIndex = prev.findIndex(\n              (t) => t.id === templateDefined.id\n            );\n\n            if (templateIndex === -1) {\n              return prev;\n            }\n\n            const newTemplates = [...prev];\n            newTemplates[templateIndex] = templateDefined;\n\n            return newTemplates;\n          });\n        }\n        break;\n      }\n\n      case \"delete\": {\n        if (templateDefined) {\n          setTemplates((prev) => {\n            if (!prev) {\n              return [];\n            }\n\n            const templateIndex = prev.findIndex(\n              (t) => t.id === templateDefined.id\n            );\n\n            if (templateIndex === -1) {\n              return prev;\n            }\n\n            const newTemplates = [...prev];\n            newTemplates.splice(templateIndex, 1);\n\n            return newTemplates;\n          });\n        }\n        break;\n      }\n\n      default: {\n        getTemplates(editorContext, (props.config.templates as any) ?? []).then(\n          (newTemplates) => {\n            setTemplates(newTemplates);\n          }\n        );\n        break;\n      }\n    }\n  };\n\n  useEffect(() => {\n    prevLocale.current = currentLocale;\n  }, [currentLocale]);\n\n  useEffect(() => {\n    syncTemplates();\n  }, [props.config.components, props.config.templates]);\n\n  const editorTypes: EditorContextType[\"types\"] = Object.fromEntries(\n    Object.entries(compilationContext.types).map(\n      ([typeName, typeDefinition]) => {\n        return [\n          typeName,\n          {\n            ...typeDefinition,\n            ...(typeDefinition.type === \"external\"\n              ? {\n                  widgets: typeDefinition.widgets.map((w) => {\n                    return {\n                      ...w,\n                      component: props.widgets?.[w.id] as any,\n                    };\n                  }),\n                }\n              : typeDefinition.widget\n              ? {\n                  widget: {\n                    ...typeDefinition.widget,\n                    component: props.widgets?.[typeDefinition.widget.id] as any,\n                  },\n                }\n              : {}),\n          },\n        ];\n      }\n    )\n  );\n\n  const editorContext: EditorContextType = {\n    ...compilationContext,\n    backend: props.config.backend,\n    types: editorTypes,\n    isAdminMode,\n    templates,\n    syncTemplates,\n    breakpointIndex,\n    focussedField,\n    form,\n    setFocussedField: handleSetFocussedField,\n    isEditing,\n    actions,\n    save: async (documentData) => {\n      window.postMessage({\n        type: \"@easyblocks/content-saved\",\n        document: documentData,\n      });\n    },\n    compilationCache: compilationCache.current,\n    readOnly: props.readOnly,\n    disableCustomTemplates: props.config.disableCustomTemplates ?? false,\n    rootComponent: findComponentDefinitionById(\n      initialEntry._component,\n      compilationContext\n    )!,\n    components: props.components ?? {},\n  };\n\n  const { configAfterAuto, renderableContent, meta } = useBuiltContent(\n    editorContext,\n    props.config,\n    editableData,\n    externalData,\n    props.onExternalDataChange\n  );\n\n  editorContext.compiledComponentConfig = renderableContent;\n  editorContext.configAfterAuto = configAfterAuto;\n\n  console.debug(\"editable data\", editableData);\n  console.debug(\"focused field\", focussedField);\n  console.debug(\"meta\", meta);\n  console.debug(\"compiled config\", {\n    configAfterAuto,\n    renderableContent,\n  });\n  console.debug(\"external data\", externalData);\n\n  window.editorWindowAPI = window.editorWindowAPI || {};\n  window.editorWindowAPI.editorContext = editorContext;\n  window.editorWindowAPI.meta = meta;\n  window.editorWindowAPI.compiled =\n    renderableContent as unknown as NonEmptyRenderableContent;\n  window.editorWindowAPI.externalData = externalData;\n\n  const onLocaleChange = async (localeValue: string) => {\n    compilationCache.current.clear();\n    compilationContext.contextParams.locale = localeValue;\n    setCurrentLocale(localeValue);\n    compilationCache.current.clear();\n    setEditing((prev) => !prev);\n\n    await sleep(1);\n\n    compilationCache.current.clear();\n    setEditing((prev) => !prev);\n  };\n\n  useEffect(() => {\n    push({\n      config: initialEntry,\n      focussedField: [],\n    });\n  }, []);\n\n  useEffect(() => {\n    if (window.editorWindowAPI?.onUpdate) {\n      window.editorWindowAPI.onUpdate();\n    }\n  }, [\n    renderableContent,\n    focussedField,\n    isEditing,\n    currentViewport,\n    externalData,\n  ]);\n\n  useEffect(() => {\n    function handleEditorEvents(\n      event: ComponentPickerOpenedEvent | ItemInsertedEvent | ItemMovedEvent\n    ) {\n      if (event.data.type === \"@easyblocks-editor/component-picker-opened\") {\n        actions\n          .openComponentPicker({ path: event.data.payload.path })\n          .then((config) => {\n            const shopstoryCanvasIframe = window.document.getElementById(\n              \"shopstory-canvas\"\n            ) as HTMLIFrameElement | undefined;\n\n            shopstoryCanvasIframe?.contentWindow?.postMessage(\n              componentPickerClosed(config)\n            );\n          });\n      }\n\n      if (event.data.type === \"@easyblocks-editor/item-inserted\") {\n        actions.insertItem(event.data.payload);\n      }\n\n      if (event.data.type === \"@easyblocks-editor/item-moved\") {\n        const { fromPath, toPath, placement } = event.data.payload;\n\n        const fromPathParseResult = parsePath(fromPath, editorContext.form);\n        const toPathParseResult = parsePath(toPath, editorContext.form);\n\n        if (\n          !fromPathParseResult.parent ||\n          !toPathParseResult.parent ||\n          fromPathParseResult.index === undefined ||\n          toPathParseResult === undefined\n        ) {\n          return;\n        }\n\n        if (fromPathParseResult.parent.path === toPathParseResult.parent.path) {\n          const pathToMove = `${\n            fromPathParseResult.parent.path\n              ? fromPathParseResult.parent.path + \".\"\n              : \"\"\n          }${fromPathParseResult.parent.fieldName}`;\n\n          actions.runChange(() => {\n            form.mutators.move(\n              pathToMove,\n              fromPathParseResult.index,\n              toPathParseResult.index\n            );\n\n            return [toPath];\n          });\n        } else {\n          // TODO: We should reuse logic of pasting items here, but we need to handle the case of pasting into placeholder (empty array)\n          const isToPathPlaceholder = toPathParseResult.fieldName !== undefined;\n\n          const insertionPath = `${\n            toPathParseResult.parent.path === \"\"\n              ? \"\"\n              : toPathParseResult.parent.path + \".\"\n          }${toPathParseResult.parent.fieldName}${\n            isToPathPlaceholder\n              ? `.${toPathParseResult.index}.${toPathParseResult.fieldName}`\n              : \"\"\n          }`;\n\n          actions.runChange(() => {\n            const newConfig = duplicateConfig(\n              dotNotationGet(form.values, fromPath),\n              editorContext\n            );\n\n            const insertionIndex = calculateInsertionIndex(\n              fromPath,\n              toPath,\n              placement,\n              form\n            );\n\n            form.mutators.insert(insertionPath, insertionIndex, newConfig);\n\n            actions.removeItems([fromPath]);\n\n            return [\n              isToPathPlaceholder\n                ? `${insertionPath}.0`\n                : `${insertionPath}.${insertionIndex}`,\n            ];\n          });\n        }\n      }\n    }\n\n    window.addEventListener(\"message\", handleEditorEvents);\n\n    return () => window.removeEventListener(\"message\", handleEditorEvents);\n  }, []);\n\n  const [isDataSaverOverlayOpen, setDataSaverOverlayOpen] = useState(false);\n\n  useEditorGlobalKeyboardShortcuts(editorContext);\n\n  const { saveNow } = useDataSaver(initialDocument, editorContext);\n\n  const appHeight = heightMode === \"viewport\" ? \"100vh\" : \"100%\";\n\n  useEffect(() => {\n    Modal.setAppElement(\"#shopstory-app\");\n  }, []);\n\n  const EditorSidebarRight = ({\n    sidebarNodeRef,\n    focussedField,\n    form,\n  }: {\n    sidebarNodeRef: React.MutableRefObject<HTMLDivElement | null>;\n    focussedField: Array<string>;\n    form: Form;\n  }) => {\n    return (\n      <SidebarContainer ref={sidebarNodeRef}>\n        <EditorSidebar focussedField={focussedField} form={form} />\n      </SidebarContainer>\n    );\n  };\n  const MemoEditorSidebarRight = React.memo(EditorSidebarRight);\n\n  return (\n    <div id={\"shopstory-app\"} style={{ height: appHeight, overflow: \"hidden\" }}>\n      {isDataSaverOverlayOpen && (\n        <DataSaverRoot>\n          <DataSaverOverlay></DataSaverOverlay>\n\n          <DataSaverModal>\n            Saving data, please do not close the window...\n          </DataSaverModal>\n        </DataSaverRoot>\n      )}\n      <EditorContext.Provider value={editorContext}>\n        <ConfigAfterAutoContext.Provider value={configAfterAuto}>\n          <EditorExternalDataProvider externalData={externalData}>\n            <div id=\"rootContainer\" />\n            <EditorTopBar\n              onUndo={undo}\n              onRedo={redo}\n              onSaveDocument={saveNow}\n              onClose={() => {\n                setDataSaverOverlayOpen(true);\n                saveNow().finally(() => {\n                  setDataSaverOverlayOpen(false);\n\n                  window.postMessage(\n                    {\n                      type: \"@easyblocks/closed\",\n                    },\n                    \"*\"\n                  );\n\n                  if (props.onClose) {\n                    props.onClose();\n                  }\n                });\n              }}\n              devices={compilationContext.devices}\n              viewport={currentViewport}\n              onViewportChange={setCurrentViewport}\n              onIsEditingChange={handleSetEditing}\n              isEditing={isEditMode}\n              saveLabel=\"Save\"\n              locale={currentLocale}\n              locales={editorContext.locales}\n              onLocaleChange={onLocaleChange}\n              hideCloseButton={props.config.hideCloseButton ?? false}\n              readOnly={editorContext.readOnly}\n            />\n            <SidebarAndContentContainer height={appHeight}>\n              <ContentContainer\n                onClick={() => {\n                  setFocussedField([]);\n                }}\n              >\n                <EditorIframe\n                  onEditorHistoryUndo={undo}\n                  onEditorHistoryRedo={redo}\n                  width={iframeSize.width}\n                  height={iframeSize.height}\n                  transform={iframeSize.transform}\n                  containerRef={iframeContainerRef}\n                />\n                {isEditMode && (\n                  <SelectionFrame\n                    width={iframeSize.width}\n                    height={iframeSize.height}\n                    transform={iframeSize.transform}\n                  />\n                )}\n              </ContentContainer>\n              {isEditMode && (\n                <MemoEditorSidebarRight\n                  sidebarNodeRef={sidebarNodeRef}\n                  focussedField={focussedField}\n                  form={form}\n                />\n                // <SidebarContainer ref={sidebarNodeRef}>\n                //   <EditorSidebar focussedField={focussedField} form={form} />\n                // </SidebarContainer>\n              )}\n              {componentPickerData && (\n                <ModalPicker\n                  onClose={closeComponentPickerModal}\n                  config={componentPickerData.config}\n                  pickers={props.pickers}\n                />\n              )}\n            </SidebarAndContentContainer>\n\n            {openTemplateModalAction && (\n              <TemplateModal\n                action={openTemplateModalAction}\n                onClose={() => {\n                  setOpenTemplateModalAction(undefined);\n                }}\n                backend={editorContext.backend}\n              />\n            )}\n          </EditorExternalDataProvider>\n        </ConfigAfterAutoContext.Provider>\n      </EditorContext.Provider>\n    </div>\n  );\n};\n\nfunction adaptRemoteConfig(\n  config: NoCodeComponentEntry,\n  compilationContext: CompilationContextType\n) {\n  const withoutLocalizedFlag = removeLocalizedFlag(config, compilationContext);\n  const normalized = normalize(withoutLocalizedFlag, compilationContext);\n  return normalized;\n}\n\nfunction calculateInsertionIndex(\n  fromPath: string,\n  toPath: string,\n  placement: \"before\" | \"after\" | undefined,\n  form: Form\n) {\n  const mostCommonPath = getMostCommonSubPath(fromPath, toPath);\n  const mostCommonPathParseResult = parsePath(mostCommonPath ?? \"\", form);\n  const toPathParseResult = parsePath(toPath, form);\n  const toPathNoCodeEntry = dotNotationGet(form.values, toPath);\n\n  if (toPathNoCodeEntry.length === 0) {\n    return 0;\n  }\n\n  // If there is no index in common path, it means that we're moving items between two sections\n  if (mostCommonPathParseResult.index === undefined) {\n    const fromPathRootSectionIndex = +fromPath.split(\".\")[1];\n    const toPathRootSectionIndex = +toPath.split(\".\")[1];\n\n    if (fromPathRootSectionIndex > toPathRootSectionIndex) {\n      if (placement) {\n        if (placement === \"before\") {\n          return toPathParseResult.index!;\n        }\n\n        return toPathParseResult.index! + 1;\n      }\n\n      return toPathParseResult.index!;\n    }\n\n    if (placement) {\n      if (placement === \"before\") {\n        return toPathParseResult.index!;\n      }\n\n      return toPathParseResult.index! + 1;\n    }\n\n    return toPathParseResult.index! + 1;\n  }\n\n  return toPathParseResult.index! + 1;\n}\n\nfunction getMostCommonSubPath(path1: string, path2: string) {\n  const fromPathParts = path1.split(\".\");\n  const toPathParts = path2.split(\".\");\n\n  let mostCommonPathParts: Array<string> | undefined = undefined;\n\n  for (let i = 0; i < Math.min(fromPathParts.length, toPathParts.length); i++) {\n    const currentFromPathPart = fromPathParts[i];\n    const currentToPathPart = toPathParts[i];\n\n    if (currentFromPathPart !== currentToPathPart) {\n      break;\n    }\n\n    if (!mostCommonPathParts) {\n      mostCommonPathParts = [currentFromPathPart];\n      continue;\n    }\n\n    mostCommonPathParts.push(currentFromPathPart);\n  }\n\n  return mostCommonPathParts?.join(\".\");\n}\n\nfunction findConfigById(\n  config: NoCodeComponentEntry,\n  context: CompilationContextType,\n  configId: string\n): NoCodeComponentEntry | undefined {\n  let foundConfig: NoCodeComponentEntry | undefined;\n\n  traverseComponents(config, context, ({ componentConfig }) => {\n    if (foundConfig) {\n      return;\n    }\n\n    if (componentConfig._id === configId) {\n      foundConfig = componentConfig;\n    }\n  });\n\n  return foundConfig;\n}\n\nfunction getMatchingDevice(devices: Array<DeviceRange>, width: number) {\n  const highestDevice = devices.find((d) => d.breakpoint === null);\n\n  const visibleDevices = devices.filter(\n    (d) => !d.hidden && d.breakpoint !== null\n  );\n\n  for (let i = 0; i < visibleDevices.length; i++) {\n    const currentDevice = visibleDevices[i];\n\n    if (currentDevice.breakpoint! > width) {\n      return currentDevice;\n    }\n  }\n\n  if (highestDevice) {\n    return highestDevice;\n  }\n\n  return null;\n}\n","/**\n * This is a copy of validate-color function from validate-color npm package. This package has problem with bundling, so I copied it here. It was modified 100 years ago anyway and had 32 stars, so nothing fancy really.\n */\n\n// Good article on HTML Colors:\n// https://dev.to/alvaromontoro/the-ultimate-guide-to-css-colors-2020-edition-1bh1#hsl\n\n// Check if parameter is defined and a string\nconst isString = (color: string) => color && typeof color === \"string\";\n// All existing HTML color names\nconst htmlColorNames = [\n  \"AliceBlue\",\n  \"AntiqueWhite\",\n  \"Aqua\",\n  \"Aquamarine\",\n  \"Azure\",\n  \"Beige\",\n  \"Bisque\",\n  \"Black\",\n  \"BlanchedAlmond\",\n  \"Blue\",\n  \"BlueViolet\",\n  \"Brown\",\n  \"BurlyWood\",\n  \"CadetBlue\",\n  \"Chartreuse\",\n  \"Chocolate\",\n  \"Coral\",\n  \"CornflowerBlue\",\n  \"Cornsilk\",\n  \"Crimson\",\n  \"Cyan\",\n  \"DarkBlue\",\n  \"DarkCyan\",\n  \"DarkGoldenrod\",\n  \"DarkGray\",\n  \"DarkGreen\",\n  \"DarkKhaki\",\n  \"DarkMagenta\",\n  \"DarkOliveGreen\",\n  \"DarkOrange\",\n  \"DarkOrchid\",\n  \"DarkRed\",\n  \"DarkSalmon\",\n  \"DarkSeaGreen\",\n  \"DarkSlateBlue\",\n  \"DarkSlateGray\",\n  \"DarkTurquoise\",\n  \"DarkViolet\",\n  \"DeepPink\",\n  \"DeepSkyBlue\",\n  \"DimGray\",\n  \"DodgerBlue\",\n  \"FireBrick\",\n  \"FloralWhite\",\n  \"ForestGreen\",\n  \"Fuchsia\",\n  \"Gainsboro\",\n  \"GhostWhite\",\n  \"Gold\",\n  \"Goldenrod\",\n  \"Gray\",\n  \"Green\",\n  \"GreenYellow\",\n  \"HoneyDew\",\n  \"HotPink\",\n  \"IndianRed\",\n  \"Indigo\",\n  \"Ivory\",\n  \"Khaki\",\n  \"Lavender\",\n  \"LavenderBlush\",\n  \"LawnGreen\",\n  \"LemonChiffon\",\n  \"LightBlue\",\n  \"LightCoral\",\n  \"LightCyan\",\n  \"LightGoldenrodYellow\",\n  \"LightGray\",\n  \"LightGreen\",\n  \"LightPink\",\n  \"LightSalmon\",\n  \"LightSalmon\",\n  \"LightSeaGreen\",\n  \"LightSkyBlue\",\n  \"LightSlateGray\",\n  \"LightSteelBlue\",\n  \"LightYellow\",\n  \"Lime\",\n  \"LimeGreen\",\n  \"Linen\",\n  \"Magenta\",\n  \"Maroon\",\n  \"MediumAquamarine\",\n  \"MediumBlue\",\n  \"MediumOrchid\",\n  \"MediumPurple\",\n  \"MediumSeaGreen\",\n  \"MediumSlateBlue\",\n  \"MediumSlateBlue\",\n  \"MediumSpringGreen\",\n  \"MediumTurquoise\",\n  \"MediumVioletRed\",\n  \"MidnightBlue\",\n  \"MintCream\",\n  \"MistyRose\",\n  \"Moccasin\",\n  \"NavajoWhite\",\n  \"Navy\",\n  \"OldLace\",\n  \"Olive\",\n  \"OliveDrab\",\n  \"Orange\",\n  \"OrangeRed\",\n  \"Orchid\",\n  \"PaleGoldenrod\",\n  \"PaleGreen\",\n  \"PaleTurquoise\",\n  \"PaleVioletRed\",\n  \"PapayaWhip\",\n  \"PeachPuff\",\n  \"Peru\",\n  \"Pink\",\n  \"Plum\",\n  \"PowderBlue\",\n  \"Purple\",\n  \"RebeccaPurple\",\n  \"Red\",\n  \"RosyBrown\",\n  \"RoyalBlue\",\n  \"SaddleBrown\",\n  \"Salmon\",\n  \"SandyBrown\",\n  \"SeaGreen\",\n  \"SeaShell\",\n  \"Sienna\",\n  \"Silver\",\n  \"SkyBlue\",\n  \"SlateBlue\",\n  \"SlateGray\",\n  \"Snow\",\n  \"SpringGreen\",\n  \"SteelBlue\",\n  \"Tan\",\n  \"Teal\",\n  \"Thistle\",\n  \"Tomato\",\n  \"Turquoise\",\n  \"Violet\",\n  \"Wheat\",\n  \"White\",\n  \"WhiteSmoke\",\n  \"Yellow\",\n  \"YellowGreen\",\n];\n// These 3 values are valid, usable color names, which are special in their own way\nconst htmlColorNamesSpecial = [\"currentColor\", \"inherit\", \"transparent\"];\n\n// Validate HTML color name (red, yellow, etc)\nexport const validateHTMLColorName = (color: string): boolean => {\n  let status = false;\n  if (isString(color)) {\n    htmlColorNames.map((c) => {\n      if (color.toLowerCase() === c.toLowerCase()) {\n        status = true;\n      }\n      return null;\n    });\n  }\n  return status;\n};\n\n// Validate HTML color special name (currentColor, inherit, etc)\nexport const validateHTMLColorSpecialName = (color: string): boolean => {\n  let status = false;\n  if (isString(color)) {\n    htmlColorNamesSpecial.map((c) => {\n      if (color.toLowerCase() === c.toLowerCase()) {\n        status = true;\n      }\n      return null;\n    });\n  }\n  return status;\n};\n\n// Validate HTML color 'hex'\nexport const validateHTMLColorHex = (color: string): boolean => {\n  if (isString(color)) {\n    const regex = /^#([\\da-f]{3}){1,2}$|^#([\\da-f]{4}){1,2}$/i;\n    return !!color && regex.test(color);\n  }\n  return false;\n};\n\n// Validate HTML color 'rgb'\n// -- legacy notation\n// color: rgb(255, 255, 255);\n// color: rgba(255, 255, 255, 1);\n// -- new notation\n// color: rgb(255 255 255);\n// color: rgb(255 255 255 / 1);\n// Note that 'rgba()' is now merged into 'rgb()'\nexport const validateHTMLColorRgb = (color: string): boolean => {\n  if (isString(color)) {\n    const regex =\n      /(rgb)a?\\((\\s*\\d+%?\\s*?,?\\s*){2}(\\s*\\d+%?\\s*?,?\\s*\\)?)(\\s*,?\\s*\\/?\\s*(0?\\.?\\d+%?\\s*)?|1|0)?\\)$/i;\n    return !!color && regex.test(color);\n  }\n  return false;\n};\n\nconst optionalCommaOrRequiredSpace = `((\\\\s*,\\\\s*)|(\\\\s+))`;\nconst optionalDecimals = `(\\\\.\\\\d+)?`;\nconst anyPercentage = `((\\\\d*${optionalDecimals})%)`;\nconst hundredPercent = `(([0-9]|[1-9][0-9]|100)%)`;\nconst alphaPercentage = `(((${hundredPercent}))|(0?${optionalDecimals})|1))?`;\nconst endingWithAlphaPercentage = `\\\\s*?\\\\)?)(\\\\s*?(\\\\/?)\\\\s+${alphaPercentage}\\\\s*?\\\\)$`;\n\n// Validate HTML color 'hsl'\n// -- These units are valid for the first parameter\n// 'deg': degrees | full circle = 360\n// 'gra': gradians | full circle = 400\n// 'radians': radians | full circle = 2 (approx. 6.28)\n// 'turn': turns | full circle = 1\nexport const validateHTMLColorHsl = (color: string): boolean => {\n  if (isString(color)) {\n    // Validate each possible unit value separately, as their values differ\n    const degRegex = `(-?([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-9][0-9]|3[0-5][0-9]|360)(deg)?)`;\n    const graRegex = `(([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-9][0-9]|3[0-9][0-9]|400)gra)`;\n    const radRegex = `((([0-5])?\\\\.\\\\d+|6\\\\.([0-9]|1[0-9]|2[0-8])|[0-6])rad)`;\n    const turnRegex = `((0?${optionalDecimals}|1)turn)`;\n    const regexLogic = `(hsl)a?\\\\((\\\\s*?(${degRegex}|${graRegex}|${radRegex}|${turnRegex})${optionalCommaOrRequiredSpace})(\\\\s*?(0|${hundredPercent})${optionalCommaOrRequiredSpace})(\\\\s*?(0|${hundredPercent})\\\\s*?\\\\)?)(\\\\s*?(\\\\/?|,?)\\\\s*?(((${hundredPercent}))|(0?${optionalDecimals})|1))?\\\\)$`;\n    const regex = new RegExp(regexLogic);\n    return !!color && regex.test(color);\n  }\n  return false;\n};\n\n// Validate HTML color 'hwb'\n// -- 'hwb' accepts 'deg' as unit in its 1st property, which stands for 'hue'\n// 'deg': degrees | full circle = 360\nexport const validateHTMLColorHwb = (color: string): boolean => {\n  if (isString(color)) {\n    const degRegex = `(-?([0-9]|[1-9][0-9]|1[0-9][0-9]|2[0-9][0-9]|3[0-5][0-9]|360)(deg)?)`;\n    const regexLogic = `(hwb\\\\(\\\\s*?${degRegex}\\\\s+)((0|${hundredPercent})\\\\s+)((0|${hundredPercent})${endingWithAlphaPercentage}`;\n    const regex = new RegExp(regexLogic);\n    return !!color && regex.test(color);\n  }\n  return false;\n};\n\n// Validate HTML color 'lab'\n// -- 'lab' 2nd & 3rd parameters are any number between -160 & 160\nexport const validateHTMLColorLab = (color: string): boolean => {\n  if (isString(color)) {\n    const labParam = `(-?(([0-9]|[1-9][0-9]|1[0-5][0-9])${optionalDecimals}?|160))`;\n    const regexLogic = `(lab\\\\(\\\\s*?${anyPercentage}\\\\s+${labParam}\\\\s+${labParam}${endingWithAlphaPercentage}`;\n    const regex = new RegExp(regexLogic);\n    return !!color && regex.test(color);\n  }\n\n  return false;\n};\n\n// Validate only HTML colors (`hex`, `rgb`, `rgba`, `hsl`, `hsla`, `hwb`, `lab`), without `name` og `special name`**\nexport const validateHTMLColor = (color: string): boolean => {\n  if (\n    (color && validateHTMLColorHex(color)) ||\n    validateHTMLColorRgb(color) ||\n    validateHTMLColorHsl(color) ||\n    validateHTMLColorHwb(color) ||\n    validateHTMLColorLab(color)\n  ) {\n    return true;\n  }\n  return false;\n};\n\nconst validateColor = (color: string) => {\n  // Former validation - source: https://www.regextester.com/103656\n  // if (isString(color)) {\n  //   const regex = /^#([\\da-f]{3}){1,2}$|^#([\\da-f]{4}){1,2}$|(rgb|hsl)a?\\((\\s*-?\\d+%?\\s*,){2}(\\s*-?\\d+%?\\s*,?\\s*\\)?)(,\\s*(0?\\.\\d+)?|1|0)?\\)$/i;\n  //   return color && regex.test(color);\n  // }\n  // New validation\n  if (\n    (color && validateHTMLColorHex(color)) ||\n    validateHTMLColorName(color) ||\n    validateHTMLColorSpecialName(color) ||\n    validateHTMLColorRgb(color) ||\n    validateHTMLColorHsl(color) ||\n    validateHTMLColorHwb(color) ||\n    validateHTMLColorLab(color)\n  ) {\n    return true;\n  }\n  return false;\n};\n\nexport { validateColor };\n","import type { TokenTypeWidgetComponentProps } from \"@redsun-vn/easyblocks-core\";\nimport { Input } from \"@redsun-vn/easyblocks-design-system\";\nimport React, { useState } from \"react\";\nimport { validateColor } from \"./validate-color\";\n\nfunction ColorTokenWidget(props: TokenTypeWidgetComponentProps<string>) {\n  const [inputValue, setInputValue] = useState(props.value);\n\n  return (\n    <Input\n      value={inputValue}\n      onChange={(e: React.ChangeEvent<HTMLInputElement>) => {\n        setInputValue(e.target.value);\n      }}\n      onBlur={() => {\n        if (validateColor(inputValue)) {\n          props.onChange(inputValue);\n          return;\n        }\n\n        if (validateColor(\"#\" + inputValue)) {\n          props.onChange(\"#\" + inputValue);\n          return;\n        }\n\n        props.onChange(props.value);\n      }}\n      align={\"right\"}\n    />\n  );\n}\n\nexport { ColorTokenWidget };\n","import type { TokenTypeWidgetComponentProps } from \"@redsun-vn/easyblocks-core\";\nimport { Input } from \"@redsun-vn/easyblocks-design-system\";\nimport React, { useState } from \"react\";\n\nfunction SpaceTokenWidget(props: TokenTypeWidgetComponentProps<string>) {\n  const [inputValue, setInputValue] = useState(props.value);\n\n  return (\n    <Input\n      value={inputValue}\n      onChange={(e: React.ChangeEvent<HTMLInputElement>) => {\n        setInputValue(e.target.value);\n      }}\n      onBlur={() => {\n        const int = Math.round(parseInt(inputValue));\n\n        if (isNaN(int) || int < 0) {\n          props.onChange(\"0px\");\n          return;\n        }\n\n        props.onChange(`${int}px`);\n      }}\n      align={\"right\"}\n    />\n  );\n}\n\nexport { SpaceTokenWidget };\n","type EditorSearchParams = {\n  readOnly: boolean | null;\n  documentId: string | null;\n  templateId: string | null;\n  rootComponentId: string | null;\n  rootTemplateId: string | null;\n  locale: string | null;\n  preview: boolean;\n  debug: boolean;\n};\n\nexport function parseQueryParams() {\n  const searchParams = new URLSearchParams(window.location.search);\n\n  const readOnly =\n    searchParams.get(\"readOnly\") === \"true\"\n      ? true\n      : searchParams.get(\"readOnly\") === \"false\"\n      ? false\n      : null;\n  const documentId = searchParams.get(\"document\");\n  const templateId = searchParams.get(\"template\");\n  const rootComponentId = searchParams.get(\"rootComponent\");\n  const rootTemplateId = searchParams.get(\"rootTemplate\");\n  const locale = searchParams.get(\"locale\");\n  const debug = searchParams.get(\"debug\") === \"true\";\n\n  const preview = searchParams.get(\"preview\") === \"true\";\n\n  const editorSearchParams: EditorSearchParams = {\n    readOnly,\n    documentId,\n    templateId,\n    rootComponentId,\n    rootTemplateId,\n    locale,\n    preview,\n    debug,\n  };\n\n  return editorSearchParams;\n}\n","import {\n  getExternalReferenceLocationKey,\n  isResolvedCompoundExternalDataValue,\n  type ExternalDataCompoundResourceResolvedResult,\n} from \"@redsun-vn/easyblocks-core\";\nimport { findComponentDefinitionById } from \"@redsun-vn/easyblocks-core/_internals\";\nimport { Typography } from \"@redsun-vn/easyblocks-design-system\";\nimport { assertDefined, dotNotationGet } from \"@/utils\";\nimport React from \"react\";\nimport {\n  CompoundResourceValueSelect,\n  getBasicResourcesOfType,\n} from \"../tinacms/fields/plugins/ExternalField/ExternalField\";\nimport type { InternalWidgetComponentProps } from \"../types\";\n\nfunction DocumentDataWidgetComponent({\n  id,\n  onChange,\n  resourceKey,\n  path,\n}: InternalWidgetComponentProps & { type: string }) {\n  if (id !== null && typeof id !== \"string\") {\n    return (\n      <Typography\n        style={{\n          whiteSpace: \"normal\",\n        }}\n      >\n        Unsupported type of identifier for document data widget. Expected\n        \"string\", but got \"{typeof id}\".\n      </Typography>\n    );\n  }\n\n  const { editorContext, externalData }: any = window.editorWindowAPI ?? {};\n\n  const schema = editorContext.rootComponent.rootParams;\n\n  const documentExternalLocationKeys = assertDefined(schema).map((s: any) =>\n    getExternalReferenceLocationKey(\"$\", s.prop)\n  );\n\n  const documentCompoundResources = Object.entries(externalData).filter<\n    [string, ExternalDataCompoundResourceResolvedResult]\n  >((r): r is [string, ExternalDataCompoundResourceResolvedResult] => {\n    const [externalId, externalDataValue] = r;\n    return (\n      documentExternalLocationKeys.includes(externalId) &&\n      isResolvedCompoundExternalDataValue(\n        externalDataValue as ExternalDataCompoundResourceResolvedResult\n      )\n    );\n  });\n\n  const entry = dotNotationGet(\n    editorContext.form.values,\n    path.slice(0, path.lastIndexOf(\".\"))\n  );\n  const definition = findComponentDefinitionById(\n    entry._component,\n    editorContext\n  );\n  const schemaProp = definition!.schema.find(\n    (s) => s.prop === path.split(\".\").pop()\n  )!;\n\n  const options = documentCompoundResources.flatMap(\n    ([externalId, externalDataValue]) =>\n      getBasicResourcesOfType(externalDataValue.value, schemaProp.type).map(\n        (r) => {\n          const resourceSchemaProp = assertDefined(\n            schema?.find(\n              (s: { prop: string }) => s.prop === externalId.split(\".\")[1]\n            )\n          );\n\n          return {\n            id: externalId,\n            key: r.key,\n            label: `${resourceSchemaProp.label ?? resourceSchemaProp.prop} > ${\n              r.label ?? r.key\n            }`,\n          };\n        }\n      )\n  );\n\n  if (options.length === 1 && !id && path) {\n    // We perform form change manually to avoid storing this change in editor's history\n    editorContext.form.change(path, {\n      id: options[0].id,\n      key: options[0].key,\n      widgetId: \"@easyblocks/document-data\",\n    });\n  }\n\n  if (!documentCompoundResources.length) {\n    return (\n      <Typography\n        style={{\n          whiteSpace: \"normal\",\n        }}\n      >\n        Please select at least one non optional external data for document.\n      </Typography>\n    );\n  }\n\n  return (\n    <CompoundResourceValueSelect\n      options={options}\n      resource={\n        id === null\n          ? {\n              id,\n              key: undefined,\n            }\n          : {\n              id,\n              key: resourceKey,\n            }\n      }\n      onResourceKeyChange={(newId, newKey) => {\n        onChange(newId, newKey);\n      }}\n    />\n  );\n}\n\nexport { DocumentDataWidgetComponent };\n","import { Template } from \"@redsun-vn/easyblocks-core\";\nimport {\n  ButtonGhostColor,\n  Colors,\n  Fonts,\n  Modal,\n} from \"@redsun-vn/easyblocks-design-system\";\nimport React, { useRef } from \"react\";\nimport { styled } from \"styled-components\";\nimport { EditorContextType, useEditorContext } from \"./EditorContext\";\nimport { TemplatePicker } from \"./TemplatePicker\";\n\ntype VisualProps = {\n  mode: string;\n};\n\n/**\n * CARD\n */\n\nconst CardRoot = styled.div`\n  &:hover {\n    outline: 1px solid ${Colors.black10};\n    outline-offset: 8px;\n  }\n\n  .editButton {\n    opacity: 0;\n  }\n\n  &:hover {\n    .editButton {\n      opacity: 1;\n    }\n  }\n`;\n\nconst ImageContainer = styled.div<VisualProps>`\n  position: relative;\n  background-color: ${Colors.black10};\n  margin-bottom: 8px;\n  padding-bottom: ${(p) => (p.mode === \"large-3\" ? \"90%\" : \"60%\")};\n  cursor: pointer;\n`;\n\nconst CardImg = styled.img`\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  object-fit: contain;\n  padding: 24px;\n  box-sizing: border-box;\n`;\n\nconst CardImgPlaceholder = styled.div`\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  display: flex;\n  align-items: center;\n  justify-content: center;\n`;\n\nconst CardFooter = styled.div`\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  align-items: center;\n  margin-top: 8px;\n`;\n\nconst CardLabelContainer = styled.div`\n  display: flex;\n  flex-direction: row;\n  align-items: center;\n`;\n\nconst CardLabelTemplateName = styled.div`\n  ${Fonts.body};\n  color: black;\n`;\n\nconst Title = styled.div`\n  ${Fonts.label}\n`;\n\nconst TitleContainer = styled.div`\n  display: flex;\n  flex-direction: row;\n  gap: 8px;\n  align-items: center;\n  margin-bottom: 24px;\n`;\n\nconst Message = styled.div`\n  padding-top: 32px;\n  ${Fonts.body};\n`;\n\ntype SectionCardProps = {\n  template: Template;\n  onSelect: () => void;\n  mode: string;\n};\n\nfunction getTemplatePreviewImage(\n  template: Template,\n  editorContext: EditorContextType\n): string | undefined {\n  // template.previewImage is always most important and overrides other sources of preview\n  if (template.thumbnail) {\n    return template.thumbnail;\n  }\n\n  return;\n\n  // if (template.configId) {\n  //   return getComponentConfigPreviewImageURL({\n  //     configId: template.configId,\n  //     contextParams: editorContext.contextParams,\n  //     locales: editorContext.locales,\n  //     project: editorContext.project,\n  //   });\n  // }\n}\n\nconst SectionCard: React.FC<SectionCardProps> = ({\n  template,\n  onSelect,\n  mode,\n}) => {\n  const imageRef = useRef(null);\n  const editorContext = useEditorContext();\n\n  const previewImage = getTemplatePreviewImage(template, editorContext);\n\n  return (\n    <CardRoot>\n      <ImageContainer ref={imageRef} onClick={onSelect} mode={mode}>\n        {previewImage && <CardImg src={previewImage} />}\n        {!previewImage && template.thumbnailLabel && (\n          <CardImgPlaceholder>\n            <span style={{ color: \"#6c6c6c\" }}>{template.thumbnailLabel}</span>\n          </CardImgPlaceholder>\n        )}\n        {!previewImage && !template.thumbnailLabel && (\n          <CardImgPlaceholder>\n            <svg\n              xmlns=\"http://www.w3.org/2000/svg\"\n              width=\"64\"\n              height=\"64\"\n              viewBox=\"0 0 16 16\"\n              fill=\"none\"\n            >\n              <path\n                d=\"M8.18102 5.39789L6.89683 10.3512L7.86482 10.6022L9.14901 5.64885L8.18102 5.39789Z\"\n                fill={Colors.black20}\n              />\n              <path\n                d=\"M9.38171 6.1215L11.1837 7.92352L9.38172 9.72549L10.0888 10.4326L12.5979 7.92353L10.0888 5.4144L9.38171 6.1215Z\"\n                fill={Colors.black20}\n              />\n              <path\n                d=\"M6.54828 6.11507L4.80393 7.92352L6.54828 9.73192L5.82854 10.4262L3.41455 7.92353L5.82853 5.42083L6.54828 6.11507Z\"\n                fill={Colors.black20}\n              />\n              <path\n                fillRule=\"evenodd\"\n                clipRule=\"evenodd\"\n                d=\"M2 3C2 2.44772 2.44772 2 3 2H13C13.5523 2 14 2.44772 14 3V13C14 13.5523 13.5523 14 13 14H3C2.44772 14 2 13.5523 2 13V3ZM3 3H13V13H3L3 3Z\"\n                fill={Colors.black20}\n              />\n            </svg>\n          </CardImgPlaceholder>\n        )}\n      </ImageContainer>\n\n      <CardFooter>\n        <CardLabelContainer>\n          <>\n            {template.label && (\n              <>\n                <CardLabelTemplateName>{template.label}</CardLabelTemplateName>\n              </>\n            )}\n          </>\n        </CardLabelContainer>\n\n        <div></div>\n\n        {template.isUserDefined && !editorContext.readOnly && (\n          <ButtonGhostColor\n            className={\"editButton\"}\n            onClick={() => {\n              editorContext.actions.openTemplateModal({\n                mode: \"edit\",\n                template: template as Template,\n              });\n            }}\n          >\n            Edit\n          </ButtonGhostColor>\n        )}\n      </CardFooter>\n    </CardRoot>\n  );\n};\n\n/**\n * MODAL\n */\n\nconst ModalRoot = styled.div`\n  position: absolute;\n  top: 0;\n  left: 0;\n  width: 100%;\n  height: 100%;\n  display: grid;\n  grid-template-columns: 200px 1fr;\n`;\n\nconst ModalGridRoot = styled.div<VisualProps>`\n  display: grid;\n  grid-template-columns: ${(p) =>\n    p.mode === \"large-3\" ? \"1fr 1fr 1fr\" : \"1fr 1fr\"};\n  grid-column-gap: 16px;\n  grid-row-gap: 30px;\n`;\n\nconst Sidebar = styled.div`\n  overflow-y: hidden;\n  overflow-x: hidden;\n  border-right: 1px solid ${Colors.black5};\n  height: 100%;\n`;\n\nconst SidebarContent = styled.div`\n  padding: 24px 4px;\n  display: flex;\n  flex-direction: column;\n  gap: 8px;\n`;\n\nconst SidebarButton = styled.button`\n  all: unset;\n  height: 38px;\n  ${Fonts.body}\n  display: flex;\n  padding-left: 16px;\n  align-items: center;\n  &:hover {\n    background: ${Colors.black5};\n  }\n  cursor: pointer;\n`;\n\nconst GridRoot = styled.div`\n  padding: 0px 16px;\n  height: 100%;\n  overflow-x: hidden;\n  overflow-y: auto;\n`;\n\nexport const SectionPickerModal: TemplatePicker = ({\n  isOpen,\n  onClose,\n  templates,\n  mode = \"large\",\n}) => {\n  const templateGroups = templates;\n\n  const gridRootRef = useRef<HTMLDivElement>(null);\n\n  const templateSelected = (template: Template) => {\n    if (onClose) {\n      onClose(template);\n    }\n  };\n\n  return (\n    <Modal\n      noPadding={true}\n      title={\"Pick section\"}\n      isOpen={isOpen}\n      onRequestClose={() => {\n        if (onClose) {\n          onClose();\n        }\n      }}\n      mode={\"center-huge\"}\n      headerLine={true}\n    >\n      <ModalRoot>\n        <Sidebar>\n          {templateGroups && (\n            <SidebarContent>\n              {Object.entries(templateGroups).map(\n                ([\n                  componentId,\n                  {\n                    component: { label },\n                  },\n                ]) => (\n                  <SidebarButton\n                    key={`sectionPicker__group__${componentId}`}\n                    onClick={() => {\n                      const groupNode = document.getElementById(\n                        `sectionPicker__group__${componentId}`\n                      );\n                      const groupOffsetTop = groupNode!.offsetTop;\n                      gridRootRef.current!.scrollTo({\n                        top: groupOffsetTop,\n                        behavior: \"smooth\",\n                      });\n                    }}\n                  >\n                    {label ?? componentId}\n                  </SidebarButton>\n                )\n              )}\n            </SidebarContent>\n          )}\n        </Sidebar>\n        <GridRoot ref={gridRootRef}>\n          {templates === undefined && <Message>Loading...</Message>}\n\n          {templateGroups &&\n            Object.entries(templateGroups).map(\n              (\n                [\n                  componentId,\n                  {\n                    component: { label },\n                    templates,\n                  },\n                ],\n                index\n              ) => (\n                <div\n                  style={{ paddingTop: \"32px\", paddingBottom: \"32px\" }}\n                  id={`sectionPicker__group__${componentId}`}\n                  key={`sectionPicker__group__${componentId}`}\n                >\n                  <TitleContainer>\n                    <Title>{label ?? componentId}</Title>\n                  </TitleContainer>\n                  <ModalGridRoot mode={mode}>\n                    {templates.map((template, index) => (\n                      <SectionCard\n                        key={index}\n                        template={template}\n                        onSelect={() => {\n                          templateSelected(template);\n                        }}\n                        mode={mode}\n                      />\n                    ))}\n                  </ModalGridRoot>\n                </div>\n              )\n            )}\n        </GridRoot>\n      </ModalRoot>\n    </Modal>\n  );\n};\n","import { BasicRow, Modal } from \"@redsun-vn/easyblocks-design-system\";\nimport React, { ChangeEvent, useState } from \"react\";\nimport { useEditorContext } from \"./EditorContext\";\nimport { Template } from \"./types\";\nimport { TemplatePicker, TemplatesDictionary } from \"./TemplatePicker\";\nimport { ComponentDefinitionShared } from \"@redsun-vn/easyblocks-core\";\n\nfunction checkQueryForTemplate(\n  query: string,\n  template: Template,\n  component: ComponentDefinitionShared\n) {\n  return `${template.label ?? \"\"}${component.label ?? component.id}`\n    .toLocaleLowerCase()\n    .includes(query.trim().toLocaleLowerCase());\n}\n\nexport const SearchableSmallPickerModal: TemplatePicker = ({\n  onClose,\n  templates,\n  isOpen,\n}) => {\n  const editorContext = useEditorContext();\n\n  const templatesDict = templates;\n\n  const [query, setQuery] = useState(\"\");\n\n  const trimmedQuery = query.trim().toLocaleLowerCase();\n\n  const filteredTemplatesDict: TemplatesDictionary = {};\n\n  if (templatesDict) {\n    Object.values(templatesDict).forEach(({ templates, component }) => {\n      const filteredTemplates =\n        trimmedQuery === \"\"\n          ? templates\n          : templates.filter((template) =>\n              checkQueryForTemplate(trimmedQuery, template, component)\n            );\n\n      if (filteredTemplates.length > 0) {\n        filteredTemplatesDict[component.id] = {\n          component,\n          templates: filteredTemplates,\n        };\n      }\n    });\n  }\n\n  const close = (template?: Template) => {\n    setQuery(\"\");\n\n    if (!template) {\n      onClose();\n    } else {\n      // @ts-expect-error\n      onClose(template);\n    }\n  };\n\n  return (\n    <Modal\n      mode={\"center-small\"}\n      isOpen={isOpen}\n      onRequestClose={() => {\n        close(undefined);\n      }}\n      noPadding={true}\n      headerLine={true}\n      searchProps={{\n        value: query,\n        placeholder: \"Search...\",\n        onChange: (e: ChangeEvent<HTMLInputElement>) => {\n          setQuery(e.target.value);\n        },\n      }}\n      headerSymbol={\"S\"}\n    >\n      {templatesDict === undefined && \"Loading...\"}\n      {templatesDict !== undefined &&\n        Object.entries(filteredTemplatesDict).map(\n          ([, { templates, component }]) => {\n            const isOnlyOne = templates.length === 1;\n            const componentLabel = component.label ?? component.id;\n\n            return templates.map((template) => {\n              const templateLabel = template.label ?? template.id;\n\n              const title = isOnlyOne ? componentLabel : templateLabel;\n              const thumbnail = template.thumbnail ?? component.thumbnail;\n              const description = isOnlyOne ? undefined : componentLabel;\n\n              return (\n                <BasicRow\n                  key={template.id!}\n                  title={title}\n                  description={description}\n                  onClick={() => {\n                    close(template);\n                  }}\n                  image={thumbnail}\n                  tinyDescription={true}\n                  onEdit={\n                    template.isUserDefined\n                      ? () => {\n                          editorContext.actions.openTemplateModal({\n                            mode: \"edit\",\n                            template: template as Template,\n                          });\n                        }\n                      : undefined\n                  }\n                />\n              );\n            });\n          }\n        )}\n    </Modal>\n  );\n};\n","import {\n  Config,\n  FetchOutputResources,\n  InlineTypeWidgetComponentProps,\n  WidgetComponentProps,\n} from \"@redsun-vn/easyblocks-core\";\nimport {\n  ModalContext,\n  GlobalModalStyles,\n  Toaster,\n  TooltipProvider,\n} from \"@redsun-vn/easyblocks-design-system\";\nimport isPropValid from \"@emotion/is-prop-valid\";\nimport React, { ComponentType } from \"react\";\nimport { ShouldForwardProp, StyleSheetManager } from \"styled-components\";\nimport { Editor } from \"./Editor\";\nimport { ColorTokenWidget } from \"./sidebar/ColorTokenWidget\";\nimport { GlobalStyles } from \"./tinacms/styles\";\nimport { SpaceTokenWidget } from \"./sidebar/SpaceTokenWidget\";\nimport { parseQueryParams } from \"./parseQueryParams\";\nimport { DocumentDataWidgetComponent } from \"./sidebar/DocumentDataWidget\";\nimport { ExternalDataChangeHandler } from \"./EasyblocksEditorProps\";\nimport { TemplatePicker } from \"./TemplatePicker\";\nimport { SectionPickerModal } from \"./SectionPicker\";\nimport { SearchableSmallPickerModal } from \"./SearchableSmallPickerModal\";\n\ntype EasyblocksParentProps = {\n  config: Config;\n  externalData: FetchOutputResources;\n  onExternalDataChange: ExternalDataChangeHandler;\n  widgets?: Record<\n    string,\n    | ComponentType<WidgetComponentProps<any>>\n    | ComponentType<InlineTypeWidgetComponentProps<any>>\n  >;\n  components?: Record<string, ComponentType<any>>;\n  pickers?: Record<string, TemplatePicker>;\n  isAdminMode?: boolean;\n};\n\nconst shouldForwardProp: ShouldForwardProp<\"web\"> = (propName, target) => {\n  if (typeof target === \"string\") {\n    // For HTML elements, forward the prop if it is a valid HTML attribute\n    return isPropValid(propName);\n  }\n  // For other elements, forward all props\n  return true;\n};\n\nconst builtinWidgets: EasyblocksParentProps[\"widgets\"] = {\n  color: ColorTokenWidget,\n  space: SpaceTokenWidget,\n  \"@easyblocks/document-data\": DocumentDataWidgetComponent as any,\n};\n\nconst builinPickers: EasyblocksParentProps[\"pickers\"] = {\n  large: SectionPickerModal,\n  compact: SearchableSmallPickerModal,\n  \"large-3\": SectionPickerModal,\n};\n\nexport function EasyblocksParent(props: EasyblocksParentProps) {\n  const editorSearchParams = parseQueryParams();\n\n  return (\n    <StyleSheetManager\n      shouldForwardProp={shouldForwardProp}\n      enableVendorPrefixes\n    >\n      <ModalContext.Provider\n        value={() => {\n          return document.querySelector(\"#modalContainer\");\n        }}\n      >\n        <GlobalStyles />\n        <GlobalModalStyles />\n        <TooltipProvider>\n          <div\n            id={\"modalContainer\"}\n            style={{ position: \"fixed\", left: 0, top: 0, zIndex: 100000 }}\n          />\n          <Editor\n            config={props.config}\n            locale={editorSearchParams.locale ?? undefined}\n            readOnly={editorSearchParams.readOnly ?? true}\n            documentId={editorSearchParams.documentId}\n            rootComponentId={editorSearchParams.rootComponentId ?? null}\n            rootTemplateId={editorSearchParams.rootTemplateId}\n            externalData={props.externalData}\n            onExternalDataChange={props.onExternalDataChange}\n            widgets={{\n              ...builtinWidgets,\n              ...props.widgets,\n            }}\n            components={props.components}\n            pickers={{\n              ...builinPickers,\n              ...props.pickers,\n            }}\n            isAdminMode={props.isAdminMode}\n          />\n        </TooltipProvider>\n        <Toaster containerStyle={{ zIndex: 100100 }} />\n      </ModalContext.Provider>\n    </StyleSheetManager>\n  );\n}\n","import React, { ReactNode } from \"react\";\nimport { useEditorGlobalKeyboardShortcuts } from \"../useEditorGlobalKeyboardShortcuts\";\n\ntype CanvasRootProps = {\n  children: ReactNode;\n};\n\nfunction CanvasRoot(props: CanvasRootProps) {\n  const editorContext = window.parent.editorWindowAPI?.editorContext;\n\n  if (!editorContext) {\n    throw new Error(\"editorContext is not available.\");\n  }\n\n  useEditorGlobalKeyboardShortcuts(editorContext);\n\n  return (\n    <div\n      onClick={() => {\n        if (editorContext.isEditing) {\n          editorContext.setFocussedField([]);\n        }\n      }}\n    >\n      {editorContext.isEditing && (\n        <div style={{ minHeight: \"100vh\" }}>\n          <style\n            dangerouslySetInnerHTML={{\n              __html: globalEditorRendererStyles,\n            }}\n          />\n          {props.children}\n        </div>\n      )}\n      {!editorContext.isEditing && props.children}\n    </div>\n  );\n}\n\nconst globalEditorRendererStyles = `\n    /*\n        We don't use Tina native blocksmenu and they make page higher than document height (on the last section). So this is quick fix\n    */\n    [class^=BlocksMenu] {\n        display: none !important;\n    }\n    \n    body {\n        margin: 0;\n        padding: 0;\n        overflow-x: hidden;\n    }\n      \n  :root {\n    --tina-color-primary-light: #2296fe;\n    --tina-color-primary: #2296fe;\n    --tina-color-primary-dark: #0574e4;\n    --tina-color-error-light: #eb6337;\n    --tina-color-error: #ec4815;\n    --tina-color-error-dark: #dc4419;\n    --tina-color-warning-light: #f5e06e;\n    --tina-color-warning: #e9d050;\n    --tina-color-warning-dark: #d3ba38;\n    --tina-color-success-light: #57c355;\n    --tina-color-success: #3cad3a;\n    --tina-color-success-dark: #249a21;\n    --tina-color-grey-0: #ffffff;\n    --tina-color-grey-1: #f6f6f9;\n    --tina-color-grey-2: #edecf3;\n    --tina-color-grey-3: #e1ddec;\n    --tina-color-grey-4: #b2adbe;\n    --tina-color-grey-5: #918c9e;\n    --tina-color-grey-6: #716c7f;\n    --tina-color-grey-7: #565165;\n    --tina-color-grey-8: #433e52;\n    --tina-color-grey-9: #363145;\n    --tina-color-grey-10: #282828;\n    --tina-radius-small: 5px;\n    --tina-radius-big: 24px;\n    --tina-padding-small: 12px;\n    --tina-padding-big: 20px;\n    --tina-font-size-0: 12px;\n    --tina-font-size-1: 13px;\n    --tina-font-size-2: 15px;\n    --tina-font-size-3: 16px;\n    --tina-font-size-4: 18px;\n    --tina-font-size-5: 20px;\n    --tina-font-size-6: 22px;\n    --tina-font-size-7: 26px;\n    --tina-font-size-8: 32px;\n    --tina-font-family: 'Inter', sans-serif;\n    --tina-font-weight-regular: 400;\n    --tina-font-weight-bold: 600;\n    --tina-shadow-big: 0px 2px 3px rgba(0, 0, 0, 0.05),\n      0 4px 12px rgba(0, 0, 0, 0.1);\n    --tina-shadow-small: 0px 2px 3px rgba(0, 0, 0, 0.12);\n    --tina-timing-short: 85ms;\n    --tina-timing-medium: 150ms;\n    --tina-timing-long: 250ms;\n    --tina-z-index-0: 500;\n    --tina-z-index-1: 1000;\n    --tina-z-index-2: 1500;\n    --tina-z-index-3: 2000;\n    --tina-z-index-4: 2500;\n    --tina-z-index-5: 3000;\n    --tina-sidebar-width: 340px;\n    --tina-sidebar-header-height: 60px;\n    --tina-toolbar-height: 62px;\n    \n    \n  }\n  \n  .Shopstory__ReactModal__Overlay {\n    width: 100vw;\n    height: 100vh;\n    display: flex;\n    justify-content: center;\n    align-items: center;\n    \n  }\n  \n  .Shopstory__ReactModal__Overlay::before {\n      content: '';\n      position: absolute;\n      top: 0;\n      left: 0;\n      width: 100%;\n      height: 100%;\n      opacity: 0.2;\n      z-index: -1;\n      /* background-color: black; */\n  }\n  \n  .Shopstory__ReactModal__Overlay.background-shade::before {\n      background-color: black;\n  }\n  \n  .Shopstory__ReactModal__Content::focus {\n    border: none;\n    outline: none;\n  }\n  \n  \n  .Shopstory__ReactModal__Content__Left {\n    height: 100vh;\n    width: 70vw;\n    \n    transition: all 350ms cubic-bezier(0.16, 1, 0.3, 1);\n    transform: translateX(-100%);\n  }\n  \n  \n  .Shopstory__ReactModal__Content__Left::focus {\n    border: none;\n    outline: none;\n  }\n  \n  .Shopstory__ReactModal__Content__Left.Shopstory__ReactModal__Content__Left--after-open {\n      transform: none;\n  }\n  \n  .Shopstory__ReactModal__Content__Left.Shopstory__ReactModal__Content__Left--before-close{\n      transform: translateX(-100%);\n  }\n`;\n\nexport { CanvasRoot };\n","import type { useSortable } from \"@dnd-kit/sortable\";\nimport { selectionFramePositionChanged } from \"@redsun-vn/easyblocks-core/_internals\";\nimport { Colors } from \"@redsun-vn/easyblocks-design-system\";\nimport React, { MouseEvent, ReactNode, useEffect, useState } from \"react\";\n\ntype SelectionFrameControllerProps = {\n  isActive: boolean;\n  isChildrenSelectionDisabled: boolean;\n  onSelect: (event: MouseEvent<HTMLElement>) => void;\n  children: ReactNode;\n  stitches: any;\n  sortable: ReturnType<typeof useSortable>;\n  id: string;\n  direction: \"horizontal\" | \"vertical\";\n  path: string;\n};\n\nfunction SelectionFrameController({\n  isActive,\n  isChildrenSelectionDisabled,\n  children,\n  onSelect,\n  stitches,\n  sortable,\n  id,\n  direction,\n  path,\n}: SelectionFrameControllerProps) {\n  const [node, setNode] = useState<HTMLDivElement | null>(null);\n\n  useUpdateFramePosition({\n    node,\n    isDisabled: !isActive,\n  });\n\n  const isInsertingBefore = sortable.activeIndex > sortable.index;\n\n  const wrapperClassName = stitches.css({\n    position: \"relative\",\n    display: \"grid\",\n\n    \"&[data-children-selection-disabled=true] *\": {\n      pointerEvents: \"none !important\",\n      userSelect: \"none !important\",\n    },\n\n    \"&[data-draggable-active=false]::after\": {\n      content: `''`,\n      boxSizing: \"border-box\",\n      display: \"block\",\n      position: \"absolute\",\n      left: 0,\n      top: 0,\n      width: \"100%\",\n      height: \"100%\",\n      border: \"1px solid var(--tina-color-primary)\",\n      opacity: 0,\n      pointerEvents: \"none\",\n      userSelect: \"none\",\n      transition: \"all 100ms\",\n      boxShadow: \"var(--tina-shadow-big)\",\n      zIndex: \"var(--tina-z-index-2)\",\n    },\n\n    \"&[data-active=true]::after\": {\n      opacity: 1,\n    },\n\n    \"&:hover::after\": {\n      opacity: 0.5,\n    },\n\n    \"&[data-active=true]:hover::after\": {\n      opacity: 1,\n    },\n\n    \"&[data-draggable-over=true]::before\": {\n      position: \"absolute\",\n      ...(direction === \"horizontal\"\n        ? {\n            top: 0,\n            bottom: 0,\n            [isInsertingBefore ? \"left\" : \"right\"]: \"0px\",\n            height: \"100%\",\n            width: \"4px\",\n          }\n        : {\n            left: 0,\n            right: 0,\n            [isInsertingBefore ? \"top\" : \"bottom\"]: \"0px\",\n            width: \"100%\",\n            height: \"4px\",\n          }),\n\n      display: \"block\",\n      content: \"''\",\n      backgroundColor: Colors.blue50,\n      zIndex: 9999999,\n    },\n\n    \"&[data-draggable-active=true]\": {\n      opacity: 0.5,\n    },\n\n    \"&[data-draggable-dragging=true]\": {\n      cursor: \"grabbing\",\n    },\n  });\n\n  useEffect(() => {\n    return () => {\n      // If the the node of active element is not in the DOM anymore we want to deselect it to prevent showing\n      // add buttons on the not existing element.\n      if (\n        isActive &&\n        node &&\n        !window.document.contains(node) &&\n        path === window.parent.editorWindowAPI?.editorContext?.focussedField[0]\n      ) {\n        window.parent.editorWindowAPI.editorContext.setFocussedField([]);\n      }\n    };\n  });\n\n  return (\n    <div\n      data-active={isActive}\n      data-children-selection-disabled={isChildrenSelectionDisabled}\n      data-draggable-dragging={sortable.active !== null}\n      data-draggable-over={sortable.isOver}\n      data-draggable-active={\n        sortable.active !== null && sortable.active?.id === id\n      }\n      className={wrapperClassName().className}\n      ref={(node) => {\n        setNode(node);\n        sortable.setNodeRef(node);\n      }}\n      onClick={onSelect}\n      {...sortable.attributes}\n      {...sortable.listeners}\n    >\n      {children}\n    </div>\n  );\n}\n\nexport { SelectionFrameController };\n\nfunction useUpdateFramePosition({\n  node,\n  isDisabled,\n}: {\n  node: HTMLElement | null;\n  isDisabled: boolean;\n}) {\n  const dispatch = window.parent.postMessage;\n\n  useEffect(() => {\n    if (isDisabled || !node) {\n      return;\n    }\n\n    const updateSelectionFramePosition = createThrottledHandler(() => {\n      const nodeRect = node.getBoundingClientRect();\n\n      dispatch(\n        selectionFramePositionChanged(\n          nodeRect,\n          window.document.documentElement.getBoundingClientRect()\n        )\n      );\n    });\n\n    window.addEventListener(\"scroll\", updateSelectionFramePosition, {\n      passive: true,\n    });\n\n    const handleResize = createThrottledHandler(() => {\n      const nodeRect = node.getBoundingClientRect();\n      dispatch(selectionFramePositionChanged(nodeRect));\n    });\n\n    window.addEventListener(\"resize\", handleResize, {\n      passive: true,\n    });\n\n    const updateSelectionFramePositionInScrollableContainer =\n      createThrottledHandler((event) => {\n        const nodeRect = node.getBoundingClientRect();\n        const containerRect = (\n          event.target as HTMLElement\n        ).getBoundingClientRect();\n\n        dispatch(selectionFramePositionChanged(nodeRect, containerRect));\n      });\n\n    const closestScrollableElement = node.closest(\n      \"[data-easyblocks-scrollable-root]\"\n    );\n\n    closestScrollableElement?.addEventListener(\n      \"scroll\",\n      updateSelectionFramePositionInScrollableContainer,\n      {\n        passive: true,\n      }\n    );\n\n    dispatch(\n      selectionFramePositionChanged(\n        node.getBoundingClientRect(),\n        closestScrollableElement?.getBoundingClientRect()\n      )\n    );\n\n    return () => {\n      window.removeEventListener(\"scroll\", updateSelectionFramePosition);\n      window.removeEventListener(\"resize\", handleResize);\n      closestScrollableElement?.removeEventListener(\n        \"scroll\",\n        updateSelectionFramePositionInScrollableContainer\n      );\n    };\n  });\n}\n\n/**\n * https://developer.mozilla.org/en-US/docs/Web/API/Element/scroll_event#scroll_event_throttling\n */\nfunction createThrottledHandler(callback: (event: Event) => void) {\n  let isTicking = false;\n\n  return (event: Event) => {\n    if (isTicking) {\n      return;\n    }\n\n    requestAnimationFrame(() => {\n      callback(event);\n      isTicking = false;\n    });\n\n    isTicking = true;\n  };\n}\n","import { useDndContext } from \"@dnd-kit/core\";\nimport {\n  horizontalListSortingStrategy,\n  useSortable,\n  verticalListSortingStrategy,\n} from \"@dnd-kit/sortable\";\nimport {\n  CompiledCustomComponentConfig,\n  CompiledShopstoryComponentConfig,\n  ComponentCollectionSchemaProp,\n  SerializedRenderableComponentDefinition,\n} from \"@redsun-vn/easyblocks-core\";\nimport {\n  parsePath,\n  useEasyblocksMetadata,\n} from \"@redsun-vn/easyblocks-core/_internals\";\nimport { Colors } from \"@redsun-vn/easyblocks-design-system\";\nimport { toArray } from \"@/utils\";\nimport React, { Fragment } from \"react\";\nimport { SelectionFrameController } from \"./SelectionFrameController\";\nimport {\n  RICH_TEXT_PART_CONFIG_PATH_REGEXP,\n  isConfigPathRichTextPart,\n} from \"../utils/isConfigPathRichTextPart\";\n\ninterface BlocksControlsProps {\n  children: React.ReactNode;\n  path: string;\n  disabled?: boolean;\n  direction: \"horizontal\" | \"vertical\";\n  id: string;\n  templateId: string;\n  compiled: CompiledShopstoryComponentConfig | CompiledCustomComponentConfig;\n  index: number;\n  length: number;\n}\nexport function BlocksControls({\n  children,\n  path,\n  disabled,\n  direction,\n  id,\n  index,\n  length,\n}: BlocksControlsProps) {\n  const { focussedField, setFocussedField, form }: any =\n    window.parent.editorWindowAPI?.editorContext;\n\n  const meta = useEasyblocksMetadata();\n  const dndContext = useDndContext();\n\n  const isActive = focussedField\n    .map((focusedField: string) => {\n      // If the focused field is rich text part path, we want to show the frame around rich text parent component.\n      if (isConfigPathRichTextPart(focusedField)) {\n        return focusedField.replace(RICH_TEXT_PART_CONFIG_PATH_REGEXP, \"\");\n      }\n\n      return focusedField;\n    })\n    .includes(path);\n\n  const isChildComponentActive = focussedField.some((focusedField: string) =>\n    focusedField.startsWith(path)\n  );\n\n  const entryPathParseResult = parsePath(path, form);\n  const entryComponentDefinition = meta.vars.definitions.components.find(\n    (c) => c.id === entryPathParseResult.parent!.templateId\n  );\n\n  // component` could be draggable, but right now we only support collections.\n  const isEntryComponentOrComponentFixed =\n    entryComponentDefinition!.schema.some(\n      (s) =>\n        s.prop === entryPathParseResult.parent!.fieldName &&\n        s.type === \"component\"\n    );\n\n  const isAncestorComponentActive = focussedField.some((f: string) =>\n    entryPathParseResult.parent!.path.startsWith(f)\n  );\n\n  const isMultiSelection = focussedField.length > 1;\n\n  const isSiblingComponentActive = focussedField.some((f: string) => {\n    const pathWithoutIndexPart = path.split(\".\").slice(0, -1).join(\".\");\n    const regexp = new RegExp(`^${pathWithoutIndexPart}\\\\.\\\\d+$`);\n    return regexp.test(f);\n  });\n\n  const draggedEntryPathParseResult = dndContext.active\n    ? parsePath(dndContext.active.data.current!.path, form)\n    : null;\n\n  const draggedComponentDefinition = draggedEntryPathParseResult\n    ? meta.vars.definitions.components.find(\n        (c) => c.id === draggedEntryPathParseResult.templateId\n      )\n    : null;\n\n  const canDraggedComponentBeDropped =\n    entryComponentDefinition && draggedComponentDefinition\n      ? getAllowedComponentTypes(entryComponentDefinition).some((type) => {\n          return (\n            toArray(draggedComponentDefinition.type ?? []).includes(type) ||\n            draggedComponentDefinition.id === type\n          );\n        })\n      : true;\n\n  const isDroppableDisabled =\n    disabled ||\n    isEntryComponentOrComponentFixed ||\n    !canDraggedComponentBeDropped;\n\n  const sortable = useSortable({\n    id,\n    data: {\n      path,\n    },\n    disabled: {\n      draggable:\n        disabled ||\n        isMultiSelection ||\n        isEntryComponentOrComponentFixed ||\n        (!isActive &&\n          !isAncestorComponentActive &&\n          !isSiblingComponentActive &&\n          !isChildComponentActive),\n      droppable: isDroppableDisabled,\n    },\n    strategy:\n      direction === \"horizontal\"\n        ? horizontalListSortingStrategy\n        : verticalListSortingStrategy,\n  });\n\n  if (disabled) {\n    return <>{children}</>;\n  }\n\n  const focusOnBlock = (event: React.MouseEvent<HTMLElement>) => {\n    event.stopPropagation();\n\n    if (isActive) {\n      return;\n    } else {\n      event.preventDefault();\n    }\n\n    const closestEditableElementFromTarget = (\n      event.target as HTMLElement\n    ).closest('[contenteditable=\"true\"]');\n\n    const isActiveElementContentEditable =\n      document.activeElement?.getAttribute(\"contenteditable\") === \"true\";\n\n    // If target of event is within a content editable element we don't want to focus block.\n    // If active element is a content editable element, we also don't want to focus block.\n    // The latter is helpful when we start text selection within the content editable element\n    // and end selection outside of anchor element.\n    if (closestEditableElementFromTarget || isActiveElementContentEditable) {\n      return;\n    }\n\n    const isMultipleSelection = event.shiftKey;\n\n    function getNextFocusedField() {\n      if (isMultipleSelection) {\n        if (focussedField.includes(path)) {\n          const result = focussedField.filter(\n            (fieldName: string) => fieldName !== path\n          );\n\n          if (result.length > 0) {\n            return result;\n          }\n\n          return [];\n        }\n\n        return [...focussedField, path];\n      }\n\n      return path;\n    }\n\n    const nextFocusedField = getNextFocusedField();\n\n    setFocussedField(nextFocusedField);\n\n    if (isMultipleSelection) {\n      document.getSelection()?.removeAllRanges();\n    }\n  };\n\n  const isActivePathInDifferentCollection =\n    sortable.active &&\n    !isPathsParentEqual(sortable.active.data.current!.path, path);\n\n  return (\n    <Fragment>\n      {!isDroppableDisabled &&\n        isActivePathInDifferentCollection &&\n        sortable.activeIndex < sortable.index &&\n        index === 0 && (\n          <DroppablePlaceholder\n            id={id}\n            direction={direction}\n            path={path}\n            position=\"before\"\n          />\n        )}\n\n      <SelectionFrameController\n        isActive={isActive}\n        isChildrenSelectionDisabled={!isActive && !isChildComponentActive}\n        onSelect={focusOnBlock}\n        stitches={meta.stitches}\n        sortable={sortable}\n        id={id}\n        direction={direction}\n        path={path}\n      >\n        {children}\n      </SelectionFrameController>\n\n      {!isDroppableDisabled &&\n        isActivePathInDifferentCollection &&\n        sortable.activeIndex > sortable.index &&\n        index === length - 1 && (\n          <DroppablePlaceholder\n            id={id}\n            direction={direction}\n            path={path}\n            position=\"after\"\n          />\n        )}\n    </Fragment>\n  );\n}\n\nfunction getAllowedComponentTypes(\n  componentDefinition: SerializedRenderableComponentDefinition\n) {\n  const collectionSchemaProps =\n    componentDefinition.schema.filter<ComponentCollectionSchemaProp>(\n      (s): s is ComponentCollectionSchemaProp =>\n        s.type === \"component-collection\"\n    );\n\n  const allowedComponentTypes = collectionSchemaProps.flatMap((s) => s.accepts);\n  return Array.from(new Set(allowedComponentTypes));\n}\n\nfunction isPathsParentEqual(path1: string, path2: string) {\n  const activePathParts = path1.split(\".\");\n  const currentPathParts = path2.split(\".\");\n\n  return (\n    activePathParts.slice(0, -1).join(\".\") ===\n    currentPathParts.slice(0, -1).join(\".\")\n  );\n}\n\nfunction DroppablePlaceholder({\n  id,\n  direction,\n  path,\n  position,\n}: {\n  id: string;\n  direction: string;\n  path: string;\n  position: \"before\" | \"after\";\n}) {\n  const meta = useEasyblocksMetadata();\n\n  const sortable = useSortable({\n    id: `${id}.${position}`,\n    data: {\n      path,\n    },\n    disabled: {\n      draggable: true,\n      droppable: false,\n    },\n  });\n\n  const isInsertingBefore = sortable.activeIndex > sortable.index;\n\n  const wrapperStyles = meta.stitches.css({\n    position: \"absolute\",\n    [position === \"before\" ? \"top\" : \"bottom\"]:\n      direction === \"vertical\" ? \"-100%\" : 0,\n    [position === \"before\" ? \"left\" : \"right\"]:\n      direction === \"horizontal\" ? \"-100%\" : 0,\n    height: \"100%\",\n    background: \"transparent\",\n    width: \"100%\",\n\n    \"&::before\": {\n      display: \"block\",\n      content: \"''\",\n      backgroundColor: Colors.blue50,\n      zIndex: 9999999,\n      position: \"absolute\",\n      opacity: 0,\n    },\n    \"&[data-draggable-over=true]::before\": {\n      opacity: 1,\n      ...(direction === \"horizontal\"\n        ? {\n            top: 0,\n            bottom: 0,\n            [isInsertingBefore ? \"left\" : \"right\"]: \"0px\",\n            height: \"100%\",\n            width: \"4px\",\n          }\n        : {\n            left: 0,\n            right: 0,\n            [isInsertingBefore ? \"top\" : \"bottom\"]: \"0px\",\n            width: \"100%\",\n            height: \"4px\",\n          }),\n    },\n  });\n\n  return (\n    <div\n      data-draggable-over={sortable.isOver}\n      className={wrapperStyles().className}\n      ref={sortable.setNodeRef}\n      {...sortable.attributes}\n      {...sortable.listeners}\n    />\n  );\n}\n","import {\n  ComponentBuilder,\n  ComponentBuilderProps,\n} from \"@redsun-vn/easyblocks-core/_internals\";\nimport React from \"react\";\nimport { BlocksControls } from \"./BlockControls\";\n\ntype EditableComponentBuilderProps = ComponentBuilderProps & {\n  index: number;\n  length: number;\n};\n\nfunction EditableComponentBuilder(props: EditableComponentBuilderProps) {\n  const { path, compiled, index, length, components, ...restPassedProps } =\n    props;\n\n  const content = (\n    <BlocksControls\n      path={path}\n      id={compiled._id}\n      templateId={compiled._component}\n      disabled={compiled.__editing?.noInline}\n      direction={compiled.__editing?.direction ?? \"vertical\"}\n      compiled={compiled}\n      index={index}\n      length={length}\n    >\n      <ComponentBuilder\n        compiled={compiled}\n        path={path}\n        passedProps={restPassedProps}\n        components={components}\n      />\n    </BlocksControls>\n  );\n\n  return content;\n}\n\nexport default EditableComponentBuilder;\n","import { useDndContext } from \"@dnd-kit/core\";\nimport { useSortable } from \"@dnd-kit/sortable\";\nimport { PlaceholderAppearance } from \"@redsun-vn/easyblocks-core\";\nimport {\n  parsePath,\n  useEasyblocksMetadata,\n} from \"@redsun-vn/easyblocks-core/_internals\";\nimport { Colors, Fonts } from \"@redsun-vn/easyblocks-design-system\";\nimport { toArray } from \"@/utils\";\nimport React from \"react\";\nimport { EditorContextType } from \"./EditorContext\";\n\ntype PlaceholderProps = {\n  onClick: () => void;\n  appearance: PlaceholderAppearance;\n  meta: any;\n  sortable: ReturnType<typeof useSortable>;\n};\n\nfunction Placeholder(props: PlaceholderProps) {\n  const { stitches } = useEasyblocksMetadata();\n  const styles: Record<string, any> = {};\n\n  const { aspectRatio, width, height, label } = props.appearance;\n\n  if (height) {\n    styles.height = `${height}px`;\n  } else if (aspectRatio) {\n    styles.paddingBottom = `${(1 / aspectRatio) * 100}%`;\n  }\n\n  const rootClassName = stitches.css({\n    border: `1px dashed ${Colors.blue50}`,\n    position: \"relative\",\n    width: `${width ? `${width}px` : \"auto\"}`,\n    height: \"auto\",\n    transition: \"all 0.1s\",\n  });\n\n  const contentClassName = stitches.css({\n    position: \"absolute\",\n    top: 0,\n    left: 0,\n    width: \"100%\",\n    height: \"100%\",\n    display: \"flex\",\n    color: Colors.blue50,\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    cursor: \"pointer\",\n    ...Fonts.body,\n    \"&:hover\": {\n      backgroundColor: Colors.blue10,\n    },\n    \"&[data-draggable-over=true]\": {\n      backgroundColor: Colors.blue10,\n    },\n    \"&[data-draggable-dragging=true]\": {\n      cursor: \"grabbing\",\n    },\n  });\n\n  const content = (\n    <div\n      className={contentClassName()}\n      onClick={(event) => {\n        event.stopPropagation();\n        props.onClick();\n      }}\n      data-draggable-over={props.sortable.isOver}\n      data-draggable-dragging={props.sortable.active !== null}\n    >\n      <svg\n        width=\"15\"\n        height=\"15\"\n        viewBox=\"0 0 15 15\"\n        fill=\"none\"\n        xmlns=\"http://www.w3.org/2000/svg\"\n        style={{ color: Colors.blue50 }}\n      >\n        <path\n          d=\"M8 2.75C8 2.47386 7.77614 2.25 7.5 2.25C7.22386 2.25 7 2.47386 7 2.75V7H2.75C2.47386 7 2.25 7.22386 2.25 7.5C2.25 7.77614 2.47386 8 2.75 8H7V12.25C7 12.5261 7.22386 12.75 7.5 12.75C7.77614 12.75 8 12.5261 8 12.25V8H12.25C12.5261 8 12.75 7.77614 12.75 7.5C12.75 7.22386 12.5261 7 12.25 7H8V2.75Z\"\n          fill=\"currentColor\"\n          fillRule=\"evenodd\"\n          clipRule=\"evenodd\"\n        ></path>\n      </svg>\n      {label && <span>&nbsp;&nbsp;{label}</span>}\n    </div>\n  );\n\n  return (\n    <div\n      className={rootClassName()}\n      ref={props.sortable.setDroppableNodeRef}\n      {...props.sortable.attributes}\n      {...props.sortable.listeners}\n    >\n      <div\n        style={{\n          position: \"relative\",\n          width: \"100%\",\n          ...styles,\n        }}\n      ></div>\n      {content}\n    </div>\n  );\n}\n\ntype TypePlaceholderComponentBuilderProps = {\n  id: string;\n  path: string;\n  appearance?: PlaceholderAppearance;\n  type: string;\n  onClick: () => void;\n  meta: any;\n};\n\nexport default function TypePlaceholder(\n  props: TypePlaceholderComponentBuilderProps\n) {\n  const { form } =\n    (window.parent.editorWindowAPI?.editorContext as EditorContextType) || {};\n  const meta = useEasyblocksMetadata();\n  const dndContext = useDndContext();\n\n  const draggedEntryPathParseResult = dndContext.active\n    ? parsePath(dndContext.active.data.current!.path, form)\n    : null;\n\n  const draggedComponentDefinition = draggedEntryPathParseResult\n    ? meta.vars.definitions.components.find(\n        (c) => c.id === draggedEntryPathParseResult.templateId\n      )\n    : null;\n\n  const canDraggedComponentBeDropped = draggedComponentDefinition\n    ? toArray(draggedComponentDefinition.type ?? []).includes(props.type)\n    : true;\n\n  const sortable = useSortable({\n    id: `placeholder.${props.id}`,\n    data: {\n      path: props.path,\n    },\n    disabled: {\n      draggable: true,\n      droppable: !canDraggedComponentBeDropped,\n    },\n  });\n\n  const { type } = props;\n\n  let appearance: PlaceholderAppearance;\n\n  if (props.appearance) {\n    appearance = props.appearance;\n  } else {\n    if (type === \"section\") {\n      appearance = {\n        label: \"Add section\",\n        aspectRatio: 3.2,\n      };\n    } else if (type === \"card\") {\n      appearance = {\n        label: \"Add card\",\n        aspectRatio: 0.7,\n      };\n    } else if (type === \"button\") {\n      appearance = {\n        label: \"Add button\",\n        width: 250,\n        height: 50,\n      };\n    } else if (type === \"item\") {\n      appearance = {\n        label: \"Add item\",\n        // width: 250,\n        height: 50,\n      };\n    } else if (type === \"image\") {\n      appearance = {\n        label: \"Add image\",\n        aspectRatio: 1,\n      };\n    } else if (type === \"icon\") {\n      appearance = {\n        label: \"Pick icon\",\n        width: 50,\n        height: 50,\n      };\n    } else {\n      appearance = {\n        label: \"Add\",\n        width: 50,\n        aspectRatio: 1,\n      };\n    }\n  }\n\n  return (\n    <Placeholder\n      appearance={appearance}\n      onClick={props.onClick}\n      meta={props.meta}\n      sortable={sortable}\n    />\n  );\n}\n","import {\n  CollisionDetection,\n  DndContext,\n  MouseSensor,\n  pointerWithin,\n  rectIntersection,\n  useSensor,\n} from \"@dnd-kit/core\";\nimport { SortableContext } from \"@dnd-kit/sortable\";\nimport { NoCodeComponentEntry, Easyblocks } from \"@redsun-vn/easyblocks-core\";\nimport {\n  EasyblocksMetadataProvider,\n  EditorContextType,\n  RichTextEditor,\n  TextEditor,\n  configTraverse,\n  itemMoved,\n} from \"@redsun-vn/easyblocks-core/_internals\";\nimport { useForceRerender } from \"@/utils\";\nimport React, { useEffect, useRef, useState } from \"react\";\nimport { z } from \"zod\";\nimport { CanvasRoot } from \"./CanvasRoot/CanvasRoot\";\nimport EditableComponentBuilder from \"./EditableComponentBuilder/EditableComponentBuilder.editor\";\nimport TypePlaceholder from \"./Placeholder\";\n\nconst dragDataSchema = z.object({\n  path: z.string(),\n  sortable: z.object({\n    index: z.number(),\n  }),\n});\n\nfunction customCollisionDetection(args: Parameters<CollisionDetection>[0]) {\n  // First, let's see if there are any collisions with the pointer\n  const pointerCollisions = pointerWithin(args);\n\n  // Collision detection algorithms return an array of collisions\n  if (pointerCollisions.length > 0) {\n    return pointerCollisions;\n  }\n\n  // If there are no collisions with the pointer, return rectangle intersections\n  return rectIntersection(args);\n}\n\nexport function EasyblocksCanvas({\n  components,\n}: {\n  components?: Record<string, React.ComponentType<any>>;\n}) {\n  const { meta, compiled, externalData, editorContext }: any =\n    window.parent.editorWindowAPI;\n\n  const [enabled, setEnabled] = useState(false);\n  const activeDraggedEntryPath = useRef<string | null>(null);\n  const { forceRerender } = useForceRerender();\n  const mouseSensor = useSensor(MouseSensor, {\n    activationConstraint: {\n      distance: 10,\n    },\n  });\n\n  useEffect(() => {\n    if (window.self === window.top) {\n      throw new Error(\"No host\");\n    } else {\n      setEnabled(true);\n    }\n  }, []);\n\n  useEffect(() => {\n    if (window.parent && window.parent.editorWindowAPI) {\n      window.parent.editorWindowAPI.onUpdate = () => {\n        // Force re-render when child gets info from parent that data changed\n        forceRerender();\n      };\n    }\n  });\n\n  const shouldNotRender = !enabled || !meta || !compiled || !externalData;\n\n  if (shouldNotRender) {\n    return <div>Loading...</div>;\n  }\n\n  const sortableItems = getSortableItems(\n    editorContext.form.values,\n    editorContext\n  );\n\n  return (\n    /* EasyblocksMetadataProvider must be defined in case of nested <Easyblocks /> components are used! */\n    <EasyblocksMetadataProvider meta={meta}>\n      <CanvasRoot>\n        <DndContext\n          sensors={[mouseSensor]}\n          collisionDetection={customCollisionDetection}\n          onDragStart={(event) => {\n            document.documentElement.style.cursor = \"grabbing\";\n            activeDraggedEntryPath.current = dragDataSchema.parse(\n              event.active.data.current\n            ).path;\n            window.parent.editorWindowAPI?.editorContext?.setFocussedField([]);\n          }}\n          onDragEnd={(event) => {\n            document.documentElement.style.cursor = \"\";\n            const activeData = dragDataSchema.parse(event.active.data.current);\n\n            if (event.over) {\n              const overData = dragDataSchema.parse(event.over.data.current);\n\n              if (event.over.id === event.active.id) {\n                // If the dragged item is dropped on itself, we want to refocus the dragged item.\n                window.parent.editorWindowAPI?.editorContext?.setFocussedField(\n                  activeData.path\n                );\n              } else {\n                const itemMovedEvent = itemMoved({\n                  fromPath: activeData.path,\n                  toPath: overData.path,\n                  placement: ifValidPlacement(\n                    event.over.id.toString().split(\".\")[1]\n                  ),\n                });\n\n                requestAnimationFrame(() => {\n                  window.parent.postMessage(itemMovedEvent);\n                });\n              }\n            } else {\n              // If there was no drop target, we want to refocus the dragged item.\n              window.parent.editorWindowAPI?.editorContext?.setFocussedField(\n                activeData.path\n              );\n            }\n          }}\n          onDragCancel={(event) => {\n            document.documentElement.style.cursor = \"\";\n            // If the drag was canceled, we want to refocus dragged item.\n            window.parent.editorWindowAPI?.editorContext?.setFocussedField(\n              dragDataSchema.parse(event.active.data.current).path\n            );\n          }}\n        >\n          <SortableContext items={sortableItems}>\n            <Easyblocks\n              renderableDocument={{\n                renderableContent: compiled,\n                meta,\n              }}\n              externalData={externalData}\n              components={{\n                ...components,\n                \"@easyblocks/rich-text.editor\": RichTextEditor,\n                \"@easyblocks/text.editor\": TextEditor,\n                \"EditableComponentBuilder.editor\": EditableComponentBuilder,\n                Placeholder: TypePlaceholder,\n              }}\n            />\n          </SortableContext>\n        </DndContext>\n      </CanvasRoot>\n    </EasyblocksMetadataProvider>\n  );\n}\n\nfunction getSortableItems(\n  rootNoCodeEntry: NoCodeComponentEntry,\n  editorContext: EditorContextType\n) {\n  const sortableItems: Array<string> = [];\n\n  configTraverse(\n    rootNoCodeEntry,\n    editorContext,\n    ({ value, schemaProp, config }) => {\n      if (schemaProp.type === \"component-collection\") {\n        if (value.length === 0) {\n          sortableItems.push(`placeholder.${config._id}`);\n          return;\n        }\n\n        sortableItems.push(`${value[0]._id}.before`);\n        sortableItems.push(\n          ...(value as Array<NoCodeComponentEntry>).map((v) => v._id)\n        );\n        sortableItems.push(`${value.at(-1)._id}.after`);\n      }\n    }\n  );\n\n  return sortableItems;\n}\nfunction ifValidPlacement(value: string): \"before\" | \"after\" | undefined {\n  if (value === \"before\" || value === \"after\") {\n    return value;\n  }\n\n  return;\n}\n","import {\n  RequestedExternalData,\n  Easyblocks,\n  getDefaultLocale,\n  type RenderableDocument,\n} from \"@redsun-vn/easyblocks-core\";\nimport React, { useEffect, useState } from \"react\";\nimport { parseQueryParams } from \"./parseQueryParams\";\nimport { EasyblocksEditorProps } from \"./EasyblocksEditorProps\";\nimport { serialize } from \"@/utils\";\n\nexport const PreviewRenderer: React.FC<EasyblocksEditorProps> = (props) => {\n  const config = props.config;\n\n  const [data, setData] = useState<{\n    renderableDocument: RenderableDocument;\n    externalData: RequestedExternalData;\n  } | null>(null);\n\n  const [width, setWidth] = useState<number>(-1);\n  const [widthAuto, setWidthAuto] = useState<boolean>(false);\n\n  useEffect(() => {\n    const { documentId, templateId, locale } = parseQueryParams();\n\n    let mode: \"template\" | \"document\";\n\n    if (documentId && templateId) {\n      console.warn(\n        `'template' parameter ignored because 'document' parameter is specified`\n      );\n      mode = \"document\";\n    } else if (!documentId && templateId) {\n      mode = \"template\";\n    } else if (documentId && !templateId) {\n      mode = \"document\";\n    } else {\n      throw new Error(\n        \"You must specify 'document' or 'template' parameter in preview mode\"\n      );\n    }\n\n    const localeWithDefault =\n      locale ?? getDefaultLocale(config.locales ?? []).code;\n\n    (async () => {\n      const { buildDocument, buildEntry } = await import(\n        \"@redsun-vn/easyblocks-core\"\n      );\n\n      if (mode === \"document\") {\n        const { renderableDocument, externalData } = await buildDocument({\n          documentId: documentId!,\n          config,\n          locale: localeWithDefault,\n        });\n\n        props.onExternalDataChange?.(externalData, {\n          locale: localeWithDefault,\n        });\n\n        setData({\n          renderableDocument,\n          externalData,\n        });\n      } else {\n        const template = await config.backend.templates.get({\n          id: templateId!,\n        });\n\n        const { renderableContent, meta, externalData } = buildEntry({\n          entry: {\n            ...template.entry,\n            _itemProps: {},\n          },\n          config,\n          locale: localeWithDefault,\n        });\n\n        props.onExternalDataChange?.(externalData, {\n          locale: localeWithDefault,\n        });\n\n        setWidth(template.width ?? -1);\n        setWidthAuto(template.widthAuto ?? false);\n\n        setData({\n          renderableDocument: {\n            renderableContent,\n            meta: serialize(meta),\n          },\n          externalData,\n        });\n      }\n    })();\n  }, []);\n\n  if (!data) {\n    return null;\n  }\n\n  const requestedExternalDataLength = Object.keys(data.externalData).length;\n  const givenExternalDataLength = Object.keys(props.externalData ?? {}).length;\n\n  if (requestedExternalDataLength !== givenExternalDataLength) {\n    return null;\n  }\n\n  return (\n    <div\n      style={{\n        position: \"relative\",\n        display: widthAuto ? \"inline-flex\" : \"block\",\n        maxWidth: width === -1 ? \"auto\" : `${width}px`,\n      }}\n      id={\"__easyblocks-preview-container\"}\n    >\n      <Easyblocks\n        renderableDocument={data.renderableDocument}\n        externalData={props.externalData}\n        components={props.components}\n      />\n    </div>\n  );\n};\n","import { Config } from \"@redsun-vn/easyblocks-core\";\n\nconst validate = (value: any) => {\n  return (\n    typeof value === \"string\" &&\n    (value.startsWith(\"http://\") || value.startsWith(\"https://\"))\n  );\n};\n\nexport const debugTypes: Config[\"types\"] = {\n  debug_url_inline_never: {\n    type: \"inline\",\n    defaultValue: \"https://google.com\",\n    responsiveness: \"never\",\n    widget: { id: \"debug_url\", label: \"Debug URL\" },\n    validate,\n  },\n  debug_url_inline_optional: {\n    type: \"inline\",\n    defaultValue: \"https://google.com\",\n    responsiveness: \"optional\",\n    widget: { id: \"debug_url\", label: \"Debug URL\" },\n    validate,\n  },\n  debug_url_inline_always: {\n    type: \"inline\",\n    defaultValue: \"https://google.com\",\n    responsiveness: \"always\",\n    widget: { id: \"debug_url\", label: \"Debug URL\" },\n    validate,\n  },\n  debug_url_token_never: {\n    type: \"token\",\n    token: \"debug_urls\",\n    responsiveness: \"never\",\n    defaultValue: { tokenId: \"google\" },\n    widget: { id: \"debug_url\", label: \"Debug URL\" },\n    allowCustom: false,\n    validate,\n  },\n  debug_url_token_optional_no_custom: {\n    type: \"token\",\n    token: \"debug_urls\",\n    responsiveness: \"optional\",\n    defaultValue: { tokenId: \"google\" },\n    widget: { id: \"debug_url\", label: \"Debug URL\" },\n    allowCustom: false,\n    validate,\n  },\n  debug_url_token_optional_custom: {\n    type: \"token\",\n    token: \"debug_urls\",\n    responsiveness: \"optional\",\n    defaultValue: { tokenId: \"google\" },\n    widget: { id: \"debug_url\", label: \"Debug URL\" },\n    allowCustom: true,\n    validate,\n  },\n  debug_url_token_always_no_custom: {\n    type: \"token\",\n    token: \"debug_urls\",\n    responsiveness: \"always\",\n    defaultValue: { tokenId: \"google\" },\n    widget: { id: \"debug_url\", label: \"Debug URL\" },\n    allowCustom: false,\n    validate,\n  },\n  debug_url_token_always_custom: {\n    type: \"token\",\n    token: \"debug_urls\",\n    responsiveness: \"always\",\n    defaultValue: { tokenId: \"google\" },\n    widget: { id: \"debug_url\", label: \"Debug URL\" },\n    allowCustom: true,\n    validate,\n  },\n};\n","import { NoCodeComponentDefinition } from \"@redsun-vn/easyblocks-core\";\n\nexport const debugSectionDefinition: NoCodeComponentDefinition = {\n  id: \"DebugSection\",\n  schema: [\n    {\n      prop: \"inline_never\",\n      label: \"Never\",\n      type: \"debug_url_inline_never\",\n      group: \"Inline\",\n    },\n    {\n      prop: \"inline_optional_disabled\",\n      label: \"Optional (off)\",\n      type: \"debug_url_inline_optional\",\n      responsive: false,\n      group: \"Inline\",\n    },\n    {\n      prop: \"inline_optional_enabled\",\n      label: \"Optional (on)\",\n      type: \"debug_url_inline_optional\",\n      responsive: true,\n      group: \"Inline\",\n    },\n    {\n      prop: \"inline_always\",\n      label: \"Always\",\n      type: \"debug_url_inline_always\",\n      group: \"Inline\",\n    },\n\n    {\n      prop: \"token_never\",\n      label: \"Never\",\n      type: \"debug_url_token_never\",\n      group: \"Token - custom\",\n    },\n    {\n      prop: \"token_optional_disabled_custom\",\n      label: \"Optional (off)\",\n      type: \"debug_url_token_optional_custom\",\n      responsive: false,\n      group: \"Token - custom\",\n    },\n    {\n      prop: \"token_optional_enabled_custom\",\n      label: \"Optional (on)\",\n      type: \"debug_url_token_optional_custom\",\n      responsive: true,\n      group: \"Token - custom\",\n    },\n    {\n      prop: \"token_always_custom\",\n      label: \"Always\",\n      type: \"debug_url_token_always_custom\",\n      group: \"Token - custom\",\n    },\n\n    {\n      prop: \"token_optional_disabled_no_custom\",\n      label: \"Optional (off)\",\n      type: \"debug_url_token_optional_no_custom\",\n      responsive: false,\n      group: \"Token - no custom\",\n    },\n    {\n      prop: \"token_optional_enabled_no_custom\",\n      label: \"Optional (on)\",\n      type: \"debug_url_token_optional_no_custom\",\n      responsive: true,\n      group: \"Token - no custom\",\n    },\n    {\n      prop: \"token_always_no_custom\",\n      label: \"Always\",\n      type: \"debug_url_token_always_no_custom\",\n      group: \"Token - no custom\",\n    },\n  ],\n  type: \"section\",\n};\n","import { Config } from \"@redsun-vn/easyblocks-core\";\n\nexport const debugTokens: Config[\"tokens\"] = {\n  debug_urls: [\n    {\n      id: \"google\",\n      value: \"https://google.com\",\n    },\n    {\n      id: \"bing\",\n      value: \"https://bing.com\",\n    },\n  ],\n};\n","import React from \"react\";\n\nfunction DebugSection({\n  inline_never,\n  inline_optional_disabled,\n  inline_optional_enabled,\n  inline_always,\n  token_never,\n  token_optional_disabled_no_custom,\n  token_optional_enabled_no_custom,\n  token_optional_disabled_custom,\n  token_optional_enabled_custom,\n  token_always_no_custom,\n  token_always_custom,\n}: Record<string, any>) {\n  return (\n    <div>\n      <pre>\n        {JSON.stringify(\n          {\n            inline_never,\n            inline_optional_disabled,\n            inline_optional_enabled,\n            inline_always,\n            token_never,\n            token_optional_disabled_no_custom,\n            token_optional_enabled_no_custom,\n            token_optional_disabled_custom,\n            token_optional_enabled_custom,\n            token_always_no_custom,\n            token_always_custom,\n          },\n          null,\n          2\n        )}\n      </pre>\n    </div>\n  );\n}\n\nexport { DebugSection };\n","import React from \"react\";\nimport { InlineTypeWidgetComponentProps } from \"@redsun-vn/easyblocks-core\";\nimport { useEffect, useState } from \"react\";\nimport { Input } from \"@redsun-vn/easyblocks-design-system\";\n\nexport function DebugUrlWidget(props: InlineTypeWidgetComponentProps<string>) {\n  const [active, setActive] = useState(false);\n  const [value, setValue] = useState(props.value);\n\n  useEffect(() => {\n    if (!active) {\n      setValue(props.value);\n    }\n  });\n\n  return (\n    <Input\n      value={value}\n      onChange={(event) => {\n        setActive(true);\n        setValue(event.target.value);\n      }}\n      onBlur={() => {\n        setActive(false);\n        props.onChange(value);\n      }}\n      align={\"right\"}\n    />\n  );\n}\n","import { EasyblocksEditorProps } from \"../EasyblocksEditorProps\";\nimport { debugTypes } from \"./debugTypes\";\nimport { debugSectionDefinition } from \"./DebugSection/DebugSection.definition\";\nimport { debugTokens } from \"./debugTokens\";\nimport { DebugSection } from \"./DebugSection/DebugSection\";\nimport { DebugUrlWidget } from \"./DebugUrlWidget\";\n\nexport function addDebugToEditorProps(\n  props: EasyblocksEditorProps\n): EasyblocksEditorProps {\n  return {\n    ...props,\n    config: {\n      ...props.config,\n      types: {\n        ...props.config.types,\n        ...debugTypes,\n      },\n      components: [...(props.config.components ?? []), debugSectionDefinition],\n      tokens: {\n        ...props.config.tokens,\n        ...debugTokens,\n      },\n    },\n    components: {\n      ...props.components,\n      DebugSection,\n    },\n    widgets: {\n      ...props.widgets,\n      debug_url: DebugUrlWidget,\n    },\n  };\n}\n","import React, { useEffect, useState } from \"react\";\nimport { EasyblocksEditorProps } from \"./EasyblocksEditorProps\";\nimport { EasyblocksParent } from \"./EasyblocksParent\";\nimport { EasyblocksCanvas } from \"./EditorChildWindow\";\nimport { PreviewRenderer } from \"./PreviewRenderer\";\nimport { addDebugToEditorProps } from \"./debug/addDebugToEditorProps\";\nimport { parseQueryParams } from \"./parseQueryParams\";\n\n// Extend the Window interface to include isShopstoryEditor\ndeclare global {\n  interface Window {\n    isShopstoryEditor?: boolean;\n  }\n}\n\nexport function EasyblocksEditor(props: EasyblocksEditorProps) {\n  const [selectedWindow, setSelectedWindow] = useState<\n    \"parent\" | \"child\" | \"preview\" | null\n  >(null);\n\n  const setSelectedWindowToParent = () => {\n    window.isShopstoryEditor = true;\n    setSelectedWindow(\"parent\");\n  };\n\n  useEffect(() => {\n    if (parseQueryParams().preview) {\n      setSelectedWindow(\"preview\");\n      return;\n    }\n\n    const setSelectedWindowToChild = () => {\n      setSelectedWindow(\"child\");\n    };\n\n    if (selectedWindow === null) {\n      /**\n       * Why try catch?\n       *\n       * It's because window.parent.isShopstoryEditor might throw if window.parent is cross origin (when shopstory Launcher is run in iframe of CMS - like Contentful); In that case we're sure it's a parent window, not a child.\n       */\n      try {\n        // Parent window is always rendered first so `window.isShopstoryEditor` will always be set when <iframe /> with child is loading\n        if (window.parent !== window.self && window.parent.isShopstoryEditor) {\n          setSelectedWindowToChild();\n        } else {\n          setSelectedWindowToParent();\n        }\n      } catch (error) {\n        setSelectedWindowToParent();\n      }\n    }\n  }, []);\n\n  if (!selectedWindow) {\n    return null;\n  }\n\n  if (parseQueryParams().debug) {\n    props = addDebugToEditorProps(props);\n  }\n\n  return (\n    <>\n      {selectedWindow === \"parent\" && (\n        <EasyblocksParent\n          config={props.config}\n          externalData={props.externalData ?? {}}\n          onExternalDataChange={props.onExternalDataChange ?? (() => ({}))}\n          widgets={props.widgets}\n          components={props.components}\n          pickers={props.pickers}\n          isAdminMode={props.isAdminMode}\n        />\n      )}\n\n      {selectedWindow === \"child\" && (\n        <EasyblocksCanvas components={props.components} />\n      )}\n\n      {selectedWindow === \"preview\" && <PreviewRenderer {...props} />}\n    </>\n  );\n}\n"],"names":["EditorContext","React","createContext","useEditorContext","context","useContext","Error","last","collection","length","toArray","scalarOrCollection","Array","isArray","takeNumbers","path","split","map","x","parseInt","filter","Number","isNaN","preOrderPathComparator","direction","arguments","undefined","pathA","pathB","order","numbersA","numbersB","numberALength","numberBLength","shorterLength","Math","min","index","valueA","valueB","sign","includesAny","a","b","some","i","includes","deepClone","source","JSON","parse","stringify","deepCompare","currentObject","sortObject","nextObject","areObjectsHashesEqual","value","sort","sortedObject","objectKeys","Object","keys","forEach","key","useForceRerender","setDummyState","useState","forceRerender","useRef","current","dotNotationGet","obj","reduce","acc","curVal","serialize","getOwnPropertyNames","sleep","ms","Promise","resolve","setTimeout","uniqueId","id","replace","c","r","random","v","toString","assertDefined","message","ConfigAfterAutoContext","useConfigAfterAuto","configAfterAutoContext","ExternalDataContext","EditorExternalDataProvider","_ref","children","externalData","createElement","Provider","useEditorExternalData","ExtraKeys","actionKeys","ALT_KEY","CTRL_KEY","META_KEY","SHIFT_KEY","useWindowKeyDown","callback","extraKeys","isDisabled","downHandler","event","isExtraKeysPressed","every","k","extraKeysSet","Set","isOtherExtraKeysPressed","has","preventDefault","useEffect","document","getElementsByTagName","contentWindow","window","body","addEventListener","removeEventListener","EditorIframe","onEditorHistoryRedo","onEditorHistoryUndo","width","height","transform","containerRef","isIframeReady","setIframeReady","handleIframeLoaded","IframeContainer","ref","IframeInnerContainer","Iframe","src","location","href","onLoad","style","styled","div","withConfig","displayName","componentId","Colors","black100","iframe","pathToCompiledPath","editorContext","pathInfo","parsePath","form","parent","definition","findComponentDefinitionById","templateId","schemaProp","schema","find","prop","fieldName","result","getPropertyNameFromSchemaProp","startsWith","substring","isSchemaPropTextModifier","isSchemaPropActionTextModifier","isFieldPortal","buildTinaFields","internalBuildTinaFields","fieldsFilter","compiledPath","stripRichTextPartSelection","compiledComponent","compiledComponentConfig","allFields","__editing","fields","field","item","portal","portalComponentFields","push","includeHeader","groups","group","hidden","portalFieldFields","console","warn","_component","portalField","overrides","sources","flatMap","firstField","combinedField","name","nonAnalyticsFields","analyticsFields","copyToClipboard","textToCopy","navigator","clipboard","isSecureContext","writeText","textArea","position","left","prepend","select","execCommand","error","remove","IdWrapper","Fonts","black40","SidebarFooter","props","toaster","useToaster","isAdminMode","paths","values","compiledValue","widthInfo","xl","widthAuto","auto","findComponentDefinition","isSaveable","allowSave","showSaveAsTemplate","readOnly","disableCustomTemplates","_id","ButtonSecondary","onClick","actions","openTemplateModal","mode","config","paddingTop","ButtonPrimary","success","_master","Toggle","input","disabled","checked","toggleProps","labels","ToggleFieldWrapper","DesignSystemToggle","MIXED_VALUE","COMPONENTS_SUPPORTING_MIXED_VALUES","isMixedFieldValue","__mixed__","SelectFieldComponent","options","onChange","isMixedValue","selectOptions","normalizedSelectOptions","toProps","unshift","label","isDivider","inputValue","handleChange","Select","toComponent","option","SelectSeparator","SelectItem","RadioGroup","radioOptions","toggleButtonValue","radioOptionsMapped","SelectInline","_extends","Icon","icon","Icons","ToggleButton","hideLabel","NumberInput","step","max","Input","type","Tooltip","forwardRef","rest","createPortal","zIndex","TooltipBody","TooltipArrow","useTooltip","isOpen","setIsOpen","triggerElement","setTriggerElement","tooltipElement","setTooltipElement","arrowElement","setArrowElement","styles","attributes","usePopper","strategy","placement","modifiers","element","padding","tooltipTrigger","useTooltipTrigger","delay","open","close","triggerProps","tooltipProps","popper","arrowProps","arrow","FieldMetaWrapper","noWrap","layout","renderLabel","isLabelHidden","configAfterAuto","runChange","focussedField","isMixedValueSupported","isMixedValueSupportedByComponent","isResponsiveField","subComponent","component","fieldNames","handleButtonMixedClick","_","names","firstFieldValue","change","resolvedLayout","content","display","alignItems","flexDirection","TextButton","variant","color","isExternalField","isExternalSchemaProp","types","componentPaths","slice","join","fieldValues","f","configs","externalValues","getExternalReferenceLocationKey","isTrulyResponsiveValue","responsiveValueFindDeviceWithDefinedValue","breakpointIndex","devices","currentBreakpointFieldValues","responsiveValueForceGet","isLoadingExternalValue","isEmptyExternalReference","isIdReferenceToDocumentExternalValue","FieldWrapper","margin","FieldLabelWrapper","isFullWidth","FieldLabel","htmlFor","isError","lineHeight","overflow","textOverflow","description","marginLeft","Loader","WidgetsSelect","widgetId","newFieldValue","isRootComponent","FieldInputWrapper","FieldError","_ref2","selectedWidgetId","setSelectedWidgetId","widgets","availableWidgets","w","FieldLabelIconWrapper","widget","Typography","wrapFieldsWithMeta","Field","extraProps","_ref3","_ref4","_ref5","css","_ref6","_ref7","span","_ref8","NumberField","BaseNumberField","NumberFieldPlugin","Component","SelectField","SelectFieldPlugin","RadioGroupField","RadioGroupFieldPlugin","TextField","restInputProperties","inputProps","useTextValue","contextParams","locale","locales","placeholder","normalize","isTextSchemaProp","controlSize","align","withBorder","TextFieldPlugin","ToggleField","ToggleFieldPlugin","CUSTOM_OPTION_VALUE","extraValuesIncludes","extraValues","extraValue","useTokenTypes","tokenTypes","fromEntries","entries","typeDefinitionEntry","TokenFieldComponent","tokenTypeDefinition","normalizeCustomValue","allowCustom","setInputValue","customValueTextFieldRef","tokens","tokenId","tokenValue","token","fontTokenLabel","getFontTokenLabel","isExtraValueSelected","responsiveValueGetDefinedValue","getDevicesWidths","shouldShowCustomValueInput","selectValue","onSelectChange","selectedValue","queueMicrotask","focus","CustomInputWidgetComponent","customInputElement","params","e","target","onBlur","normalizedValue","Fragment","SelectColorTokenItem","o","previewColor","Root","filledResponsiveFontValue","responsiveValueFill","currentDeviceFontValue","isValidFontTokenValue","stripPxUnit","fontSize","RegExp","TokenFieldPlugin","gap","xmlns","viewBox","fill","cx","cy","stroke","RICH_TEXT_PART_CONFIG_PATH_REGEXP","isConfigPathRichTextPart","configPath","test","getUniqueValues","mapper","uniqueValues","uniqueItems","mappedItem","add","from","mergeCommonFields","mergedCommonFields","fieldsGroupedByProperty","groupFieldsByPropertyName","flat","currentFields","visibleFields","fieldDefinitionIds","getFieldSchemaWithDefinition","uniqueDefinitionIds","firstVisibleField","repeatedFields","currentFieldPropertyName","getPropertyName","fieldNameParts","lastPart","BlockField","isSubcomponentPanelExpanded","setIsSubcomponentPanelExpanded","openComponentPicker","isMixed","normalizedName","componentPickerPath","minHeight","justifyContent","flex","minWidth","SubComponentPanelButton","isExpanded","onExpand","onCollapse","required","ButtonGhost","removeItems","Remove","ThumbnailButton","AddButton","onAdd","then","newConfig","replaceItems","paddingLeft","noPadding","placeItems","border","black20","borderRadius","Add","size","sidebarPanelsRoot","getElementById","entryAfterAuto","componentDefinition","showError","sidebarPreview","getSidebarPreview","defaultThumbnail","thumbnail","ReactDOM","Panel","previewValues","s","externalDataValue","resolveExternalValue","resolveLocalisedValue","preview","PanelContext","useMemo","fieldsPerName","mergedFields","onClose","GroupPanel","PanelBody","FieldsBuilder","BlockFieldPlugin","__type","GroupPanelKeyframes","keyframes","p","IdentityField","panelContext","configPaths","isWithinNestedPanel","parentComponentDefinition","parentSchemaProp","isNonRemovable","isNonChangable","rootComponent","handleChangeComponentType","selectedConfig","handleRemove","titleContent","fontWeight","ChevronDown","ChevronLeft","marginRight","opacity","pointerEvents","IdentityFieldPlugin","MissingWidget","ExternalFieldComponent","tinaForm","isSchemaPropRootParam","ExternalField","getWidgetComponentForRootParam","getWidgetComponentByType","configId","externalReferenceLocationKey","responsive","externalValue","isExternalValueResolvedCompoundExternalDataValue","isResolvedCompoundExternalDataValue","basicResources","getBasicResourcesOfType","isCompoundResourceValueSelectVisible","useLayoutEffect","resourceKey","newId","newKey","newValue","CompoundResourceValueSelect","resource","onResourceKeyChange","ExternalFieldPlugin","externalReference","t","compoundResourceValues","selectedOption","getSavedValue","previousValue","responsiveFieldController","formValues","valuesAfterAuto","originalFormat","format","originalParse","normalizedFieldName","isResponsive","fieldValue","isSet","valueAfterFormat","displayedValue","savedValue","reset","nextValues","defaultValue","toggleOffAuto","currentBreakpointValues","areAllFieldValuesAuto","isAnyFieldValueAuto","newFieldsValues","nextFieldValue","valueField","ResponsiveField","scalarFieldValues","controller","newValues","isValueDifferentFromMainBreakpoint","mainBreakpointIndex","isFieldVisible","uniqueFieldValues","autoLabelChildren","getAutoLabelButtonLabel","ResetButton","Reset","ResetButtonLabel","FieldBuilder","AutoLabel","ResponsiveFieldPlugin","button","purple","refNameParts","round","transformStrokeAndFill","node","getAttribute","setAttribute","child","SVGPicker","meta","svgString","inputRef","readFileAsString","files","reader","FileReader","onload","trimmed","trim","emptyDiv","innerHTML","svg","removeAttribute","tagName","toLowerCase","alert","readAsText","marginBottom","dangerouslySetInnerHTML","__html","accept","SVGPickerFieldPlugin","Slider","RangeSlider","SliderFieldPlugin","useInlineTypes","LocalFieldPlugin","LocalField","inlineTypes","inlineTypeDefinition","WidgetComponent","StyledRadioItem","RadixRadioGroup","Item","horizontalPositionToFlexJustifyContentValue","horizontal","verticalPositionToFlexAlignItemsValue","vertical","positions","PositionPickerInput","onPositionChange","onValueChange","newPosition","gridTemplateRows","gridTemplateColumns","black10","backgroundColor","top","PositionIndicator","$size","PositionField","PositionFieldPlugin","createFieldController","mainNewValue","_len","extraNewValues","_key","invalidateCache","schemaPropNameToUpdate","canvasIframe","parsedValues","getValue","postMessage","richTextChangedEvent","parsedValue","fieldIndex","customTypeDefinition","validate","isInputValueValid","hasLocaleToken","currentLocaleFieldName","replaceLocaleToken","currentLocaleValue","fallbackLocale","getFallbackLocaleForLocale","fieldNameSegments","localeTokenIndex","indexOf","localisedConfigPath","fallbackLocaleFieldName","localeConfigPath","duplicateConfig","propName","componentPath","parentDefinition","closestDefinedValues","val","hasOwnProperty","pathPrefix","resolvedFieldName","resolvedFieldFallbackName","fieldFallbackValue","getHash","getSchemaDefinition","localisedFieldName","eventOrValue","isEventObject","currentTarget","richTextCacheInvalidator","cache","changedPath","cacheKeysToRemove","isRichTextOrRichTextAncestorComponent","richTextPath","findPathOfFirstAncestorOfType","richTextConfig","traverseComponents","componentConfig","cacheInvalidators","invalidator","compilationCache","cacheKey","shouldFieldBeDisplayed","FIELD_COMPONENTS","fieldComponent","fieldParsed","fieldResult","finalForm","log","HorizontalLine","grouped","ungrouped","horizontalLine","identityField","FieldsGroup","groupName","FieldsGroupLabel","generateFieldKey","isLast","theme","GlobalStyles","createGlobalStyle","tina_reset_styles","StyleReset","Button","primary","small","grow","busy","ICON_BUTTON_SIZE","ICON_SIZE","IconButton","InlineSettings","hasNoExtraFields","stopPropagation","SettingsContent","FormBody","Wrapper","EditorSidebar","editableComponent","areMultipleFieldsSelected","focusedFields","fieldsPerFocusedField","focusedField","TOP_BAR_HEIGHT","TopBar","Label","TopBarLeft","TopBarRight","TopBarCenter","ImageContainer","Image","img","EditorTopBar","onSaveDocument","onViewportChange","viewport","onIsEditingChange","isEditing","onUndo","onRedo","onLocaleChange","hideCloseButton","headingRef","router","URLSearchParams","search","themeId","get","shopId","Close","background","Undo","Redo","ButtonDanger","className","DeviceSwitch","deviceId","onDeviceChange","l","code","cursor","alt","DEVICE_ID_TO_ICON","xs","fillRule","clipRule","d","sm","md","lg","ToggleGroup","TooltipTrigger","ToggleGroupItem","TooltipContent","normalizeToStringArray","arg","getAllComponentTypes","componentTypes","getComponentTypesFromDefinitions","definitions","components","componentType","getAllComponentsOfType","getAllComponentsOfTypeFromDefinitionsArray","isNoCodeComponentOfType","unrollAcceptsFieldIntoComponents","accepts","allComponentTypes","idsSet","acceptsEntry","ModalPicker","pickers","parentPath","parentData","templatesDictionary","templates","template","entry","picker","_itemProps","newComponent","onModalClose","TemplateModal","setError","action","backend","isLoadingEdit","setLoadingEdit","isLoadingDelete","setLoadingDelete","setTemplate","thumbnailLabel","canSend","ctaLabel","Modal","title","onRequestClose","headerLine","onSubmit","createAction","create","newTemplate","syncTemplates","catch","finally","update","marginTop","FormElement","autoFocus","delete","isLoading","duplicateItem","compilationContext","sourceIndex","targetIndex","isPlaceholder","configToDuplicate","mutators","insert","pasteItems","what","where","resolveDestination","pasteCommand","successfulInsertsPaths","takeLastOfEachParent","initialDestination","destination","shiftPath","resolvedDestinations","paste","insertedPath","duplicateItems","duplicatableFieldNames","isFieldDuplicatable","fieldsGroupedByParentPath","groupFieldsByParentPath","nextFocusedFieldsPerGroup","sortedFields","fieldsGroupIndex","lastFieldIndex","getFieldPathIndex","getParentPath","moveItem","to","move","moveItems","fieldsToMove","nextFocusedFields","isMovingMultipleFields","wasAnyFieldWithinCurrentGroupMoved","fieldNameIndex","isFirst","removeItem","configPathToRemove","componentConfigValue","fieldNamesToRemove","removableFieldNames","isFieldRemovable","isRemovingMultipleFields","fieldPath","itemsLength","isOnlyItem","isLastItem","isTextWrapper","logItems","configValues","sortDirection","fieldsIndicesGroupedByParentPath","accumulator","currentField","indices","fieldPathParts","parentFieldElementsCount","fieldNameParent","fieldSchema","originalPath","shiftingPath","directionFactor","original","shifting","numberA","numberB","splice","String","lastOfEachParent","curr","MIN_SAFE_INTEGER","reconcile","contextMatches","getTypes","insertCommand","reconcileItem","itemDefinition","itemTypes","reconciledItem","duplicatedItem","getSchema","toName","Boolean","fixIndexInCollection","destinationResolver","initialDestinationPath","resolvedPaths","pathsQueue","shift","parsed","slot","pasteSlots","slotSchema","slotPath","slotValues","idx","reverse","pasteManager","inserts","Map","destinations","latestDestinationInserts","set","editorVariable","BEFORE_ADD_BUTTON_DISPLAY","BEFORE_ADD_BUTTON_TOP","BEFORE_ADD_BUTTON_LEFT","AFTER_ADD_BUTTON_DISPLAY","AFTER_ADD_BUTTON_TOP","AFTER_ADD_BUTTON_LEFT","offset","addBlockButtonRef","handleOpenBlockMenu","inactivateBlockMenu","AddButtonWrapper","AddIconButton","x1","y1","x2","y2","FrameWrapper","attrs","calculateAddButtonsProperties","targetElementRect","containerElementRect","halfButtonSize","floor","ADD_BUTTON_SIZE","beforeButtonTopOffset","afterButtonTopOffset","buttonsLeftOffset","isBeforeButtonWithinViewport","isButtonWithinViewport","isAfterButtonWithinViewport","before","after","buttonsTopOffset","beforeButtonLeftOffset","afterButtonLeftOffset","SelectionFrame","compiledFocusedField","isAddingEnabled","isAddingEnabledForSelectedFields","hideAddButtons","handleSelectionFrameMessages","data","updateAddButtons","payload","container","handleAddButtonClick","which","insertItem","block","setCssVariable","documentElement","setProperty","isSchemaPropCollection","configMapArray","configArray","prefix","configMapInternal","configMap","mappedVal","$res","getDefaultTemplateForDefinition","def","buildRichTextNoCodeEntry","getDefaultTokenId","colors","font","fonts","isUserDefined","isDefault","getTemplates","configTemplates","remoteUserDefinedTemplates","getAll","getTemplatesInternal","getNecessaryDefaultTemplates","componentTemplates","normalizeTextLocales","firstDefinedValue","getDefaultLocale","allBuiltinTemplates","allUserTemplates","hideTemplates","Form","loading","constructor","buttons","loadInitialValues","initialValues","createForm","handleSubmit","arrayMutators","_reset","save","updateFields","updateInitialValues","firstUpdate","subscribe","formState","getState","cb","response","initialize","FORM_ERROR","process","env","NODE_ENV","groupCollapsed","groupEnd","updateValues","batch","activePath","active","updateEverything","updateSelectively","useForm","watch","setValues","setForm","formIsLoading","setFormIsLoading","loadFormData","useCallback","useUpdateFormFields","useUpdateFormLabel","useUpdateFormValues","getConfigSnapshot","strippedConfig","addLocalizedFlag","__localized","removeLocalizedFlag","useDataSaver","initialDocument","remoteDocument","initialConfigInCaseOfMissingDocument","onTickRef","onTick","localConfig","localConfigSnapshot","previousConfig","previousConfigSnapshot","isConfigTheSame","configToSaveWithLocalisedFlag","runSaveCallback","debug","newDocument","documents","latestDocument","latestRemoteDocumentVersion","version","isNewerDocumentVersionAvailable","latestConfig","notify","updatedDocument","inProgress","wasSaveNowCalled","interval","setInterval","clearInterval","saveNow","GLOBAL_SHORTCUTS_KEYS","DATA_TRANSFER_FORMAT","useEditorGlobalKeyboardShortcuts","isDeleting","handleKeydown","isTargetInputElement","isGlobalShortcut","isAnyFieldSelected","toUpperCase","logSelectedItems","handleCopy","canHandleCopyPaste","getConfigsToCopy","clipboardData","setData","handleCut","handlePaste","rawData","getData","parsedData","isTargetHtmlElement","sortedPaths","notInsideInputElement","activeElement","insideEditorIFrame","frameElement","focusedFieldsSelected","HISTORY_SIZE","EditorHistory","currentIndex","isCurrentIndexLastEntry","isAboutToReachSizeLimit","replaceAt","oldValue","entryIndex","findIndex","forward","canGoForward","currentEntry","nextEntry","back","canGoBack","previousEntry","getEntries","useEditorHistory","editorHistory","undo","unstable_batchedUpdates","redo","editorHistoryInstance","checkLocalesCorrectness","defaultLocales","defaultLocale","fallback","localeChain","currentLocale","fallbackId","ContentContainer","SidebarAndContentContainer","SidebarContainer","white","DataSaverRoot","DataSaverOverlay","DataSaverModal","AuthenticationScreen","bodyLarge","Editor","EditorBackendInitializer","enabled","setEnabled","setDocument","run","documentId","EditorWrapper","memo","rootTemplateId","rootComponentId","rootTemplateEntry","createCompilationContext","initialEntry","adaptRemoteConfig","EditorContent","parseExternalDataId","externalDataId","useBuiltContent","rawContent","onExternalDataChange","buildEntryResult","inputRawContent","inputIsEditing","inputBreakpointIndex","inputChanged","buildEntry","compiler","findExternals","compile","resultMeta","vars","links","textModifiers","normalizedContent","normalizeInput","compileInternal","mergeCompilationMeta","isExternalDataChanged","defaultIsExternalDataChanged","storedExternalData","externalId","findConfigById","responsiveValueGet","hasExternalIdChanged","renderableContent","calculateViewportRelatedStuff","availableSize","activeDevice","device","matchingDevice","getMatchingDevice","activeDeviceindex","scaleFactor","offsetY","smallestNonScaledWidth","breakpoint","h","iframeSize","useRerenderOnIframeResize","resizeObserver","ResizeObserver","throttle","observe","unobserve","heightMode","currentViewport","setCurrentViewport","iframeContainerRef","clientWidth","clientHeight","CompilationCache","setEditing","setCurrentLocale","prevLocale","componentPickerData","setComponentPickerData","setFocussedField","handleSetFocussedField","nextFocusedField","isEditMode","handleSetEditing","clear","closeComponentPickerModal","promiseResolve","sidebarNodeRef","editableData","setTemplates","openTemplateModalAction","setOpenTemplateModalAction","configChangeCallback","fieldsToFocus","templateDefined","prev","templateIndex","newTemplates","editorTypes","typeName","typeDefinition","documentData","editorWindowAPI","compiled","localeValue","onUpdate","handleEditorEvents","shopstoryCanvasIframe","componentPickerClosed","fromPath","toPath","fromPathParseResult","toPathParseResult","pathToMove","isToPathPlaceholder","insertionPath","insertionIndex","calculateInsertionIndex","isDataSaverOverlayOpen","setDataSaverOverlayOpen","appHeight","setAppElement","EditorSidebarRight","MemoEditorSidebarRight","saveLabel","withoutLocalizedFlag","normalized","mostCommonPath","getMostCommonSubPath","mostCommonPathParseResult","toPathNoCodeEntry","fromPathRootSectionIndex","toPathRootSectionIndex","path1","path2","fromPathParts","toPathParts","mostCommonPathParts","currentFromPathPart","currentToPathPart","foundConfig","highestDevice","visibleDevices","currentDevice","isString","htmlColorNames","htmlColorNamesSpecial","validateHTMLColorName","status","validateHTMLColorSpecialName","validateHTMLColorHex","regex","validateHTMLColorRgb","optionalCommaOrRequiredSpace","optionalDecimals","anyPercentage","hundredPercent","alphaPercentage","endingWithAlphaPercentage","validateHTMLColorHsl","degRegex","graRegex","radRegex","turnRegex","regexLogic","validateHTMLColorHwb","validateHTMLColorLab","labParam","validateColor","ColorTokenWidget","SpaceTokenWidget","int","parseQueryParams","searchParams","editorSearchParams","DocumentDataWidgetComponent","whiteSpace","rootParams","documentExternalLocationKeys","documentCompoundResources","lastIndexOf","pop","resourceSchemaProp","CardRoot","CardImg","CardImgPlaceholder","CardFooter","CardLabelContainer","CardLabelTemplateName","Title","TitleContainer","Message","getTemplatePreviewImage","SectionCard","onSelect","imageRef","previewImage","ButtonGhostColor","ModalRoot","ModalGridRoot","Sidebar","black5","SidebarContent","SidebarButton","GridRoot","SectionPickerModal","templateGroups","gridRootRef","templateSelected","groupNode","groupOffsetTop","offsetTop","scrollTo","behavior","paddingBottom","checkQueryForTemplate","query","toLocaleLowerCase","SearchableSmallPickerModal","templatesDict","setQuery","trimmedQuery","filteredTemplatesDict","filteredTemplates","searchProps","headerSymbol","isOnlyOne","componentLabel","templateLabel","BasicRow","image","tinyDescription","onEdit","shouldForwardProp","isPropValid","builtinWidgets","space","builinPickers","large","compact","EasyblocksParent","StyleSheetManager","enableVendorPrefixes","ModalContext","querySelector","GlobalModalStyles","TooltipProvider","Toaster","containerStyle","CanvasRoot","globalEditorRendererStyles","SelectionFrameController","isActive","isChildrenSelectionDisabled","stitches","sortable","setNode","useUpdateFramePosition","isInsertingBefore","activeIndex","wrapperClassName","userSelect","boxSizing","transition","boxShadow","bottom","right","blue50","contains","isOver","setNodeRef","listeners","dispatch","updateSelectionFramePosition","createThrottledHandler","nodeRect","getBoundingClientRect","selectionFramePositionChanged","passive","handleResize","updateSelectionFramePositionInScrollableContainer","containerRect","closestScrollableElement","closest","isTicking","requestAnimationFrame","BlocksControls","useEasyblocksMetadata","dndContext","useDndContext","isChildComponentActive","entryPathParseResult","entryComponentDefinition","isEntryComponentOrComponentFixed","isAncestorComponentActive","isMultiSelection","isSiblingComponentActive","pathWithoutIndexPart","regexp","draggedEntryPathParseResult","draggedComponentDefinition","canDraggedComponentBeDropped","getAllowedComponentTypes","isDroppableDisabled","useSortable","draggable","droppable","horizontalListSortingStrategy","verticalListSortingStrategy","focusOnBlock","closestEditableElementFromTarget","isActiveElementContentEditable","isMultipleSelection","shiftKey","getNextFocusedField","getSelection","removeAllRanges","isActivePathInDifferentCollection","isPathsParentEqual","DroppablePlaceholder","collectionSchemaProps","allowedComponentTypes","activePathParts","currentPathParts","wrapperStyles","EditableComponentBuilder","restPassedProps","noInline","ComponentBuilder","passedProps","Placeholder","aspectRatio","appearance","rootClassName","contentClassName","blue10","setDroppableNodeRef","TypePlaceholder","dragDataSchema","z","object","string","number","customCollisionDetection","args","pointerCollisions","pointerWithin","rectIntersection","EasyblocksCanvas","activeDraggedEntryPath","mouseSensor","useSensor","MouseSensor","activationConstraint","distance","self","shouldNotRender","sortableItems","getSortableItems","EasyblocksMetadataProvider","DndContext","sensors","collisionDetection","onDragStart","onDragEnd","activeData","over","overData","itemMovedEvent","itemMoved","ifValidPlacement","onDragCancel","SortableContext","items","Easyblocks","renderableDocument","RichTextEditor","TextEditor","rootNoCodeEntry","configTraverse","at","PreviewRenderer","setWidth","setWidthAuto","localeWithDefault","buildDocument","requestedExternalDataLength","givenExternalDataLength","maxWidth","debugTypes","debug_url_inline_never","responsiveness","debug_url_inline_optional","debug_url_inline_always","debug_url_token_never","debug_url_token_optional_no_custom","debug_url_token_optional_custom","debug_url_token_always_no_custom","debug_url_token_always_custom","debugSectionDefinition","debugTokens","debug_urls","DebugSection","inline_never","inline_optional_disabled","inline_optional_enabled","inline_always","token_never","token_optional_disabled_no_custom","token_optional_enabled_no_custom","token_optional_disabled_custom","token_optional_enabled_custom","token_always_no_custom","token_always_custom","DebugUrlWidget","setActive","setValue","addDebugToEditorProps","debug_url","EasyblocksEditor","selectedWindow","setSelectedWindow","setSelectedWindowToParent","isShopstoryEditor","setSelectedWindowToChild"],"mappings":"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"}